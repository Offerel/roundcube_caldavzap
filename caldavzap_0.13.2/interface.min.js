function checkTimezone(e){return e in timezones?e:e in timezones_alt?checkTimezone(timezones_alt[e]):null}function CalDAVeditor_cleanup(e){if("undefined"!=typeof e?CalDAVcleanupRegexEnvironment(e):CalDAVcleanupRegexEnvironment(),("undefined"==typeof e||"form"===e)&&(($.browser.msie||$.browser.mozilla)&&$('<svg data-type="select_icon"></svg>').css("display","none").insertAfter($("#event_details_template, #todo_details_template").find("select")),$.browser.msie||$.browser.mozilla)){var a=$(SVG_select).attr("data-type","select_icon").css({"pointer-events":"none","z-index":"1",display:"inline","margin-left":"-19px","vertical-align":"top","background-color":"#ffffff"});$("#event_details_template, #todo_details_template").find('svg[data-type="select_icon"]').replaceWith($("<div>").append($(a).clone()).html())}}function animate_messageCalendar(e,a,t,l){void 0==l&&(l="+=");var o=$(a).height()+14,n=500;return $(e).animate({"max-height":o+"px",height:(void 0==l?"+=":l)+o+"px"},n,function(){"+="==l&&setTimeout(function(){animate_messageCalendar(e,a,0,"-=")},t)}),t+2*n}function show_editor_messageCalendar(e,a,t,l,o){var n="";n="none"!=$("#todo_details_template").css("display")?"Todo":"Event",void 0==e||"in"==e?(messageSelector="#"+n+"InMessage",messageTextSelector="#"+n+"InMessageText"):(messageSelector="#"+n+"Message",messageTextSelector="#"+n+"MessageText"),$(messageTextSelector).attr("class",a),$(messageTextSelector).text(t);var r=animate_messageCalendar(messageSelector,messageTextSelector,l);void 0!=o&&o(r)}function show_editor_loader_messageCalendar(e,a,t,l){var o="";o="vtodo"==e?"#todoLoader":"#CAEvent",messageSelector=o+" .saveLoader",messageTextSelector=o+" .saveLoaderInfo",$(messageTextSelector).addClass(a),$(messageTextSelector).text(t),setTimeout(function(){"vtodo"==e?$(o).hide():$(messageSelector).hide(),$(messageTextSelector).text(""),$(messageTextSelector).removeClass(a),void 0!=l&&l(globalHideInfoMessageAfter)},globalHideInfoMessageAfter)}function items(e,a,t,l,o,n,r,i,s,d,c,g,u,p,f,m,v,b,h,C,D,T,y,$,_,O,L,A,x,S,I,V,E,k,R,w,z){this.etag=e,this.id=n,this.start=a,this.end=t,this.title=l,this.allDay=o,this.res_id=r,this.ev_id=i,this.note=s,this.displayValue=d,this.alertTime=c,this.alertNote=g,this.untilDate=u,this.repeatStart=v,this.repeatEnd=b,this.type=p,this.interval=f,this.after=m,this.byMonthDay=h,this.repeatCount=C,this.realRepeatCount=D,this.vcalendar=T,this.location=y,this.alertTimeOut=$,this.timeZone=_,this.realStart=O,this.realEnd=L,this.byDay=A,this.rec_id=x,this.wkst=S,this.classType=I,this.avail=V,this.hrefUrl=E,this.compareString=k,this.priority=R,this.status=w,this.searchvalue=l.toLowerCase().replace(vCalendar.pre.compressNewLineRex).multiReplace(globalSearchTransformAlphabet),this.ruleString=z}function todoItems(e,a,t,l,o,n,r,i,s,d,c,g,u,p,f,m,v,b,h,C,D,T,y,$,_,O,L,A,x,S,I,V,E,k,R,w,z,M,P,N){this.start=e,this.end=a,this.untilDate=t,this.type=l,this.interval=o,this.after=n,this.wkst=r,this.repeatStart=i,this.repeatEnd=s,this.repeatCount=d,this.realRepeatCount=c,this.byDay=g,this.location=u,this.note=p,this.title=f,this.id=m,this.vcalendar=v,this.etag=b,this.alertTime=h,this.alertNote=C,this.status=D,this.filterStatus=T,this.percent=_,this.displayValue=O,this.res_id=L,this.compareString=A,this.alertTimeOut=V,this.timeZone=x,this.realStart=S,this.realEnd=I,this.classType=E,this.url=k,this.rec_id=y,this.repeatHash=$,this.completedOn=R,this.sequence=w,this.priority=z,this.renderPriority=M,this.finalString=P,this.searchvalue=f.toLowerCase().replace(vCalendar.pre.compressNewLineRex).multiReplace(globalSearchTransformAlphabet),this.ruleString=N}function setLoadingLimit(e,a){if(e){if(null!=globalSettings.eventstartpastlimit.value&&(a||"past"==globalLimitLoading)){var t=new Date(globalLoadedLimit.getTime());t.setDate(t.getDate()-7),globalBeginPast=new Date(t.getTime())}if(null!=globalSettings.eventstartfuturelimit.value&&(a||"future"==globalLimitLoading)){var l=new Date(globalToLoadedLimit.getTime());l.setDate(l.getDate()+14),globalBeginFuture=new Date(l.getTime())}}}function initSearchEngine(){globalCalDAVQs=$('input[data-type="PH_CalDAVsearch"]').quicksearch(globalEventList.displayEventsArray,{delay:500,hide:function(){this.hidden=!0,$("#SystemCalDavZAP").find('.event_item[data-id="'+this.id+'"]').each(function(){$(this).addClass("searchCalDAV_hide"),"tr"!=this.tagName.toLowerCase()||$(this).siblings().addBack().not(".searchCalDAV_hide").length||$(this).parent().prev().find("tr").addClass("searchCalDAV_hide")})},show:function(){this.hidden=!1,$("#SystemCalDavZAP").find('.event_item[data-id="'+this.id+'"]').each(function(){$(this).removeClass("searchCalDAV_hide"),"tr"==this.tagName.toLowerCase()&&$(this).parent().prev().find("tr").removeClass("searchCalDAV_hide")})},prepareQuery:function(e){return e.multiReplace(globalSearchTransformAlphabet).toLowerCase().split(" ")}}),globalCalDAVTODOQs=$('input[data-type="PH_CalDAVTODOsearch"]').quicksearch(globalEventList.displayTodosArray,{delay:500,onAfter:function(){$("#TodoDisabler").is(":visible")||$("#todoList").fullCalendar("selectEvent")},hide:function(){this.hidden=!0,$("#SystemCalDavTODO").find('.event_item[data-id="'+this.id+'"]').addClass("searchCalDAV_hide")},show:function(){this.hidden=!1,$("#SystemCalDavTODO").find('.event_item[data-id="'+this.id+'"]').removeClass("searchCalDAV_hide")},prepareQuery:function(e){return e.multiReplace(globalSearchTransformAlphabet).toLowerCase().split(" ")}})}function checkEventLoader(e,a){e.counter++,e.counter==e.collectionLength&&("vevent"==e.listType?$('#ResourceCalDAVList [data-id="'+e.uid+'"]').removeClass("r_operate"):$('#ResourceCalDAVTODOList [data-id="'+e.uid+'"]').removeClass("r_operate"),""==globalLimitTodoLoading&&""==globalLimitLoading||"vtodo"==e.listType&&null==globalSettings.todopastlimit.value||"vevent"==e.listType&&null==globalSettings.eventstartpastlimit.value&&null==globalSettings.eventstartfuturelimit.value?("vevent"==e.listType?globalAccountSettings[e.resourceIndex].calendarNo--:"vtodo"==e.listType&&globalAccountSettings[e.resourceIndex].todoNo--,(0==globalAccountSettings[e.resourceIndex].calendarNo&&0==globalAccountSettings[e.resourceIndex].todoNo&&globalCalDAVInitLoad||!globalCalDAVInitLoad)&&(globalCalDAVInitLoad||e.typeList.indexOf("vevent")==-1||e.typeList.indexOf("vtodo")==-1?updateMainLoader(a,e.listType,e.uid):updateMainLoader(a,null,e.uid))):(globalOnlyCalendarNumber>0&&globalOnlyCalendarNumberCount==globalOnlyCalendarNumber||globalTodoCalendarNumber>0&&globalOnlyTodoCalendarNumberCount==globalTodoCalendarNumber)&&updateMainLoader(a,e.listType,e.uid))}function getResourceByCollection(e){for(var a=globalResourceCalDAVList.getCollectionByUID(e),t=a.accountUID.match(vCalendar.pre.accountUidParts),l=null,o=t[1]+t[3]+t[4],n=t[2],r=0;r<globalAccountSettings.length;r++)globalAccountSettings[r].href==o&&globalAccountSettings[r].userAuth.userName==n&&(l=globalAccountSettings[r]);return l}function updateMainLoaderText(e){globalCalDAVInitLoad?(globalCalendarNumberCount++,$("#MainLoaderInner").html(localization[globalInterfaceLanguage].loadingCalendars.replace("%act%",globalCalendarNumberCount).replace("%total%",globalCalendarNumber))):""==globalLimitTodoLoading&&""==globalLimitLoading||("vtodo"!=e||null==globalSettings.todopastlimit.value)&&("vevent"!=e||null==globalSettings.eventstartpastlimit.value&&null==globalSettings.eventstartfuturelimit.value)?""!=globalSettingsSaving&&globalFirstHideLoader&&(globalLoadedCollectionsCount++,"event"==globalSettingsSaving?$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].loadingCalendars.replace("%act%",globalLoadedCollectionsCount).replace("%total%",globalLoadedCollectionsNumber)):"todo"==globalSettingsSaving&&$("#CalendarLoaderTODO").children(".loaderInfo").text(localization[globalInterfaceLanguage].loadingCalendars.replace("%act%",globalLoadedCollectionsCount).replace("%total%",globalLoadedCollectionsNumber))):"vevent"!=e||"past"!=globalLimitLoading&&"future"!=globalLimitLoading?"vtodo"!=e||"pastTodo"!=globalLimitTodoLoading&&"futureTodo"!=globalLimitTodoLoading||(globalOnlyTodoCalendarNumberCount++,$("#CalendarLoaderTODO").children(".loaderInfo").text(localization[globalInterfaceLanguage].loadingCalendars.replace("%act%",globalOnlyTodoCalendarNumberCount).replace("%total%",globalTodoCalendarNumber))):(globalOnlyCalendarNumberCount++,$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].loadingCalendars.replace("%act%",globalOnlyCalendarNumberCount).replace("%total%",globalOnlyCalendarNumber)))}function updateMainLoaderTextFinal(){$("#MainLoaderInner").html(localization[globalInterfaceLanguage].renderingE)}function updateMainLoaderTextTimezone(){$("#MainLoaderInner").html(localization[globalInterfaceLanguage].timezoneChange)}function updateMainLoader(e,a,t){if(null==a&&0==$(".r_operate").length||"vtodo"==a&&0==$("#ResourceCalDAVTODOList .r_operate").length||"vevent"==a&&0==$("#ResourceCalDAVList .r_operate").length){var l=vCalendar.pre.accountUidParts;if(globalCalDAVInitLoad&&0==$(".r_operate").length){updateMainLoaderTextFinal();var o=0;for(calendarUID in globalEventList.displayEventsArray)o++;for(calendarUID in globalEventList.displayTodosArray)o++;var n=$("#main").width()-$("#calendar").width(),r=$("#mainTODO").width()-$("#todoList").width();for(calendarUID in globalEventList.displayEventsArray)setTimeout(function(e){if(globalSettings.displayhiddenevents.value||globalVisibleCalDAVCollections.indexOf(e)!=-1){var a=!1,t=e.match(l),i="";null!=t&&(i=t[4]);var s=getResourceByCollection(e),d=globalResourceCalDAVList.getEventCollectionByUID(e);if(null!=s&&"undefined"!=typeof s.backgroundCalendars&&null!=s.backgroundCalendars&&""!=s.backgroundCalendars){var c="";c=s.backgroundCalendars instanceof Array?s.backgroundCalendars:[s.backgroundCalendars];for(var g=0;g<c.length;g++)if("string"==typeof c[g]){var u=i.indexOf(c[g]);u!=-1&&i.length==u+c[g].length&&(a=!0)}else"object"==typeof c[g]&&null!=i.match(c[g])&&(a=!0)}d.makeLoaded&&(d.fcSource=$("#calendar").fullCalendar("addEventSource",{events:globalEventList.displayEventsArray[e],backgroundColor:hexToRgba(d.ecolor,.9),borderColor:d.ecolor,textColor:checkFontColor(d.ecolor),background:a}))}if(o--,0==o){var p=$("#main").width()-$("#calendar").width();rerenderCalendar(n!=p),globalCalDAVQs.cache();var f=$("#mainTODO").width()-$("#todoList").width();rerenderTodo(r!=f),globalCalDAVTODOQs.cache(),$("#calendar").fullCalendar("findToday"),globalCalDAVInitLoad=!1,$("#todoList").fullCalendar("allowSelectEvent",!0),$("#todoList").fullCalendar("selectEvent",$(".fc-view-todo .fc-list-day").find(".fc-event:visible:first")),globalCalWidth=$("#main").width(),$("#SystemCalDavZAP .fc-header-center ").removeClass("r_operate_all"),showTimezones(globalSessionTimeZone,"Picker"),showTimezones(globalSessionTimeZone,"PickerTODO"),loadNextApplication(!0)}},10,calendarUID);for(calendarUID in globalEventList.displayTodosArray)setTimeout(function(e){if(globalSettings.displayhiddenevents.value||globalVisibleCalDAVTODOCollections.indexOf(e)!=-1){var a=globalResourceCalDAVList.getTodoCollectionByUID(e);a.makeLoaded&&(a.fcSource=$("#todoList").fullCalendar("addEventSource",{events:globalEventList.displayTodosArray[e],backgroundColor:hexToRgba(a.ecolor,.9),borderColor:a.ecolor}))}if(o--,0==o){var t=$("#main").width()-$("#calendar").width();rerenderCalendar(n!=t),globalCalDAVQs.cache();var l=$("#mainTODO").width()-$("#todoList").width();rerenderTodo(r!=l),globalCalDAVTODOQs.cache(),$("#calendar").fullCalendar("findToday"),globalCalDAVInitLoad=!1,$("#todoList").fullCalendar("allowSelectEvent",!0),$("#todoList").fullCalendar("selectEvent",$(".fc-view-todo .fc-list-day").find(".fc-event:visible:first")),globalCalWidth=$("#main").width(),$("#SystemCalDavZAP .fc-header-center ").removeClass("r_operate_all"),showTimezones(globalSessionTimeZone,"Picker"),showTimezones(globalSessionTimeZone,"PickerTODO"),loadNextApplication(!0)}},10,calendarUID)}else if(!globalCalDAVInitLoad){if(null==a||"vevent"==a){var i=globalResourceCalDAVList.getEventCollectionByUID(t);if((globalSettings.displayhiddenevents.value||globalVisibleCalDAVCollections.indexOf(t)!=-1)&&""==globalLimitLoading&&e&&"undefined"!=typeof t&&null!=i&&null==i.fcSource){var s=!1,d=t.match(l),c="";null!=d&&(c=d[4]);var g=getResourceByCollection(t);if(null!=g&&"undefined"!=typeof g.backgroundCalendars&&null!=g.backgroundCalendars&&""!=g.backgroundCalendars){var u="";u=g.backgroundCalendars instanceof Array?g.backgroundCalendars:[g.backgroundCalendars];for(var p=0;p<u.length;p++)if("string"==typeof u[p]){var f=c.indexOf(u[p]);f!=-1&&c.length==f+u[p].length&&(s=!0)}else"object"==typeof u[p]&&null!=c.match(u[p])&&(s=!0)}i.fcSource=$("#calendar").fullCalendar("addEventSource",{events:globalEventList.displayEventsArray[t],backgroundColor:hexToRgba(i.ecolor,.9),borderColor:i.ecolor,textColor:checkFontColor(i.ecolor),background:s})}e&&refetchCalendarEvents(),setTimeout(function(){""==globalLimitLoading||null==globalSettings.eventstartpastlimit.value&&null==globalSettings.eventstartfuturelimit.value||($("#CalendarLoader").css("display","none"),globalLimitLoading="",globalOnlyCalendarNumberCount=0),$("#SystemCalDavZAP .fc-header-center ").removeClass("r_operate_all")},10)}if(null==a||"vtodo"==a){var i=globalResourceCalDAVList.getTodoCollectionByUID(t);(globalSettings.displayhiddenevents.value||globalVisibleCalDAVTODOCollections.indexOf(t)!=-1)&&""==globalLimitTodoLoading&&e&&"undefined"!=typeof t&&null!=i&&null==i.fcSource&&(i.fcSource=$("#todoList").fullCalendar("addEventSource",{events:globalEventList.displayTodosArray[t],backgroundColor:hexToRgba(i.ecolor,.9),borderColor:i.ecolor})),e&&refetchTodoEvents(),setTimeout(function(){""!=globalLimitTodoLoading&&null!=globalSettings.todopastlimit.value&&($("#CalendarLoaderTODO").css("display","none"),globalLimitTodoLoading="",globalOnlyTodoCalendarNumberCount=0)},10)}showTimezones(globalSessionTimeZone,"Picker"),showTimezones(globalSessionTimeZone,"PickerTODO"),""!=globalSettingsSaving&&globalLoadedCollectionsCount==globalLoadedCollectionsNumber&&setTimeout(function(){hideUnloadCollectionCallback(globalSettingsSaving)},300)}}}function checkFontColor(e){if(""!=e&&void 0!=e){var a,t=e,l="#"==t.charAt(0)?t.substring(1,7):t,o=checkColorBrightness(l);return a=o<140?"#ffffff":"#404040"}return"#000"}function checkFor(e){"undefined"!=typeof vCalendar.tplM.contentline_TRIGGER&&""!=vCalendar.tplM.contentline_TRIGGER&&null!=vCalendar.tplM.contentline_TRIGGER&&vCalendar.tplM.contentline_TRIGGER.length>0&&vCalendar.tplM.contentline_TRIGGER.splice(e-1,1),"undefined"!=typeof vCalendar.tplM.contentline_VANOTE&&""!=vCalendar.tplM.contentline_VANOTE&&null!=vCalendar.tplM.contentline_VANOTE&&vCalendar.tplM.contentline_VANOTE.length>0&&vCalendar.tplM.contentline_VANOTE.splice(e-1,1),"undefined"!=typeof vCalendar.tplM.contentline_ACTION&&""!=vCalendar.tplM.contentline_ACTION&&null!=vCalendar.tplM.contentline_ACTION&&vCalendar.tplM.contentline_ACTION.length>0&&vCalendar.tplM.contentline_ACTION.splice(e-1,1),"undefined"!=typeof vCalendar.tplM.unprocessedVALARM&&""!=vCalendar.tplM.unprocessedVALARM&&null!=vCalendar.tplM.unprocessedVALARM&&vCalendar.tplM.unprocessedVALARM.length>0&&vCalendar.tplM.unprocessedVALARM.splice(e-1,1)}function checkForTodo(e){var a="form";"undefined"!=typeof vCalendar.tplM.VTcontentline_TRIGGER[a]&&""!=vCalendar.tplM.VTcontentline_TRIGGER[a]&&null!=vCalendar.tplM.VTcontentline_TRIGGER[a]&&vCalendar.tplM.VTcontentline_TRIGGER[a].length>0&&vCalendar.tplM.VTcontentline_TRIGGER[a].splice(e-1,1),"undefined"!=typeof vCalendar.tplM.VTcontentline_VANOTE[a]&&""!=vCalendar.tplM.VTcontentline_VANOTE[a]&&null!=vCalendar.tplM.VTcontentline_VANOTE[a]&&vCalendar.tplM.VTcontentline_VANOTE[a].length>0&&vCalendar.tplM.VTcontentline_VANOTE[a].splice(e-1,1),"undefined"!=typeof vCalendar.tplM.VTcontentline_ACTION[a]&&""!=vCalendar.tplM.VTcontentline_ACTION[a]&&null!=vCalendar.tplM.VTcontentline_ACTION[a]&&vCalendar.tplM.VTcontentline_ACTION[a].length>0&&vCalendar.tplM.VTcontentline_ACTION[a].splice(e-1,1),"undefined"!=typeof vCalendar.tplM["VTunprocessedVALARM"[a]]&&""!=vCalendar.tplM.VTunprocessedVALARM[a]&&null!=vCalendar.tplM.VTunprocessedVALARM[a]&&vCalendar.tplM.VTunprocessedVALARM[a].length>0&&vCalendar.tplM.VTunprocessedVALARM[a].splice(e-1,1)}function div(e,a){var t=e/a,l=e%a/a;return t-l}function binarySearch(e,a,t,l){var o=0;for(l=l.getTime();a<=t;){o=div(a+t,2);var n=$.fullCalendar.parseDate(e[o].sortStart);if(n=n.getTime(),n<l)a=o+1;else{if(!(n>l))break;t=o-1}}return o}function parseISO8601(e){if(e.indexOf("T")!=-1){var a=e.split("T");if(!(a.length>1))return null;var t=a[0].split("-");if(!(t.length>1))return null;var l=a[1].split("Z"),o=l[0].split(":");if(!(o.length>1))return null;var n=o[2].split("."),r=Number(o[0]);return _date=new Date,_date.setFullYear(Number(t[0])),_date.setMonth(Number(t[1])-1),_date.setDate(Number(t[2])),_date.setHours(Number(r)),_date.setMinutes(Number(o[1])),_date.setSeconds(Number(n[0])),n[1]&&_date.setUTCMilliseconds(Number(n[1])),_date}var t=e.split("-");return 3!=t.length?null:(_date=new Date,_date.setFullYear(Number(t[0])),_date.setMonth(Number(t[1])-1),_date.setDate(Number(t[2])),_date)}function getValidRepeatDay(e,a){var t="";t="string"==typeof a?$.fullCalendar.parseDate(a):new Date(a.getTime());var l=e.getMonth()+2,o=t.getDate();l>12&&(l=1);var n=new Date(e.getFullYear(),l,0);return n=n.getDate(),n<o?n:o}function generateRepeatInstances(e){var a=e.items.end.getTime()-e.items.start.getTime(),t=new Array,l=e.repeatStart,o=null;if("undefined"==typeof e.rule){var n=RRule.parseString(e.items.ruleString);n.dtstart=new Date(e.items.start.getTime()),""!==e.untilDate&&(n.until=e.untilDate),o=new RRule(n)}else o=e.rule;o.between(e.repeatStart,e.futureRLimit,!0,function(o,n){var r=new Date(o.getTime()),i=new Date(o.getTime()+a),s=!1,d="",c="";if(e.items.realRepeatCount++,e.recurrence_id_array.length>0&&(s=isInRecurrenceArray(r,e.stringUID,e.recurrence_id_array,e.tzName)),e.items.allDay)p=new Date(r.getTime()),e.exDates.length>0&&e.exDates.indexOf(p.toString())!=-1&&(s=!0),g=$.fullCalendar.formatDate(p,"yyyy-MM-dd'T'HH:mm:ss"),f=new Date(i.getTime()),u=$.fullCalendar.formatDate(f,"yyyy-MM-dd'T'HH:mm:ss");else{var g,u;globalSettings.timezonesupport.value&&e.items.timeZone in timezones&&(d=getOffsetByTZ(e.items.timeZone,r));var p=new Date(r.getTime());g=new Date(p.getTime()),d&&(c=getLocalOffset(g)*-1*1e3-1e3*d.getSecondsFromOffset(),g.setTime(g.getTime()+c)),e.exDates.length>0&&e.exDates.indexOf(g.toString())!=-1&&(s=!0);var f=new Date(i.getTime());u=new Date(f.getTime()),c&&u.setTime(u.getTime()+c)}var m=new Date(e.repeatStart.getTime());if("string"==typeof g&&(m=$.fullCalendar.formatDate(e.repeatStart,"yyyy-MM-dd'T'HH:mm:ss")),(""!==e.items.after&&e.items.realRepeatCount>parseInt(e.items.after,10)||"object"==typeof g&&m-g==0||"string"==typeof g&&m==g)&&(s=!0,e.items.realRepeatCount--),!s){e.ignoreAlarms||(t=setAlertTimeouts(!1,e.alertTime,g,u,{allDay:e.items.allDay,title:e.items.title},!1,e.items.id)),e.items.repeatCount++;var v=$.extend({},e.items,{start:g,end:u,realStart:p,realEnd:f,repeatCount:e.items.repeatCount,realRepeatCount:e.items.realRepeatCount,alertTimeOut:t});globalEventList.displayEventsArray[e.items.res_id].splice(globalEventList.displayEventsArray[e.items.res_id].length,0,v),l=new Date(r.getTime())}return!0}),"undefined"==typeof globalEventList.repeatable[e.items.id]?globalEventList.repeatable[e.items.id]={lastGenDate:l,recurrence_id_array:e.recurrence_id_array,stringUID:e.stringUID,exDates:e.exDates,alertTime:e.alertTime,ignoreAlarms:e.ignoreAlarms,rule:o,items:e.items}:globalEventList.repeatable[e.items.id].lastGenDate=l}function generateTodoRepeatInstances(e){var a=null,t=new Array,l=!1;if(e.repeatStart)var o=new Date($.fullCalendar.parseDate(e.items.realStart).getTime());else if(e.repeatEnd)var o=new Date($.fullCalendar.parseDate(e.items.realEnd).getTime());if("undefined"!=typeof e.lastGenDate)var o=new Date(e.lastGenDate.getTime());var n=new Date(o.getTime());if("undefined"==typeof e.rule){var r=RRule.parseString(e.items.ruleString);r.dtstart=new Date(o.getTime()),""!==e.untilDate&&(r.until=e.untilDate),a=new RRule(r)}else a=e.rule;var i=new Array;i=a.between(o,new Date(e.futureRLimit.getTime()),!0),(i.length>0&&i[0]-o!=0||0==i.length)&&i.splice(0,0,o);var s=new Date(e.futureRLimit.getTime());s.setHours(o.getHours()),s.setMinutes(o.getMinutes()),s.setSeconds(o.getSeconds());var d=new Date(i[i.length-1].getTime()),c=i.length;if(globalSettings.appleremindersmode.value||""==e.repeatEnd&&""!=e.repeatStart)for(var g=0;g<globalMaxNextInstanesTodoCheckingNumber;g++){var u=new Date(d.getTime()+2592e6+864e5),p=new Array;if(p=a.between(d,u,!0),p.length>0){for(var f=!1,m=0;m<p.length;m++)if(i[i.length-1]-p[m]!=0){i.push(p[m]),c=i.length-1,f=!0;break}if(f)break}d=new Date(u.getTime())}for(var v=e.realRepeatCount,b=e.repeatCount,g=0;g<c;g++){var h="",C="",D="",T=0,y=!1,_="",O="";if(v++,""!=e.repeatEnd&&""!=e.repeatStart?(h=new Date(i[g].getTime()),C=new Date(h.getTime()+e.dayDifference)):""==e.repeatEnd&&""!=e.repeatStart?(h=new Date(i[g].getTime()),g<=i.length-2&&(C=new Date(i[g+1].getTime()),C.setMinutes(C.getMinutes()-1))):""!=e.repeatEnd&&""==e.repeatStart&&(C=new Date(i[g].getTime()),g>0?(h=new Date(i[g-1].getTime()),h.setMinutes(h.getMinutes()+1)):"undefined"!=typeof e.previousRepeatStart&&""!==e.previousRepeatStart&&(h=new Date(e.previousRepeatStart))),""!==h){globalSettings.timezonesupport.value&&e.items.timeZone in timezones&&(D=getOffsetByTZ(e.items.timeZone,h));var L=new Date(h.getTime());_=new Date(h.getTime()),!D||"undefined"!=typeof e.previousRepeatStart&&""!=e.previousRepeatStart||(T=getLocalOffset(_)*-1*1e3-1e3*D.getSecondsFromOffset(),_.setTime(_.getTime()+T))}if(""!==C){var A=new Date(C.getTime()),O=new Date(C.getTime());T&&O.setTime(O.getTime()+T)}if(""!=e.repeatStart?(y=isInRecurrenceArray(L,e.stringUID,e.recurrence_id_array,e.items.timeZone),e.exDates.length>0&&e.exDates.indexOf(_.toString())!=-1&&(y=!0)):(y=isInRecurrenceArray(A,e.stringUID,e.recurrence_id_array,e.items.timeZone),e.exDates.length>0&&e.exDates.indexOf(O.toString())!=-1&&(y=!0)),""!==e.items.after&&!globalSettings.appleremindersmode.value&&v>parseInt(e.items.after,10)&&(y=!0,v--),globalSettings.appleremindersmode.value&&l&&1==e.todoArray.length){globalAppleSupport.nextDates[e.items.id]=new Date(O.getTime());break}if(!y){e.ignoreAlarms||(t=setAlertTimeouts(!0,e.alertTime,""==e.repeatStart?O:_,""==e.repeatEnd?_:O,{title:e.items.title,status:e.items.status},!l,e.items.id)),l=!0,b++;var x=$.extend({},e.items,{start:_,end:""==e.repeatEnd&&g==i.length-1?"":O,realStart:L,realEnd:A,repeatCount:b,realRepeatCount:v,alertTimeOut:t});e.preTodoArray.splice(e.preTodoArray.length,0,x),n=""!=e.repeatStart?new Date(_.getTime()):new Date(O.getTime())}}"undefined"==typeof globalEventList.repeatableTodo[e.items.id]?globalEventList.repeatableTodo[e.items.id]={todoArray:e.todoArray,lastGenDate:n,dayDifference:e.dayDifference,recurrence_id_array:e.recurrence_id_array,stringUID:e.stringUID,exDates:e.exDates,realRepeatCount:v,repeatCount:b,alertTime:e.alertTime,ignoreAlarms:e.ignoreAlarms,rule:a,items:e.items}:(globalEventList.repeatableTodo[e.items.id].lastGenDate=n,globalEventList.repeatableTodo[e.items.id].realRepeatCount=v,globalEventList.repeatableTodo[e.items.id].repeatCount=b)}function loadRepeatEvents(e,a,t){new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);generateRepeatInstances({untilDate:e.items.untilDate,repeatStart:e.lastGenDate,futureRLimit:t,stringUID:e.stringUID,recurrence_id_array:e.recurrence_id_array,exDates:e.exDates,alertTime:e.alertTime,ignoreAlarms:e.ignoreAlarms,rule:e.rule,items:e.items})}function loadRepeatTodo(e,a){var t=new Array,l="",o=globalEventList.displayTodosArray[e.items.res_id].filter(function(a){return a.id==e.items.id&&""!=a.type});if(o.length>0){var n=globalEventList.displayTodosArray[e.items.res_id].indexOf(o[o.length-1]);l=o[o.length-1].start,globalEventList.displayTodosArray[e.items.res_id].splice(n,1)}generateTodoRepeatInstances({loadRepeatTodo:!0,rule:e.rule,realRepeatCount:--e.realRepeatCount,repeatCount:--e.repeatCount,dayDifference:e.dayDifference,untilDate:e.items.untilDate,repeatStart:e.items.repeatStart,repeatEnd:e.items.repeatEnd,futureRLimit:globalToLoadedLimitTodo,stringUID:e.stringUID,recurrence_id_array:e.recurrence_id_array,exDates:e.exDates,alertTime:e.alertTime,ignoreAlarms:e.ignoreAlarms,isChange:!1,lastGenDate:e.lastGenDate,todoArray:e.todoArray,preTodoArray:t,previousRepeatStart:l,items:e.items}),$.merge(globalEventList.displayTodosArray[e.items.res_id],t)}function getPrevMonths(e){"future"!=globalLimitLoading&&"past"!=globalLimitLoading&&null!=globalSettings.eventstartpastlimit.value&&e<globalLoadedLimit&&(globalLoadedLimit.setMonth(globalLoadedLimit.getMonth()-globalSettings.eventstartpastlimit.value-1),globalOnlyCalendarNumberCount=0,$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block"),globalLimitLoading="past",setCalendarNumber(!1),CalDAVnetLoadCollection(globalResourceCalDAVList.collections[0],!0,!1,0,globalResourceCalDAVList.collections))}function getNextMonths(e){if("future"!=globalLimitLoading&&"past"!=globalLimitLoading&&e>globalToLoadedLimit){var a=null!=globalSettings.eventstartfuturelimit.value,t=a?globalSettings.eventstartfuturelimit.value:2,l=new Date(globalBeginFuture.getTime());globalToLoadedLimit.setMonth(globalToLoadedLimit.getMonth()+t+1);var o=new Date(globalToLoadedLimit.getTime());o.setDate(o.getDate()+14),a&&(globalOnlyCalendarNumberCount=0,$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block"),globalLimitLoading="future");for(var n in globalEventList.repeatable)loadRepeatEvents(globalEventList.repeatable[n],l,o);a?(setCalendarNumber(!1),CalDAVnetLoadCollection(globalResourceCalDAVList.collections[0],!0,!1,0,globalResourceCalDAVList.collections)):globalBeginFuture=new Date(o.getTime()),refetchCalendarEvents()}}function getPrevMonthsTodo(e){if("futureTODO"==globalLimitTodoLoading&&"pastTODO"==globalLimitTodoLoading)return!1;var a=new Date($("#todoList").fullCalendar("getView").start.getTime());a.setDate(1),null!=globalSettings.todopastlimit.value&&a<globalLoadedLimitTodo&&("undefined"!=typeof e&&null!=e&&e?globalLoadedLimitTodo=new Date(a.getTime()):globalLoadedLimitTodo.setMonth(globalLoadedLimitTodo.getMonth()-globalSettings.todopastlimit.value-1),globalOnlyTodoCalendarNumberCount=0,$("#CalendarLoaderTODO").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block"),globalLimitTodoLoading="pastTodo",setCalendarNumber(!1),CalDAVnetLoadCollection(globalResourceCalDAVList.TodoCollections[0],!0,!1,0,globalResourceCalDAVList.TodoCollections))}function getNextMonthsTodo(e){if("futureTODO"==globalLimitTodoLoading&&"pastTODO"==globalLimitTodoLoading)return!1;var a=!1,t=a?globalSettings.eventstartfuturelimit.value:2,l=new Date($("#todoList").fullCalendar("getView").end.getTime());if(l.setMonth(l.getMonth()+1),l.setDate(1),l>globalToLoadedLimitTodo){var o=new Date(globalToLoadedLimitTodo.getTime());"undefined"!=typeof e&&null!=e&&e?(globalToLoadedLimitTodo=new Date(l.getTime()),globalToLoadedLimitTodo.setMonth(globalToLoadedLimitTodo.getMonth()+1)):globalToLoadedLimitTodo.setMonth(globalToLoadedLimitTodo.getMonth()+t+1),a&&(globalOnlyTodoCalendarNumberCount=0,$("#CalendarLoaderTODO").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block"),globalLimitTodoLoading="futureTodo");for(var n in globalEventList.repeatableTodo)loadRepeatTodo(globalEventList.repeatableTodo[n],o);a&&(setCalendarNumber(!1),CalDAVnetLoadCollection(globalResourceCalDAVList.TodoCollections[0],!0,!1,0,globalResourceCalDAVList.TodoCollections)),refetchTodoEvents()}}function showAlertEvents(e,a,t){if(maxAlarmValue<a){var l=a-maxAlarmValue;return maxAlarmValue<l?setTimeout(function(){showAlertEvents(e,l,t)},maxAlarmValue):setTimeout(function(){showAlertEvents(e,l,t)},l),!1}var o=e.substring(0,e.lastIndexOf("/")+1);if(globalSettings.showhiddenalarms.value?hiddenCheck=!0:hiddenCheck=!1,void 0!=t&&hiddenCheck||void 0!=t&&!hiddenCheck&&globalVisibleCalDAVCollections.indexOf(o)!=-1){$("#alertBox").css("visibility","visible"),$("#AlertDisabler").fadeIn(globalEditorFadeAnimation);var n=$.fullCalendar.parseDate(t.start),r="",i=$.datepicker.formatDate(globalSettings.datepickerformat.value,n);""!=i&&(r+=" : "+i);var s="";if(!t.allDay){var d=$.fullCalendar.formatDate(n,globalSettings.ampmformat.value?"h:mm TT{ - h:mm TT}":"H:mm{ - H:mm}");""!=d&&(s=" - "+d)}$("#alertBoxContent").append("<div class='alert_item'><img src='images/calendarB.svg' alt='Calendar'/><label>"+t.title+r+s+"</label></div>")}}function showAlertTODO(e,a,t){if(globalSettings.ignorecompletedorcancelledalarms.value&&("COMPLETED"==t.status||"CANCELLED"==t.status))return!1;if(maxAlarmValue<a){var l=a-maxAlarmValue;return maxAlarmValue<l?setTimeout(function(){showAlertTODO(e,l,t)},maxAlarmValue):setTimeout(function(){showAlertTODO(e,l,t)},l),!1}resDate="";var o=e.substring(0,e.lastIndexOf("/")+1);if(globalSettings.showhiddenalarms.value?hiddenCheck=!0:hiddenCheck=!1,hiddenCheck||!hiddenCheck&&globalVisibleCalDAVTODOCollections.indexOf(o)!=-1){$("#alertBox").css("visibility","visible"),$("#AlertDisabler").fadeIn(globalEditorFadeAnimation);var n="",r=$.fullCalendar.parseDate(t.start),i=$.datepicker.formatDate(globalSettings.datepickerformat.value,r);""!=i&&(n=" : "+i);var s="",d=$.fullCalendar.formatDate(r,globalSettings.ampmformat.value?"h:mm TT{ - h:mm TT}":"H:mm{ - H:mm}");""!=d&&(s=" - "+d),$("#alertBoxContent").append("<div class='alert_item'><img src='images/todoB.svg' alt='Todo'/><label>"+t.title+n+s+"</label></div>")}}function clearAlertEvents(){$("#alertBoxContent").html(""),$("#alertBox").css("visibility","hidden"),$("#AlertDisabler").fadeOut(globalEditorFadeAnimation)}function addAndEdit(e,a){var t="";if(""!=$("#uid").val())var l=globalResourceCalDAVList.getEventCollectionByUID($("#uid").val().substring(0,$("#uid").val().lastIndexOf("/")+1));else var l=globalResourceCalDAVList.getEventCollectionByUID($("#event_calendar").val());var o=getAccount(l.accountUID),n=o.href.match(vCalendar.pre.hrefRex),r=n[1]+o.userAuth.userName+"@"+n[2];if(""!=$("#etag").val())t=$("#uid").val();else{if("choose"==$("#event_calendar").val())return!1;t=$("#event_calendar").val()+""}dataToVcalendar("EDIT",r,t,$("#etag").val(),"",e,a)}function interResourceEdit(e,a,t){var l="";if(""!=$("#uid").val())var o=globalResourceCalDAVList.getEventCollectionByUID($("#uid").val().substring(0,$("#uid").val().lastIndexOf("/")+1));else var o=globalResourceCalDAVList.getEventCollectionByUID($("#event_calendar").val());var n=getAccount(o.accountUID),r=n.href.match(vCalendar.pre.hrefRex),i=r[1]+n.userAuth.userName+"@"+r[2];"MOVE_IN"!=e&&$("#etag").val("");var s=$("#uid").val().substring($("#uid").val().lastIndexOf("/")+1,$("#uid").val().length);l=$("#event_calendar").val()+s,dataToVcalendar(e,i,l,"",a,t)}function save(e,a){if($("#event_details_template").scrollTop(0),!a){if($("#event_details_template").find("img[data-type=invalidSmall]").filter(function(){return"none"!=this.style.display}).length>0)return show_editor_loader_messageCalendar("vevent","message_error",localization[globalInterfaceLanguage].txtErorInput),!1;var t=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_from").val()),l=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_to").val()),o=$.fullCalendar.formatDate(t,"yyyy-MM-dd"),n=$.fullCalendar.formatDate(l,"yyyy-MM-dd"),r="00:00",i="00:00";if($("#allday").prop("checked")||""!=$("#time_from").val()&&""!=$("#time_to").val()&&(r=new Date(Date.parse("01/02/1990, "+$("#time_from").val())),r=$.fullCalendar.formatDate(r,"HH:mm"),
i=new Date(Date.parse("01/02/1990, "+$("#time_to").val())),i=$.fullCalendar.formatDate(i,"HH:mm")),$.fullCalendar.parseDate(o+"T"+r+"Z")>$.fullCalendar.parseDate(n+"T"+i+"Z"))return show_editor_loader_messageCalendar("vevent","message_error",localization[globalInterfaceLanguage].txtErrorDates),!1}var s=$("#uid").val().substring(0,$("#uid").val().lastIndexOf("/")),d=$("#event_calendar").val().substring(0,$("#event_calendar").val().length-1);if("choose"!=$("#event_calendar").val()){if(""==$("#name").val()&&$("#name").val(localization[globalInterfaceLanguage].pholderNewEvent),d==s||""==$("#etag").val()&&"choose"!=$("#event_calendar").val())addAndEdit(e,a);else if(""!=$("#etag").val()){var c=$("#uid").val();interResourceEdit("MOVE_OTHER",c,e)}}else show_editor_loader_messageCalendar("vevent","message_error",localization[globalInterfaceLanguage].txtNotChoose)}function deleteEvent(){var e=$("#uid").val();""!=e&&deleteVcalendarFromCollection(e,"vevent")}function loadAdditionalCollections(e){if(""!=globalSettingsSaving)return!1;globalSettingsSaving=e;var a=$.extend({},globalSettings),t=new RegExp("^(https?://)([^@/]+(?:@[^@/]+)?)@(.*)"),l="",o="";if("event"==e?(o="loadedcalendarcollections",a.loadedcalendarcollections={value:new Array,locked:globalSettings[o].locked},$("#ResourceCalDAVList").find(".unloadCheck").each(function(e,l){if($(l).prop("checked")){var o=$(l).attr("data-id").match(t);a.loadedcalendarcollections.value.splice(a.loadedcalendarcollections.value.length,0,o[1]+o[3])}})):"todo"==e&&(l="TODO",o="loadedtodocollections",a.loadedtodocollections={value:new Array,locked:globalSettings[o].locked},$("#ResourceCalDAVTODOList").find(".unloadCheck").each(function(e,l){if($(l).prop("checked")){var o=$(l).attr("data-id").match(t);a.loadedtodocollections.value.splice(a.loadedtodocollections.value.length,0,o[1]+o[3])}})),$(a[o].value).not(globalSettings[o].value).length>0||$(globalSettings[o].value).not(a[o].value).length>0){$("#CalendarLoader"+l).removeClass("loader_hidden"),$("#ResourceCalDAV"+l+"List").find('input[type="checkbox"]').prop("disabled",!0);for(var n=0,r=0;r<globalAccountSettings.length;r++)if(globalAccountSettings[r].href.indexOf(globalLoginUsername)!=-1&&globalAccountSettings[r].settingsAccount){n++,netSaveSettings(globalAccountSettings[r],a,!1,!0);break}0==n&&cancelUnloadedCollections(e)}else hideUnloadedCollections(e,!0)}function showUnloadedCollections(e){if("event"==e&&globalEventCollectionsLoading||"todo"==e&&globalTodoCollectionsLoading)return!1;var a=null,t="";"event"==e?(globalEventCollectionsLoading=!0,a="",t="txtEnabledCalendars"):"todo"==e&&(globalTodoCollectionsLoading=!0,a="TODO",t="txtEnabledTodoLists"),isAvaible("CardDavMATE")&&$("#showUnloadedAddressbooks").css("display","none"),"TODO"==a?$("#showUnloadedCalendars").css("display","none"):$("#showUnloadedCalendarsTODO").css("display","none"),$("#ResourceCalDAV"+a+"List").find('input[type="checkbox"]').prop("disabled",!0),$("#CalendarLoader"+a).children(".loaderInfo").text(localization[globalInterfaceLanguage].loadingCollectionList).parent().fadeIn(300);var l=$("#ResourceCalDAV"+a+"List"),o=".resourceCalDAV"+a+"_header",n=".resourceCalDAV"+a+"_item";$("#ResourceCalDAV"+a+"List").find('input[type="checkbox"]').prop("disabled",!1),$("#CalendarLoader"+a).children(".loaderInfo").text("").parent().addClass("loader_hidden"),l.find(".resourceCalDAV_item_selected").removeClass("resourceCalDAV_item_selected"),l.find("input").css("display","none"),l.children(".resourceCalDAV"+a+"_header").each(function(){"none"==$(this).css("display")&&$(this).addClass("unloaded").css("display","");var e=$('<input type="checkbox" class="unloadCheckHeader" style="position:absolute;top:3px;right:0px;margin-right:6px;"/>');e.change(function(){loadResourceChBoxClick(this,"#ResourceCalDAV"+a+"List",o,n,n)}),$(this).addClass("load_mode").append(e)}),l.find(".resourceCalDAV"+a+"_item").each(function(){if("undefined"!=typeof $(this).attr("data-id")){var e=$('<input type="checkbox" class="unloadCheck" data-id="'+$(this).attr("data-id")+'" style="position:absolute;top:8px;right:0px;margin-right:6px;"/>');e.change(function(){loadCollectionChBoxClick(this,"#ResourceCalDAV"+a+"List",o,n,n)}),$(this).addClass("load_mode").append(e),"none"==$(this).css("display")?$(this).addClass("unloaded"):e.prop("checked",!0),e.trigger("change")}}),$("#showUnloadedCalendars"+a).css("display","none"),$("#resourceCalDAV"+a+"_h").find(".resourceCalDAV"+a+"_text").text(localization[globalInterfaceLanguage][t]);var r=l.find(".resourceCalDAV"+a+"_header.unloaded").eq(0).css("height"),i=l.find(".resourceCalDAV"+a+"_item.unloaded").eq(0).css("height");l.find(".resourceCalDAV"+a+"_header.unloaded").css({height:0,display:""}).animate({height:r},300),l.find(".resourceCalDAV"+a+"_item.unloaded").css({height:0,display:""}).animate({height:i},300),l.animate({top:49},300)}function cancelUnloadedCollections(e){var a=null,t=null;"event"==e?(a="",t=globalSettings.loadedcalendarcollections.value):"todo"==e&&(a="TODO",t=globalSettings.loadedtodocollections.value),$("#ResourceCalDAV"+a+"List").children(".resourceCalDAV"+a+"_item").each(function(){var e=!1;if("undefined"!=typeof globalCrossServerSettingsURL&&null!=globalCrossServerSettingsURL&globalCrossServerSettingsURL){for(var a=$(this).attr("data-id").match(RegExp("/([^/]+/[^/]+/)$")),l=a[1].match("^(.*/)([^/]+)/$"),o=decodeURIComponent(l[1])+l[2]+"/",n=!1,r=0;r<t.length;r++){var i=t[r].match("^(.*/)([^/]+)/([^/]+)/$"),s=decodeURIComponent(i[2])+"/"+i[3]+"/";if(o==s){n=!0;break}}e=n}else{var a=$(this).attr("data-id").match(RegExp("^(https?://)([^@/]+(?:@[^@/]+)?)@(.*)")),o=a[1]+a[3];e=t.indexOf(o)!=-1}var d=$(this).find(".unloadCheck"),c=d.prop("checked");(e&&!c||!e&&c)&&d.prop("checked",!c).trigger("change")}),hideUnloadedCollections(e,!0)}function hideUnloadedCollections(e,a){var t=null,l="";"event"==e?(t="",l="txtCalendars"):"todo"==e&&(t="TODO",l="txtTodoLists");var o=$("#ResourceCalDAV"+t+"List");o.find(":input.unloadCheck").remove(),o.find(":input.unloadCheckHeader").remove(),o.find(".load_mode").removeClass("load_mode"),o.find(":input").css("display",""),$("#resourceCalDAV"+t+"_h").find(".resourceCalDAV"+t+"_text").text(localization[globalInterfaceLanguage][l]),o.find(".resourceCalDAV"+t+"_header.unloaded").animate({height:0},300).promise().done(function(){o.find(".resourceCalDAV"+t+"_header.unloaded").css({display:"none",height:""})}),o.find(".resourceCalDAV"+t+"_item.unloaded").animate({height:0},300).promise().done(function(){o.find(".resourceCalDAV"+t+"_item.unloaded").css({display:"none",height:""}),o.find(".resourceCalDAV"+t+"_header").not(".unloaded").each(function(){var e=$(this).nextUntil(".resourceCalDAV"+t+"_header").filter(":visible").first().find('input[type="checkbox"]');collectionChBoxClick(e.get(0),"#ResourceCalDAV"+t+"List",".resourceCalDAV"+t+"_header",".resourceCalDAV"+t+"_item",null,!1)}),o.find(".unloaded").removeClass("unloaded"),"event"==e?globalEventCollectionsLoading=!1:"todo"==e&&(globalTodoCollectionsLoading=!1),a&&hideUnloadCollectionCallback(e)}),o.animate({top:24},300),a&&$("#CalendarLoader"+t).fadeOut(300,function(){$(this).removeClass("loader_hidden")}),isAvaible("CardDavMATE")&&$("#showUnloadedAddressbooks").css("display","block"),"TODO"==t?$("#showUnloadedCalendars").css("display","block"):$("#showUnloadedCalendarsTODO").css("display","block")}function hideUnloadCollectionCallback(e){var a=null;"event"==e?a="":"todo"==e&&(a="TODO"),$("#showUnloadedCalendars"+a).css("display",""),globalFirstHideLoader=!0,globalSettingsSaving="",selectActiveCalendar(),"event"==e?0==$("#ResourceCalDAVList .resourceCalDAV_item:visible").not(".resourceCalDAV_item_ro").length?($("#eventFormShower").css("display","none"),$("#calendar").fullCalendar("setOptions",{selectable:!1})):($("#eventFormShower").css("display","block"),$("#calendar").fullCalendar("setOptions",{selectable:!0})):"todo"==e&&(0==$("#ResourceCalDAVTODOList .resourceCalDAVTODO_item:visible").not(".resourceCalDAV_item_ro").length?$("#eventFormShowerTODO").css("display","none"):$("#eventFormShowerTODO").css("display","block")),$("#CalendarLoader"+a).css("display","none"),$("#ResourceCalDAV"+a+"List").find('input[type="checkbox"]').prop("disabled",!1)}function disableAll(){var e=0;if($("#ResourceCalDAVList").children(":visible").each(function(a,t){$(t).hasClass("resourceCalDAV_item")&&$(t).find("input").prop("checked")&&e++}),!e)return!1;if(!globalSettings.displayhiddenevents.value){globalResourceRefreshNumber++,$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block");var a=$("#main").width()-$("#calendar").width();$("#calendar").fullCalendar("removeEvents"),$("#calendar").fullCalendar("removeEventSources");var t=$("#main").width()-$("#calendar").width();rerenderCalendar(a!=t)}for(var l=0;l<globalResourceCalDAVList.collections.length;l++)if(void 0!=globalResourceCalDAVList.collections[l].href){var o=globalResourceCalDAVList.collections[l].uid,n=$("#ResourceCalDAVList").find('[name^="'+o+'"]');if(n.prop("checked")){var r=globalVisibleCalDAVCollections.indexOf(o);r!=-1&&globalVisibleCalDAVCollections.splice(r,1),n.prop("checked",!1),globalSettings.displayhiddenevents.value&&hideCalendarEvents(o)}collectionChBoxClick(n.get(0),"#"+n.parent().parent().attr("id"),".resourceCalDAV_header",".resourceCalDAV_item",null,!1)}globalSettings.displayhiddenevents.value||(globalResourceRefreshNumber--,globalResourceRefreshNumber||$("#CalendarLoader").css("display","none"))}function enableAll(){var e=0;if($("#ResourceCalDAVList").children(":visible").each(function(a,t){$(t).hasClass("resourceCalDAV_item")&&!$(t).find("input").prop("checked")&&e++}),!e)return!1;globalSettings.displayhiddenevents.value||(globalResourceRefreshNumber++,$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block"));for(var a=$("#main").width()-$("#calendar").width(),t=vCalendar.pre.accountUidParts,l=0;l<globalResourceCalDAVList.collections.length;l++)if(void 0!=globalResourceCalDAVList.collections[l].href){var o=globalResourceCalDAVList.collections[l].uid,n=$("#ResourceCalDAVList").find('[name^="'+o+'"]');if(!n.prop("checked")){n.prop("checked",!0);var r=globalVisibleCalDAVCollections.indexOf(o);if(r==-1)if(globalVisibleCalDAVCollections[globalVisibleCalDAVCollections.length]=o,globalSettings.displayhiddenevents.value)showCalendarEvents(o);else{var i=!1,s=o.match(t),d="";null!=s&&(d=s[4]);var c=getResourceByCollection(o);if(null!=c&&"undefined"!=typeof c.backgroundCalendars&&null!=c.backgroundCalendars&&""!=c.backgroundCalendars){var g="";g=c.backgroundCalendars instanceof Array?c.backgroundCalendars:[c.backgroundCalendars];for(var u=0;u<g.length;u++)if("string"==typeof g[u]){var p=d.indexOf(g[u]);p!=-1&&d.length==p+g[u].length&&(i=!0)}else"object"==typeof g[u]&&null!=d.match(g[u])&&(i=!0)}var f=globalResourceCalDAVList.collections[l];f.fcSource=$("#calendar").fullCalendar("addEventSource",{events:globalEventList.displayEventsArray[o],backgroundColor:hexToRgba(f.ecolor,.9),borderColor:f.ecolor,textColor:checkFontColor(f.ecolor),background:i})}}collectionChBoxClick(n.get(0),"#"+n.parent().parent().attr("id"),".resourceCalDAV_header",".resourceCalDAV_item",null,!1)}if(!globalSettings.displayhiddenevents.value){var m=$("#main").width()-$("#calendar").width();rerenderCalendar(a!=m),globalResourceRefreshNumber--,globalResourceRefreshNumber||$("#CalendarLoader").css("display","none")}}function disableAllTodo(){disableAll()}function enableAllTodo(){enableAll()}function disableResource(e){globalSettings.displayhiddenevents.value||(globalResourceRefreshNumber++,$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block"));var a=$("#main").width()-$("#calendar").width();if($(e).nextUntil(".resourceCalDAV_header").each(function(e,a){var t=$(a).attr("data-id"),l=globalVisibleCalDAVCollections.indexOf(t);l!=-1&&(globalVisibleCalDAVCollections.splice(l,1),globalSettings.displayhiddenevents.value?hideCalendarEvents(t):$("#calendar").fullCalendar("removeEventSource",globalResourceCalDAVList.getCollectionByUID(t).fcSource))}),!globalSettings.displayhiddenevents.value){var t=$("#main").width()-$("#calendar").width();rerenderCalendar(a!=t),globalResourceRefreshNumber--,globalResourceRefreshNumber||$("#CalendarLoader").css("display","none")}}function enableResource(e){globalSettings.displayhiddenevents.value||(globalResourceRefreshNumber++,$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block"));var a=$("#main").width()-$("#calendar").width();if($(e).nextUntil(".resourceCalDAV_header").each(function(e,a){var t=$(a).attr("data-id"),l=globalVisibleCalDAVCollections.indexOf(t);if(l==-1)if(globalVisibleCalDAVCollections[globalVisibleCalDAVCollections.length]=t,globalSettings.displayhiddenevents.value)showCalendarEvents(t);else{var o=!1,n=t.match(vCalendar.pre.accountUidParts),r="";null!=n&&(r=n[4]);var i=getResourceByCollection(t);if(null!=i&&"undefined"!=typeof i.backgroundCalendars&&null!=i.backgroundCalendars&&""!=i.backgroundCalendars){var s="";s=i.backgroundCalendars instanceof Array?i.backgroundCalendars:[i.backgroundCalendars];for(var d=0;d<s.length;d++)if("string"==typeof s[d]){var c=r.indexOf(s[d]);c!=-1&&r.length==c+s[d].length&&(o=!0)}else"object"==typeof s[d]&&null!=r.match(s[d])&&(o=!0)}var g=globalResourceCalDAVList.getCollectionByUID(t);g.fcSource=$("#calendar").fullCalendar("addEventSource",{events:globalEventList.displayEventsArray[t],backgroundColor:hexToRgba(g.ecolor,.9),borderColor:g.ecolor,textColor:checkFontColor(g.ecolor),background:o})}}),!globalSettings.displayhiddenevents.value){var t=$("#main").width()-$("#calendar").width();rerenderCalendar(a!=t),globalResourceRefreshNumber--,globalResourceRefreshNumber||$("#CalendarLoader").css("display","none")}}function disableResourceTodo(e){globalSettings.displayhiddenevents.value||(globalResourceRefreshNumberTodo++,$("#CalendarLoaderTODO").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block"));var a=$("#mainTODO").width()-$("#todoList").width();if($(e).nextUntil(".resourceCalDAVTODO_header").each(function(e,a){var t=$(a).attr("data-id"),l=globalVisibleCalDAVTODOCollections.indexOf(t);l!=-1&&(globalVisibleCalDAVTODOCollections.splice(l,1),globalSettings.displayhiddenevents.value?hideCalendarTodos(t):$("#todoList").fullCalendar("removeEventSource",globalResourceCalDAVList.getTodoCollectionByUID(t).fcSource))}),globalSettings.displayhiddenevents.value)$("#todoList").fullCalendar("selectEvent");else{var t=$("#mainTODO").width()-$("#todoList").width();rerenderTodo(a!=t),globalResourceRefreshNumberTodo--,globalResourceRefreshNumberTodo||$("#CalendarLoaderTODO").css("display","none")}}function enableResourceTodo(e){globalSettings.displayhiddenevents.value||(globalResourceRefreshNumberTodo++,$("#CalendarLoaderTODO").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block"));var a=$("#mainTODO").width()-$("#todoList").width();if($(e).nextUntil(".resourceCalDAVTODO_header").each(function(e,a){var t=$(a).attr("data-id"),l=globalVisibleCalDAVTODOCollections.indexOf(t);if(l==-1)if(globalVisibleCalDAVTODOCollections[globalVisibleCalDAVTODOCollections.length]=t,globalSettings.displayhiddenevents.value)showCalendarTodos(t);else{var o=!1,n=t.match(vCalendar.pre.accountUidParts),r="";null!=n&&(r=n[4]);var i=getResourceByCollection(t);if(null!=i&&"undefined"!=typeof i.backgroundCalendars&&null!=i.backgroundCalendars&&""!=i.backgroundCalendars){var s="";s=i.backgroundCalendars instanceof Array?i.backgroundCalendars:[i.backgroundCalendars];for(var d=0;d<s.length;d++)if("string"==typeof s[d]){var c=r.indexOf(s[d]);c!=-1&&r.length==c+s[d].length&&(o=!0)}else"object"==typeof s[d]&&null!=r.match(s[d])&&(o=!0)}var g=globalResourceCalDAVList.getTodoCollectionByUID(t);g.fcSource=$("#todoList").fullCalendar("addEventSource",{events:globalEventList.displayTodosArray[t],backgroundColor:hexToRgba(g.ecolor,.9),borderColor:g.ecolor})}}),globalSettings.displayhiddenevents.value)$("#todoList").fullCalendar("selectEvent");else{var t=$("#mainTODO").width()-$("#todoList").width();rerenderTodo(a!=t),globalResourceRefreshNumberTodo--,globalResourceRefreshNumberTodo||$("#CalendarLoaderTODO").css("display","none")}}function disableCalendar(e){var a=globalVisibleCalDAVCollections.indexOf(e);if(a!=-1)if(globalVisibleCalDAVCollections.splice(a,1),globalSettings.displayhiddenevents.value)hideCalendarEvents(e);else{var t=$("#main").width()-$("#calendar").width();if(globalResourceRefreshNumber++,$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block"),$("#calendar").fullCalendar("removeEventSource",globalResourceCalDAVList.getCollectionByUID(e).fcSource),globalResourceRefreshNumber--,!globalResourceRefreshNumber){var l=$("#main").width()-$("#calendar").width();rerenderCalendar(t!=l),$("#CalendarLoader").css("display","none")}}}function enableCalendar(e){var a=globalVisibleCalDAVCollections.indexOf(e);if(a==-1)if(globalVisibleCalDAVCollections[globalVisibleCalDAVCollections.length]=e,globalSettings.displayhiddenevents.value)showCalendarEvents(e);else{var t=$("#main").width()-$("#calendar").width();globalResourceRefreshNumber++,$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block");var l=!1,o=e.match(vCalendar.pre.accountUidParts),n="";null!=o&&(n=o[4]);var r=getResourceByCollection(e);if(null!=r&&"undefined"!=typeof r.backgroundCalendars&&null!=r.backgroundCalendars&&""!=r.backgroundCalendars){var i="";i=r.backgroundCalendars instanceof Array?r.backgroundCalendars:[r.backgroundCalendars];for(var s=0;s<i.length;s++)if("string"==typeof i[s]){var d=n.indexOf(i[s]);d!=-1&&n.length==d+i[s].length&&(l=!0)}else"object"==typeof i[s]&&null!=n.match(i[s])&&(l=!0)}var c=globalResourceCalDAVList.getCollectionByUID(e);if(c.fcSource=$("#calendar").fullCalendar("addEventSource",{events:globalEventList.displayEventsArray[e],backgroundColor:hexToRgba(c.ecolor,.9),borderColor:c.ecolor,textColor:checkFontColor(c.ecolor),background:l}),globalResourceRefreshNumber--,!globalResourceRefreshNumber){var g=$("#main").width()-$("#calendar").width();rerenderCalendar(t!=g),$("#CalendarLoader").css("display","none")}}}function disableCalendarTodo(e){var a=globalVisibleCalDAVTODOCollections.indexOf(e);if(a!=-1)if(globalVisibleCalDAVTODOCollections.splice(a,1),globalSettings.displayhiddenevents.value)hideCalendarTodos(e),$("#todoList").fullCalendar("selectEvent");else{var t=$("#mainTODO").width()-$("#todoList").width();if(globalResourceRefreshNumberTodo++,$("#CalendarLoaderTODO").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block"),$("#todoList").fullCalendar("removeEventSource",globalResourceCalDAVList.getTodoCollectionByUID(e).fcSource),globalResourceRefreshNumberTodo--,!globalResourceRefreshNumberTodo){var l=$("#mainTODO").width()-$("#todoList").width();rerenderTodo(t!=l),$("#CalendarLoaderTODO").css("display","none")}}}function enableCalendarTodo(e){var a=globalVisibleCalDAVTODOCollections.indexOf(e);if(a==-1)if(globalVisibleCalDAVTODOCollections[globalVisibleCalDAVTODOCollections.length]=e,globalSettings.displayhiddenevents.value)showCalendarTodos(e),$("#todoList").fullCalendar("selectEvent");else{var t=$("#mainTODO").width()-$("#todoList").width();globalResourceRefreshNumberTodo++,$("#CalendarLoaderTODO").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block");var l=!1,o=e.match(vCalendar.pre.accountUidParts),n="";null!=o&&(n=o[4]);var r=getResourceByCollection(e);if(null!=r&&"undefined"!=typeof r.backgroundCalendars&&null!=r.backgroundCalendars&&""!=r.backgroundCalendars){var i="";i=r.backgroundCalendars instanceof Array?r.backgroundCalendars:[r.backgroundCalendars];for(var s=0;s<i.length;s++)if("string"==typeof i[s]){var d=n.indexOf(i[s]);d!=-1&&n.length==d+i[s].length&&(l=!0)}else"object"==typeof i[s]&&null!=n.match(i[s])&&(l=!0)}var c=globalResourceCalDAVList.getTodoCollectionByUID(e);if(c.fcSource=$("#todoList").fullCalendar("addEventSource",{events:globalEventList.displayTodosArray[e],backgroundColor:hexToRgba(c.ecolor,.9),borderColor:c.ecolor}),globalResourceRefreshNumberTodo--,!globalResourceRefreshNumberTodo){var g=$("#mainTODO").width()-$("#todoList").width();rerenderTodo(t!=g),$("#CalendarLoaderTODO").css("display","none")}}}function enableOne(e){for(var a=0;a<globalResourceCalDAVList.collections.length;a++)if(void 0!=globalResourceCalDAVList.collections[a].href){var t=globalResourceCalDAVList.collections[a].uid,l=$("#ResourceCalDAVList").find('[name^="'+t+'"]');if(t!==e||l.prop("checked")){if(t!==e&&l.prop("checked")){var o=globalVisibleCalDAVCollections.indexOf(t);o!==-1&&globalVisibleCalDAVCollections.splice(o,1),l.prop("checked",!1),globalSettings.displayhiddenevents.value&&hideCalendarEvents(t)}}else{var o=globalVisibleCalDAVCollections.indexOf(t);o===-1&&(globalVisibleCalDAVCollections[globalVisibleCalDAVCollections.length]=e),l.prop("checked",!0)}collectionChBoxClick(l.get(0),"#"+l.parent().parent().attr("id"),".resourceCalDAV_header",".resourceCalDAV_item",null,!1)}if(globalSettings.displayhiddenevents.value)showCalendarEvents(e);else{globalResourceRefreshNumber++,$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block");var n=$("#main").width()-$("#calendar").width();$("#calendar").fullCalendar("removeEvents"),$("#calendar").fullCalendar("removeEventSources");var r=!1,i=e.match(vCalendar.pre.accountUidParts),s="";null!=i&&(s=i[4]);var d=getResourceByCollection(e);if(null!=d&&"undefined"!=typeof d.backgroundCalendars&&null!=d.backgroundCalendars&&""!=d.backgroundCalendars){var c="";c=d.backgroundCalendars instanceof Array?d.backgroundCalendars:[d.backgroundCalendars];for(var g=0;g<c.length;g++)if("string"==typeof c[g]){var u=s.indexOf(c[g]);u!=-1&&s.length==u+c[g].length&&(r=!0)}else"object"==typeof c[g]&&null!=s.match(c[g])&&(r=!0)}var p=globalResourceCalDAVList.getCollectionByUID(e);if(p.fcSource=$("#calendar").fullCalendar("addEventSource",{events:globalEventList.displayEventsArray[e],backgroundColor:hexToRgba(p.ecolor,.9),borderColor:p.ecolor,textColor:checkFontColor(p.ecolor),background:r}),globalResourceRefreshNumber--,!globalResourceRefreshNumber){var f=$("#main").width()-$("#calendar").width();rerenderCalendar(n!=f),$("#CalendarLoader").css("display","none")}}}function enableOneTodo(e){for(var a=0;a<globalResourceCalDAVList.TodoCollections.length;a++)if(void 0!=globalResourceCalDAVList.TodoCollections[a].href){var t=globalResourceCalDAVList.TodoCollections[a].uid,l=$("#ResourceCalDAVTODOList").find('[name^="'+t+'"]');if(t!==e||l.prop("checked")){if(t!==e&&l.prop("checked")){var o=globalVisibleCalDAVTODOCollections.indexOf(t);o!==-1&&globalVisibleCalDAVTODOCollections.splice(o,1),l.prop("checked",!1),globalSettings.displayhiddenevents.value&&hideCalendarTodos(t)}}else{var o=globalVisibleCalDAVTODOCollections.indexOf(t);o===-1&&(globalVisibleCalDAVTODOCollections[globalVisibleCalDAVTODOCollections.length]=e),l.prop("checked",!0)}collectionChBoxClick(l.get(0),"#"+l.parent().parent().attr("id"),".resourceCalDAVTODO_header",".resourceCalDAVTODO_item",null,!1)}if(globalSettings.displayhiddenevents.value)showCalendarTodos(e),$("#todoList").fullCalendar("selectEvent");else{globalResourceRefreshNumberTodo++,$("#CalendarLoaderTODO").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader).parent().css("display","block");var n=$("#mainTODO").width()-$("#todoList").width();$("#todoList").fullCalendar("removeEvents"),$("#todoList").fullCalendar("removeEventSources");var r=!1,i=e.match(vCalendar.pre.accountUidParts),s="";null!=i&&(s=i[4]);var d=getResourceByCollection(e);if(null!=d&&"undefined"!=typeof d.backgroundCalendars&&null!=d.backgroundCalendars&&""!=d.backgroundCalendars){var c="";c=d.backgroundCalendars instanceof Array?d.backgroundCalendars:[d.backgroundCalendars];for(var g=0;g<c.length;g++)if("string"==typeof c[g]){var u=s.indexOf(c[g]);u!=-1&&s.length==u+c[g].length&&(r=!0)}else"object"==typeof c[g]&&null!=s.match(c[g])&&(r=!0)}var p=globalResourceCalDAVList.getTodoCollectionByUID(e);if(p.fcSource=$("#todoList").fullCalendar("addEventSource",{events:globalEventList.displayTodosArray[e],backgroundColor:hexToRgba(p.ecolor,.9),borderColor:p.ecolor}),globalResourceRefreshNumberTodo--,!globalResourceRefreshNumberTodo){var f=$("#mainTODO").width()-$("#todoList").width();rerenderTodo(n!=f),$("#CalendarLoaderTODO").css("display","none")}}}function getoffsetString(e){return e<0?(e*=-1,e="-"+(e<10?"0":"")+e.toString().split(".")[0]+(e.toString().split(".").length>1?"30":"00")):e="+"+(e<10?"0":"")+e.toString().split(".")[0]+(e.toString().split(".").length>1?"30":"00"),e}function setGlobalDateFunction(){var e=new Date;e.getTimezoneOffset()*-1*60*1e3}function initFullCalendar(){$("#calendar").fullCalendar({eventMode:!0,contentHeight:$("#main").height()-14,windowResize:function(e){globalSettings.displayhiddenevents.value&&hideEventCalendars(),globalCalWidth=$("#main").width(),"undefined"==typeof globalCalDAVInitLoad||globalCalDAVInitLoad||globalResourceRefreshNumber||$("#CalendarLoader").css("display","none")},bindingMode:globalSettings.openformmode.value,startOfBusiness:globalSettings.calendarstartofbusiness.value,endOfBusiness:globalSettings.calendarendofbusiness.value,multiWeekSize:globalMultiWeekSize,showWeekNumbers:!0,showDatepicker:!0,titleFormat:{month:globalSettings.titleformatmonth.value,multiWeek:globalSettings.titleformatweek.value,week:globalSettings.titleformatweek.value,day:globalSettings.titleformatday.value,table:globalSettings.titleformattable.value},columnFormat:{month:"ddd",multiWeek:"ddd",week:globalSettings.columnformatagenda.value,day:globalSettings.columnformatagenda.value,table:globalSettings.columnformatagenda.value},timeFormat:{agenda:globalSettings.timeformatagenda.value,list:globalSettings.ampmformat.value?"hh:mm TT{ - hh:mm TT}":"HH:mm{ - HH:mm}",listFull:dateFormatJqToFc(globalSettings.datepickerformat.value)+(globalSettings.ampmformat.value?" hh:mm TT{ - ":" HH:mm{ - ")+dateFormatJqToFc(globalSettings.datepickerformat.value)+(globalSettings.ampmformat.value?" hh:mm TT}":" HH:mm}"),listFullAllDay:dateFormatJqToFc(globalSettings.datepickerformat.value)+"{ - "+dateFormatJqToFc(globalSettings.datepickerformat.value)+"}","":globalSettings.timeformatbasic.value},axisFormat:globalSettings.ampmformat.value?"h:mm TT":"H:mm",buttonText:{month:localization[globalInterfaceLanguage].fullCalendarMonth,multiWeek:localization[globalInterfaceLanguage].fullCalendarMultiWeek,week:localization[globalInterfaceLanguage].fullCalendarAgendaWeek,day:localization[globalInterfaceLanguage].fullCalendarAgendaDay,table:localization[globalInterfaceLanguage].fullCalendarTable,today:localization[globalInterfaceLanguage].fullCalendarTodayButton,prevMonth:localization[globalInterfaceLanguage].loadPrevMonth,nextMonth:localization[globalInterfaceLanguage].loadNextMonth},allDayText:localization[globalInterfaceLanguage].fullCalendarAllDay,monthNames:localization[globalInterfaceLanguage].monthNames,monthNamesShort:localization[globalInterfaceLanguage].monthNamesShort,dayNames:localization[globalInterfaceLanguage].dayNames,dayNamesShort:localization[globalInterfaceLanguage].dayNamesShort,dayEventSizeStrict:!0,dayClick:function(e,a,t,l){return 0!=$("#ResourceCalDAVList .resourceCalDAV_item:visible").not(".resourceCalDAV_item_ro").length&&($("#show").val(""),$("#CAEvent").hide(),$("#timezonePicker").prop("disabled",!0),void $("#EventDisabler").fadeIn(globalEditorFadeAnimation,function(){showEventForm(e,a,null,t,"new",""),$("#name").focus()}))},beforeViewDisplay:function(e){globalAllowFcRerender&&$("#main").css("overflow","hidden")},viewDisplay:function(e){return globalAllowFcRerender&&$("#main").css("overflow",""),globalAllowFcRerender&&$("#main").width()-$("#calendar").width()?(globalAllowFcRerender=!1,$("#calendar").fullCalendar("render"),!1):(globalCalWidth=$("#main").width(),globalSettings.displayhiddenevents.value&&hideEventCalendars(),void(globalAllowFcRerender=!0))},firstDay:globalSettings.datepickerfirstdayofweek.value,weekendDays:globalSettings.weekenddays.value,header:{left:"prev,next today",center:"title",right:"month,multiWeek,agendaWeek,agendaDay"},listSections:"day",headerContainer:$("#main_h_placeholder"),defaultView:globalSettings.activeview.value,editable:!0,currentTimeIndicator:!0,unselectAuto:!1,eventClick:function(e,a,t){globalCalEvent=e,globalJsEvent=a,""==e.type?showEventForm(null,e.allDay,e,a,"show",""):showEventForm(null,e.allDay,e,a,"show","editOnly")},eventDragStart:function(e,a,t,l){globalPrevDragEventAllDay=e.allDay},eventDrop:function(e,a,t,l,o,n,r,i){if(""!=e.rid){var s=globalResourceCalDAVList.getCollectionByUID(e.res_id);if(null!=s&&s.permissions.read_only)return o(),!1}if(e.realStart&&e.realEnd){var d=new Date(e.realStart.getFullYear(),e.realStart.getMonth(),e.realStart.getDate()+a,e.realStart.getHours(),e.realStart.getMinutes()+t,0),c=new Date(e.realEnd.getFullYear(),e.realEnd.getMonth(),e.realEnd.getDate()+a,e.realEnd.getHours(),e.realEnd.getMinutes()+t,0);""!=e.type?(e.start=d,e.end=c):(e.realStart=d,e.realEnd=c)}else e.realStart=e.start,e.realEnd=e.end;globalRevertFunction=o,""!=e.type?showEventForm(null,e.allDay,e,n,"drop","editOnly"):showEventForm(null,e.allDay,e,n,"drop",""),save(!0),globalPrevDragEvent=null},eventResize:function(e,a,t,l,o,n,r){if(globalPrevDragEventAllDay=e.allDay,""!=e.rid){var i=globalResourceCalDAVList.getCollectionByUID(e.res_id);if(null!=i&&i.permissions.read_only)return l(),!1}if(e.realStart&&e.realEnd){var s=new Date(e.realEnd.getFullYear(),e.realEnd.getMonth(),e.realEnd.getDate()+a,e.realEnd.getHours(),e.realEnd.getMinutes()+t,0);""!=e.type?e.end=s:e.realEnd=s}else e.realEnd=e.end;globalRevertFunction=l,""!=e.type?showEventForm(null,e.allDay,e,o,"drop","editOnly"):showEventForm(null,e.allDay,e,o,"drop",""),save(!0)},eventResizeHelperCreated:function(e,a,t,l,o){t.hasClass("searchCalDAV_hide")&&l.addClass("searchCalDAV_hide"),t.hasClass("checkCalDAV_hide")&&l.addClass("checkCalDAV_hide")},selectable:!0,selectHelper:!1,select:function(e,a,t,l,o){$("#show").val(""),$("#CAEvent").hide(),$("#timezonePicker").prop("disabled",!0),$("#EventDisabler").fadeIn(globalEditorFadeAnimation,function(){var o=new Object;o.start=e,o.end=a,showEventForm(null,t,o,l,"new",""),$("#name").focus()})},eventAfterRender:function(e,a,t){a.attr("data-res-id",e.res_id),a.attr("data-id",e.id),a.addClass("event_item"),"CANCELLED"==e.status&&$(a).find(".fc-event-title").css("text-decoration","line-through"),"undefined"!=typeof e.hidden&&e.hidden&&(a.addClass("searchCalDAV_hide"),"table"!=t.name||$(a).siblings().addBack().not(".searchCalDAV_hide").length||$(a).parent().prev().find("tr").addClass("searchCalDAV_hide")),a.mouseenter(function(a){clearTimeout(globalEventTimeoutID),globalEventTimeoutID=setTimeout(function(){showEventPopup(a,e)},500)}),a.mousemove(function(e){$("#CalDavZAPPopup").is(":visible")&&moveEventPopup(e)}),a.mouseout(function(e){$.contains(a.get(0),e.relatedTarget)||(clearTimeout(globalEventTimeoutID),hideEventPopup())})},viewChanged:function(e){$("#CAEvent").hide()},todayClick:function(){$("#CAEvent").hide()},prevClick:function(){$("#CAEvent").hide(),getPrevMonths($("#calendar").fullCalendar("getView").start)},nextClick:function(){$("#CAEvent").hide(),getNextMonths($("#calendar").fullCalendar("getView").end)}})}function todoCheckClick(e,a,t){var l=t.repeatHash;"undefined"!=typeof globalTodolistStatusArray[l]&&"undefined"!=typeof globalTodolistStatusArray[l].timeout?clearTimeout(globalTodolistStatusArray[l].timeout):"undefined"==typeof globalTodolistStatusArray[l]&&(globalTodolistStatusArray[l]={}),
globalTodolistStatusArray[l].timeout=setTimeout(function(){if("undefined"!=typeof globalTodolistStatusArray[l]){$("#todoList").fullCalendar("allowSelectEvent",!1),fullVcalendarToTodoData(t,!1),"50"==a&&"undefined"!=typeof globalTodolistStatusArray[l].percent&&(a=globalTodolistStatusArray[l].percent);var o="",n=0;null!=vCalendar.tplM.VTbegin[l]&&void 0!=(process_elem=vCalendar.tplM.VTbegin[l][0])?o+=vCalendar.tplM.VTbegin[l][0]:(process_elem=vCalendar.tplC.VTbegin,process_elem=process_elem.replace("##:::##group_wd##:::##",""),o+=process_elem),null!=vCalendar.tplM.VTcontentline_VERSION[l]&&void 0!=(process_elem=vCalendar.tplM.VTcontentline_VERSION[l][0])?(parsed=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")),""!=parsed[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+parsed[1].replace(".","\\."),"mg"),"\r\nitem"+n++ +".").substring(2))):(process_elem=vCalendar.tplC.VTcontentline_VERSION,process_elem=process_elem.replace("##:::##group_wd##:::##","")),process_elem=process_elem.replace("##:::##version##:::##","2.0"),o+=process_elem,null!=vCalendar.tplM.VTcontentline_CALSCALE[l]&&void 0!=(process_elem=vCalendar.tplM.VTcontentline_CALSCALE[l][0])?(parsed=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")),""!=parsed[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+parsed[1].replace(".","\\."),"mg"),"\r\nitem"+n++ +".").substring(2))):(process_elem=vCalendar.tplC.VTcontentline_CALSCALE,process_elem=process_elem.replace("##:::##group_wd##:::##","")),process_elem=process_elem.replace("##:::##calscale##:::##","GREGORIAN"),o+=process_elem;var r=t.vcalendar.match(vCalendar.pre.contentline_UID);null!=r&&(r=r[0].match(vCalendar.pre.contentline_parse)[4]);var i="";""==t.type||""!=t.rec_id||globalSettings.appleremindersmode.value&&"undefined"==typeof globalAppleSupport.nextDates[t.id]?i=t.rec_id:""!=t.repeatStart&&t.start?"object"==typeof t.realStart?i=$.fullCalendar.formatDate(t.realStart,"yyyyMMdd'T'HHmmss"):"string"==typeof t.realStart&&(i=$.fullCalendar.formatDate($.fullCalendar.parseDate(t.realStart),"yyyyMMdd'T'HHmmss")):""!=t.repeatEnd&&t.end&&("object"==typeof t.realEnd?i=$.fullCalendar.formatDate(t.realEnd,"yyyyMMdd'T'HHmmss"):"string"==typeof t.realEnd&&(i=$.fullCalendar.formatDate($.fullCalendar.parseDate(t.realEnd),"yyyyMMdd'T'HHmmss")));var s=getRepeatTodoObject({rid:t.res_id,uidTodo:t.id,vcalendarHash:String(CryptoJS.SHA256(t.vcalendar)),vcalendarUID:r,recurrenceId:i,timezoneTODO:t.timeZone,futureStart:"",deleteMode:!1,vCalendarText:o});o=s.vCalendarText;var d=s.tzArray,c=(s.tzString,s.isTimeZone,s.origTimezone,s.appleTodoMode),g=t,u=s.newFirst,p=s.sel_option,f=!1,m="",v=o;c&&(o=""),null==g.start&&null==g.end||(globalSettings.timezonesupport.value&&(p=g.timeZone),"UTC"==p?(f=!0,m=""):m="local"==p?"":"custom"==p?";"+vcalendarEscapeValue("TZID="+g.timeZone):";"+vcalendarEscapeValue("TZID="+p),o.lastIndexOf("\r\n")!=o.length-2&&(o+="\r\n"),globalSettings.rewritetimezonecomponent.value||!vCalendar.tplM.unprocessedVTIMEZONE[l]?d.indexOf(p)==-1&&(o+=buildTimezoneComponent(p)):o+=vCalendar.tplM.VTunprocessedVTIMEZONE[l]),v+=o;var b=t.vcalendar;0==b.indexOf("\r\n")&&o.lastIndexOf("\r\n")==o.length-2&&(b=b.substring(2)),b.lastIndexOf("\r\n")!=b.length-2&&(b+="\r\n");var h,C="",D=new Date;if(h=D.getUTCFullYear()+(D.getUTCMonth()+1<10?"0":"")+(D.getUTCMonth()+1)+(D.getUTCDate()<10?"0":"")+D.getUTCDate()+"T"+(D.getUTCHours()<10?"0":"")+D.getUTCHours()+(D.getUTCMinutes()<10?"0":"")+D.getUTCMinutes()+(D.getUTCSeconds()<10?"0":"")+D.getUTCSeconds()+"Z",""==i)var T="orig";else var T=i;var y="";for(var _ in vCalendar.tplM.VTcontentline_CREATED[l])_==T&&(y=vCalendar.tplM.VTcontentline_CREATED[l][_]);var O=null;if(""==y&&(process_elem=vCalendar.tplC.VTcontentline_CREATED,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(h)),O=b.match(vCalendar.pre.contentline_CREATED),null!=O?b=b.replace(O[0],"\r\n"+process_elem):C+=process_elem),process_elem=vCalendar.tplC.VTcontentline_LM,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(h)),O=b.match(vCalendar.pre.contentline_LM),null!=O?b=b.replace(O[0],"\r\n"+process_elem):C+=process_elem,process_elem=vCalendar.tplC.VTcontentline_DTSTAMP,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(h)),O=b.match(vCalendar.pre.contentline_DTSTAMP),null!=O?b=b.replace(O[0],"\r\n"+process_elem):C+=process_elem,c){process_elem=vCalendar.tplC.VTcontentline_UID,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","");var L=globalEventList.getNewUID();process_elem=process_elem.replace("##:::##uid##:::##",L),O=b.match(vCalendar.pre.contentline_UID),null!=O&&(b=b.replace(O[0],"\r\n"+process_elem))}if(process_elem=vCalendar.tplC.VTcontentline_STATUS,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(e)),O=b.match(vCalendar.pre.contentline_STATUS),null!=O?b=b.replace(O[0],"\r\n"+process_elem):C+=process_elem,process_elem=vCalendar.tplC["VTcontentline_PERCENT-COMPLETE"],process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(a)),O=b.match(vCalendar.pre["contentline_PERCENT-COMPLETE"]),null!=O?b=b.replace(O[0],"\r\n"+process_elem):C+=process_elem,""!=i){c||(process_elem=vCalendar.tplC.VTcontentline_REC_ID,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),i.indexOf("T")==-1?(process_elem=process_elem.replace("##:::##AllDay##:::##",";"+vcalendarEscapeValue("VALUE=DATE")),process_elem=process_elem.replace("##:::##TZID##:::##",vcalendarEscapeValue("")),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(i))):(process_elem=process_elem.replace("##:::##AllDay##:::##",vcalendarEscapeValue("")),process_elem=process_elem.replace("##:::##TZID##:::##",m),f&&"Z"!=i.charAt(i.length-1)&&(i+="Z"),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(i))),O=b.match(vCalendar.pre.contentline_RECURRENCE_ID),null!=O?b=b.replace(O[0],"\r\n"+process_elem):C+=process_elem);var A=b.match(vCalendar.pre.contentline_RRULE2);for(null!=A&&(b=b.replace(A[0],"\r\n"));null!=b.match(vCalendar.pre.contentline_EXDATE);){var x=b.match(vCalendar.pre.contentline_EXDATE);null!=x&&(b=b.replace(x[0],"\r\n"))}}if(""!=g.realStart||""!=g.realEnd){if(""!=g.realStart&&!c){if(process_elem=vCalendar.tplC.VTcontentline_E_DTSTART,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),"object"==typeof g.realStart)var S=$.fullCalendar.formatDate(g.realStart,"yyyyMMdd'T'HHmmss");else if("string"==typeof g.realStart)var S=$.fullCalendar.formatDate($.fullCalendar.parseDate(g.realStart),"yyyyMMdd'T'HHmmss");if(process_elem=process_elem.replace("##:::##AllDay##:::##",vcalendarEscapeValue("")),process_elem=process_elem.replace("##:::##TZID##:::##",m),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(S+(f?"Z":""))),c){var I="";I=vCalendar.tplC.VTcontentline_DUE,I=I.replace("##:::##group_wd##:::##",""),I=I.replace("##:::##params_wsc##:::##",""),I=I.replace("##:::##AllDay##:::##",vcalendarEscapeValue("")),I=I.replace("##:::##TZID##:::##",m),I=I.replace("##:::##value##:::##",vcalendarEscapeValue(S+(f?"Z":""))),O=b.match(vCalendar.pre.contentline_DUE),null!=O?b=b.replace(O[0],"\r\n"+I):C+=I}O=b.match(vCalendar.pre.contentline_DTSTART),null!=O?b=b.replace(O[0],"\r\n"+process_elem):C+=process_elem}if(""!=g.realEnd){if(process_elem=vCalendar.tplC.VTcontentline_DUE,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),"object"==typeof g.realEnd)var V=$.fullCalendar.formatDate(g.realEnd,"yyyyMMdd'T'HHmmss");else if("string"==typeof g.realEnd)var V=$.fullCalendar.formatDate($.fullCalendar.parseDate(g.realEnd),"yyyyMMdd'T'HHmmss");if(process_elem=process_elem.replace("##:::##AllDay##:::##",vcalendarEscapeValue("")),process_elem=process_elem.replace("##:::##TZID##:::##",m),process_elem=process_elem.replace("##:::##value##:::##",vcalendarEscapeValue(V+(f?"Z":""))),globalSettings.appleremindersmode.value){var I="";I=vCalendar.tplC.VTcontentline_E_DTSTART,I=I.replace("##:::##group_wd##:::##",""),I=I.replace("##:::##params_wsc##:::##",""),I=I.replace("##:::##AllDay##:::##",vcalendarEscapeValue("")),I=I.replace("##:::##TZID##:::##",m),I=I.replace("##:::##value##:::##",vcalendarEscapeValue(V+(f?"Z":""))),O=b.match(vCalendar.pre.contentline_DTSTART),null!=O?b=b.replace(O[0],"\r\n"+I):C+=I}O=b.match(vCalendar.pre.contentline_DUE),null!=O?b=b.replace(O[0],"\r\n"+process_elem):C+=process_elem}}if("COMPLETED"==e&&"100"==a){var E=new Date;if(p="local",globalSettings.timezonesupport.value&&""!=g.timeZone&&"local"!=g.timeZone&&(p=g.timeZone),"local"!=p){var k=getOffsetByTZ(p,E),R=k.getSecondsFromOffset()*-1;E=new Date(E.setSeconds(R))}var w=$.fullCalendar.formatDate(E,"yyyyMMdd'T'HHmmss")+"Z";process_elem=vCalendar.tplC.VTcontentline_COMPLETED,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##",""),process_elem=process_elem.replace("##:::##value##:::##",w),O=b.match(vCalendar.pre.contentline_COMPLETED),null!=O?b=b.replace(O[0],"\r\n"+process_elem):C+=process_elem}else O=b.match(vCalendar.pre.contentline_COMPLETED),null!=O&&(b=b.replace(O[0],"\r\n"));"undefined"!=typeof vCalendar.tplM.VTalarm_STRING[l]&&""!=vCalendar.tplM.VTalarm_STRING[l]&&(C+=vCalendar.tplM.VTalarm_STRING[l]),""!=C&&(process_elem=vCalendar.tplC.VTendVTODO,process_elem=process_elem.replace("##:::##group_wd##:::##",""),O=b.match(vCalendar.re.endVTODO),null!=O&&(b=b.replace(O[0],C+process_elem))),o+=b,c&&(u+=0==o.indexOf("\r\n")&&u.lastIndexOf("\r\n")==u.length-2?o.substring(2,o.length):0==o.indexOf("\r\n")&&u.lastIndexOf("\r\n")!=u.length-2||0!=o.indexOf("\r\n")&&u.lastIndexOf("\r\n")==u.length-2?o:"\r\n"+o),c&&(o=""),null!=vCalendar.tplM.VTcontentline_PRODID[l]&&void 0!=(process_elem=vCalendar.tplM.VTcontentline_PRODID[l][0])?(parsed=("\r\n"+process_elem).match(RegExp("\r\n((?:"+vCalendar.re.group+"\\.)?)","m")),""!=parsed[1]&&(process_elem=("\r\n"+process_elem).replace(RegExp("\r\n"+parsed[1].replace(".","\\."),"mg"),"\r\nitem"+n++ +".").substring(2))):(process_elem=vCalendar.tplC.VTcontentline_PRODID,process_elem=process_elem.replace("##:::##group_wd##:::##",""),process_elem=process_elem.replace("##:::##params_wsc##:::##","")),process_elem=process_elem.replace("##:::##value##:::##","-//Inf-IT//"+globalAppName+" "+globalVersion+"//EN"),o+=process_elem,"undefined"!=typeof vCalendar.tplM.VTunprocessed[l]&&""!=vCalendar.tplM.VTunprocessed[l]&&null!=vCalendar.tplM.VTunprocessed[l]&&(c?v+=vCalendar.tplM.VTunprocessed[l].replace(RegExp("^\r\n"),""):o+=vCalendar.tplM.VTunprocessed[l].replace(RegExp("^\r\n"),"")),vCalendar.tplM.VTunprocessed[l]=new Array,null!=vCalendar.tplM.VTend[l]&&void 0!=(process_elem=vCalendar.tplM.VTend[l][0])?o+=vCalendar.tplM.VTend[l][0]:(process_elem=vCalendar.tplC.VTend,process_elem=process_elem.replace("##:::##group_wd##:::##",""),o+=process_elem);var z=new Array;if(c){u+=o,v.lastIndexOf("\r\n")!=v.length-2&&(v+="\r\n"),v+=o;var M=checkAndFixMultipleUID(u,!1);1==M.length?z[z.length]=v:z=M,o=u}var P=checkAndFixMultipleUID(o,!1);P=$.merge(z,P);var N=P[0];P.splice(0,1);var H=globalResourceCalDAVList.getTodoCollectionByUID(t.id.substring(0,t.id.lastIndexOf("/")+1)),F=getAccount(H.accountUID),U=F.href.match(vCalendar.pre.hrefRex),B=U[1]+F.userAuth.userName+"@"+U[2];return CalDAVeditor_cleanup(l),putVcalendarToCollection(B,t.id,t.etag,N,"","vtodo",!0,!1,P)}},globalTodoCheckTimeoutDelay)}function initTodoList(){$("#todoList").fullCalendar({eventMode:!1,showUnstartedEvents:globalSettings.appleremindersmode.value,simpleFilters:globalSettings.appleremindersmode.value,contentHeight:$("#mainTODO").height()-14,windowResize:function(e){globalSettings.displayhiddenevents.value&&hideTodoCalendars()},showDatepicker:!0,titleFormat:{todo:globalSettings.titleformattable.value},columnFormat:{todo:globalSettings.columnformatagenda.value},timeFormat:{list:dateFormatJqToFc(globalSettings.datepickerformat.value)+(globalSettings.ampmformat.value?" hh:mm TT":" HH:mm")},axisFormat:globalSettings.ampmformat.value?"h:mm TT":"H:mm",buttonText:{today:localization[globalInterfaceLanguage].fullCalendarTodayButton,filtersHeader:localization[globalInterfaceLanguage].txtStatusFiltersHeaderTODO,filtersFooter:localization[globalInterfaceLanguage].txtStatusFiltersFooterTODO,filterAction:localization[globalInterfaceLanguage].txtStatusNeedsActionTODO,filterProgress:localization[globalInterfaceLanguage].txtStatusInProcessTODO,filterCompleted:localization[globalInterfaceLanguage].txtStatusCompletedTODO,filterCanceled:localization[globalInterfaceLanguage].txtStatusCancelledTODO},allDayText:localization[globalInterfaceLanguage].fullCalendarAllDay,monthNames:localization[globalInterfaceLanguage].monthNames,monthNamesShort:localization[globalInterfaceLanguage].monthNamesShort,dayNames:localization[globalInterfaceLanguage].dayNames,dayNamesShort:localization[globalInterfaceLanguage].dayNamesShort,defaultFilters:globalSettings.todolistfilterselected.value,viewDisplay:function(e){globalSettings.displayhiddenevents.value&&hideTodoCalendars(),$(".fc-view-todo").removeClass("fc-view-trans")},firstDay:globalSettings.datepickerfirstdayofweek.value,weekendDays:globalSettings.weekenddays.value,header:{left:"prev,next today",center:"",right:""},listSections:"day",headerContainer:$("#mainTODO_h_placeholder"),defaultView:"todo",editable:!0,todoColThresholds:[{col:"priority",width:552},{col:"location",width:702}],todoOptionalCols:[{col:"time",width:142},{col:"priority",width:18},{col:"location",width:150}],selectEmpty:function(){"true"!==$("#todoInEdit").val()&&($("#CATodo").attr("style","display:none"),$("#todoColor").css("background-color",""))},eventClick:function(e,a,t){return"true"!=$("#todoInEdit").val()&&(globalCalTodo=e,void(""==e.type?showTodoForm(e,"show",""):!globalSettings.appleremindersmode.value||"COMPLETED"!=e.status&&"CANCELLED"!=e.status?globalSettings.appleremindersmode.value&&"undefined"==typeof globalAppleSupport.nextDates[e.id]?showTodoForm(e,"show",""):showTodoForm(e,"show","editOnly"):showTodoForm(e,"show","")))},eventCheckDefault:function(e,a,t){var l=parseInt(e.percent,10);globalSettings.appleremindersmode.value?a.prop("checked",l>99):(a.prop({checked:l>0,indeterminate:l>0&&l<100}),a.attr("data-ind",l>0&&l<100?"true":"false")),a.prop("disabled",globalResourceCalDAVList.getTodoCollectionByUID(e.res_id).permissions.read_only)},eventCheckClicked:function(e,a,t,l){t.stopPropagation();var o=e.parent().parent(),n=e.prop("checked"),r="true"===e.attr("data-ind"),i=o.hasClass("fc-event-cancelled");globalSettings.appleremindersmode.value||(e.prop({checked:r||!n&&!i?!n:n,indeterminate:n}),e.attr("data-ind",n?"true":"false"),o.toggleClass("fc-event-cancelled",!r&&!n&&!i));var s="",d="";e.prop("checked")?e.prop("indeterminate")?(s="50",d="IN-PROCESS"):o.hasClass("fc-event-cancelled")?(s="100",d="CANCELLED"):(s="100",d="COMPLETED"):(s="0",d="NEEDS-ACTION"),todoCheckClick(d,s,a)},eventAfterRender:function(e,a,t){a.attr("data-res-id",e.res_id),a.attr("data-repeat-hash",e.repeatHash),e.start?a.attr("data-start",$.fullCalendar.formatDate(e.start,"yyyyMMdd'T'HHmmss'Z'")):a.attr("data-start",""),a.attr("data-id",e.id),a.addClass("event_item");var l=e.title.replace(vCalendar.pre.compressNewLineRex," ");switch("CANCELLED"==e.status&&$(a).addClass("fc-event-cancelled"),e.filterStatus){case"filterAction":l+=" ("+localization[globalInterfaceLanguage].txtStatusNeedsActionTODO+")";break;case"filterProgress":l+=" ("+localization[globalInterfaceLanguage].txtStatusInProcessTODO+")";break;case"filterCompleted":l+=e.completedOn?" ("+localization[globalInterfaceLanguage].txtCompletedOn+" "+$.fullCalendar.formatDate(e.completedOn,dateFormatJqToFc(globalSettings.datepickerformat.value)+" "+(globalSettings.ampmformat.value?"h:mm TT":"H:mm"))+")":" ("+localization[globalInterfaceLanguage].txtStatusCompletedTODO+")";break;case"filterCanceled":l+=" ("+localization[globalInterfaceLanguage].txtStatusCancelledTODO+")"}a.attr("title",l),"undefined"!=typeof e.hidden&&e.hidden&&a.addClass("searchCalDAV_hide")},prevClick:function(){getPrevMonthsTodo()},nextClick:function(){getNextMonthsTodo()},datepickerClick:function(e){e>globalToLoadedLimitTodo?getNextMonthsTodo(!0):e<globalLoadedLimitTodo&&getPrevMonthsTodo(!0)}}),$("#todoList").fullCalendar("allowSelectEvent",!1)}function setFirstDayEvent(e){var a="undefined"!=typeof e?e:globalSettings.datepickerfirstdayofweek.value,t=$("#week_custom .customTable td"),l=t.parent(),o=$("#repeat_month_custom_select2 option"),n=$("#repeat_year_custom_select2 option");for(i=a;i<7;i++)l.append(t.filter('[data-type="'+i+'"]').detach()),o.filter('[data-type="'+i+'"]').detach().insertBefore(o.filter('[data-type="month_custom_month"]')),n.filter('[data-type="'+i+'"]').detach().insertBefore(n.filter('[data-type="year_custom_month"]'));for(i=0;i<a;i++)l.append(t.filter('[data-type="'+i+'"]').detach()),o.filter('[data-type="'+i+'"]').detach().insertBefore(o.filter('[data-type="month_custom_month"]')),n.filter('[data-type="'+i+'"]').detach().insertBefore(n.filter('[data-type="year_custom_month"]'));t.removeClass("firstCol lastCol"),t.filter('[data-type="'+a+'"]').addClass("firstCol"),t.filter('[data-type="'+(a+6)%7+'"]').addClass("lastCol")}function setFirstDayTodo(e){var a="undefined"!=typeof e?e:globalSettings.datepickerfirstdayofweek.value,t=$("#week_custom_TODO .customTable td"),l=t.parent(),o=$("#repeat_month_custom_select2_TODO option"),n=$("#repeat_year_custom_select2_TODO option");for(i=a;i<7;i++)l.append(t.filter('[data-type="'+i+'"]').detach()),o.filter('[data-type="'+i+'"]').detach().insertBefore(o.filter('[data-type="month_custom_month"]')),n.filter('[data-type="'+i+'"]').detach().insertBefore(n.filter('[data-type="year_custom_month"]'));for(i=0;i<a;i++)l.append(t.filter('[data-type="'+i+'"]').detach()),o.filter('[data-type="'+i+'"]').detach().insertBefore(o.filter('[data-type="month_custom_month"]')),n.filter('[data-type="'+i+'"]').detach().insertBefore(n.filter('[data-type="year_custom_month"]'));t.removeClass("firstCol lastCol"),t.filter('[data-type="'+a+'"]').addClass("firstCol"),t.filter('[data-type="'+(a+6)%7+'"]').addClass("lastCol")}function checkEventFormScrollBar(){if($("#eventDetailsContainer").is(":hidden"))return!1;var e=413,a=$("#event_details_template").width()-$("#eventDetailsContainer").width();$("#event_details_template").width(e+a),$("#eventColor").height($("#eventDetailsContainer").height()+12)}function checkTodoFormScrollBar(){var e=413,a=$("#todo_details_template").width()-$("#todoDetailsContainer").width(),t=parseInt($("#mainTODO").css("right"),10),l=e+a;return t===l||($("#main_h_TODO, #searchFormTODO, #mainTODO").css("right",l),$("#TodoDisabler").css("right",l+1),$("#todoForm_h, #todoLoader").width(l),$("#todoColor").css("right",l-3),$("#todoForm").width(l-3),void $(window).resize())}function initTimepicker(e){if(timelist=new Array,e){globalTimePre=new RegExp("^ *((((0?[1-9]|1[0-2]):[0-5]?[0-9])|((0[1-9]|1[0-2])[0-5][0-9])) *AM|(((0?[1-9]|1[0-2]):[0-5]?[0-9])|((0[1-9]|1[0-2])[0-5][0-9])) *PM) *$","i");for(var a=0;a<24;a++)for(var t=0;t<minelems.length;t++)timelist.push((0==a?12:a<13?a:a-12).pad(2)+":"+minelems[t].pad(2)+(a<12?" AM":" PM"))}else{globalTimePre=new RegExp("^ *((([0-1]?[0-9]|2[0-3]):[0-5]?[0-9])|(([0-1][0-9]|2[0-3])[0-5][0-9])) *$","i");for(var a=0;a<24;a++)for(var t=0;t<minelems.length;t++)timelist.push(a.pad(2)+":"+minelems[t].pad(2))}}function showEventPrevNav(){$("#CAEvent .formNav.prev").click(function(){eventPrevNavClick()}),$("#CAEvent .header").addClass("leftspace"),$("#CAEvent .formNav.prev").css("display","block")}function showEventNextNav(){$("#CAEvent .formNav.next").click(function(){eventNextNavClick()}),$("#CAEvent .header").addClass("rightspace"),$("#CAEvent .formNav.next").css("display","block")}function showTodoPrevNav(e){var a="top";e&&(a="bottom"),$("#CATodo .formNav.prev."+a).click(function(){todoPrevNavClick(e)}),$("#CATodo .header").addClass("leftspace"),$("#CATodo .formNav.prev."+a).css("display","block")}function showTodoNextNav(e){var a="top";e&&(a="bottom"),$("#CATodo .formNav.next."+a).click(function(){todoNextNavClick(e)}),$("#CATodo .header").addClass("rightspace"),$("#CATodo .formNav.next."+a).css("display","block")}function eventPrevNavClick(){var e=jQuery.grep(globalEventList.displayEventsArray[globalCalEvent.res_id],function(e){if(e.id==globalCalEvent.id)return!0}).sort(repeatStartCompare);e.indexOf(globalCalEvent)!=-1&&e.indexOf(globalCalEvent)>0&&(globalCalEvent=e[e.indexOf(globalCalEvent)-1],showEventForm(null,globalCalEvent.allDay,globalCalEvent,globalJsEvent,"show","editOnly"))}function eventNextNavClick(){var e=jQuery.grep(globalEventList.displayEventsArray[globalCalEvent.res_id],function(e){if(e.id==globalCalEvent.id)return!0}).sort(repeatStartCompare);e.indexOf(globalCalEvent)!=-1&&e.indexOf(globalCalEvent)<e.length-1&&(globalCalEvent=e[e.indexOf(globalCalEvent)+1],showEventForm(null,globalCalEvent.allDay,globalCalEvent,globalJsEvent,"show","editOnly"))}function todoPrevNavClick(e){var a=jQuery.grep(globalEventList.displayTodosArray[globalCalTodo.res_id],function(e){if(e.id==globalCalTodo.id)return!0}).sort(repeatStartCompare);if(a.indexOf(globalCalTodo)!=-1&&a.indexOf(globalCalTodo)>0){if(e){for(var t=a.indexOf(globalCalTodo)-1;t>=0;t--)if("COMPLETED"!=a[t].status){globalCalTodo=a[t];break}}else globalCalTodo=a[a.indexOf(globalCalTodo)-1];showTodoForm(globalCalTodo,"show","editOnly")}}function todoNextNavClick(e){var a=jQuery.grep(globalEventList.displayTodosArray[globalCalTodo.res_id],function(e){if(e.id==globalCalTodo.id)return!0}).sort(repeatStartCompare);if(a.indexOf(globalCalTodo)!=-1&&a.indexOf(globalCalTodo)<a.length-1){if(e){for(var t=a.indexOf(globalCalTodo)+1;t<a.length;t++)if("COMPLETED"!=a[t].status){globalCalTodo=a[t];break}}else globalCalTodo=a[a.indexOf(globalCalTodo)+1];showTodoForm(globalCalTodo,"show","editOnly")}}function todoStatusChanged(e){if("COMPLETED"==e){var a=new Date;$(".completedOnTr").show(),""==$("#completedOnDate").val()&&$("#completedOnDate").val($.datepicker.formatDate(globalSettings.datepickerformat.value,a)),""==$("#completedOnTime").val()&&$("#completedOnTime").val($.fullCalendar.formatDate(a,globalSettings.ampmformat.value?"hh:mm TT":"HH:mm")),$("#completedOnDate, #completedOnTime").change()}else $("#completedOnDate, #completedOnTime").parent().find("img").css("display","none"),$(".completedOnTr").hide();checkTodoFormScrollBar()}function initKbTodoNavigation(){$(document.documentElement).keyup(function(e){if("undefined"==typeof globalActiveApp||"CalDavTODO"!=globalActiveApp||"undefined"==typeof globalObjectLoading||1==globalObjectLoading)return!0;if("hidden"!=$("#SystemCalDavTODO").css("visibility")&&isCalDAVLoaded&&"none"==$("#TodoDisabler").css("display")&&!$("#searchInputTODO").is(":focus")){var a=null,t=null;1==(a=$("#SystemCalDavTODO").find(".fc-event-selected").parent()).length&&(38==e.keyCode&&(t=a.prevAll(".fc-list-section").find(".fc-event").filter(":visible").last()).length||40==e.keyCode&&(t=a.nextAll(".fc-list-section").find(".fc-event").filter(":visible").first()).length)&&$("#todoList").fullCalendar("selectEvent",t)}}),$(document.documentElement).keydown(function(e){if("undefined"==typeof globalActiveApp||"CalDavTODO"!=globalActiveApp||"undefined"==typeof globalObjectLoading||1==globalObjectLoading)return!0;if("hidden"!=$("#SystemCalDavTODO").css("visibility")&&isCalDAVLoaded&&"none"==$("#TodoDisabler").css("display")&&!$("#searchInputTODO").is(":focus")){var a=null,t=null;if(1==(a=$("#SystemCalDavTODO").find(".fc-event-selected").parent()).length){var l=$("#todoList").find(".fc-list-content");if(38==e.keyCode&&(t=a.prevAll(".fc-list-section").find(".fc-event").filter(":visible").last()).length||40==e.keyCode&&(t=a.nextAll(".fc-list-section").find(".fc-event").filter(":visible").first()).length)switch(e.keyCode){case 38:if(e.preventDefault(),l.scrollTop()>l.scrollTop()+t.offset().top-l.offset().top-l.height()*globalKBNavigationPaddingRate)l.scrollTop(l.scrollTop()+t.offset().top-l.offset().top-l.height()*globalKBNavigationPaddingRate);else{if(!(l.scrollTop()<l.scrollTop()+t.offset().top+t.height()-l.offset().top-l.height()*(1-globalKBNavigationPaddingRate)))return!1;l.scrollTop(l.scrollTop()+t.offset().top+t.height()-l.offset().top-l.height()*(1-globalKBNavigationPaddingRate))}break;case 40:if(e.preventDefault(),l.scrollTop()<l.scrollTop()+t.offset().top+t.height()-l.offset().top-l.height()*(1-globalKBNavigationPaddingRate))l.scrollTop(l.scrollTop()+t.offset().top+t.height()-l.offset().top-l.height()*(1-globalKBNavigationPaddingRate));else{if(!(l.scrollTop()>l.scrollTop()+t.offset().top-l.offset().top-l.height()*globalKBNavigationPaddingRate))return!1;l.scrollTop(l.scrollTop()+t.offset().top-l.offset().top-l.height()*globalKBNavigationPaddingRate)}}else switch(e.keyCode){case 38:l.scrollTop(0);break;case 40:l.scrollTop(l.prop("scrollHeight"))}}}})}function translateEventAlerts(){$('[data-type="alert"]').text(localization[globalInterfaceLanguage].txtAlert),$(".alert").find('[data-type="alert_none"]').text(localization[globalInterfaceLanguage].txtAlertNone),$(".alert").find('[data-type="alert_message"]').text(localization[globalInterfaceLanguage].txtAlertMessage),$('[data-type="PH_before_after_alert"]').attr("placeholder",localization[globalInterfaceLanguage].pholderAfterBeforeVal),$('[data-type="PH_alarm_date"]').attr("placeholder",localization[globalInterfaceLanguage].pholderAlarmDate),$('[data-type="PH_alarm_time"]').attr("placeholder",localization[globalInterfaceLanguage].pholderAlarmTime),$(".alert_details").find('[data-type="on_date"]').text(localization[globalInterfaceLanguage].txtAlertOnDate),$(".alert_details").find('[data-type="weeks_before"]').text(localization[globalInterfaceLanguage].txtAlertWeeksBefore),$(".alert_details").find('[data-type="days_before"]').text(localization[globalInterfaceLanguage].txtAlertDaysBefore),$(".alert_details").find('[data-type="hours_before"]').text(localization[globalInterfaceLanguage].txtAlertHoursBefore),$(".alert_details").find('[data-type="minutes_before"]').text(localization[globalInterfaceLanguage].txtAlertMinutesBefore),$(".alert_details").find('[data-type="seconds_before"]').text(localization[globalInterfaceLanguage].txtAlertSecondsBefore),$(".alert_details").find('[data-type="weeks_after"]').text(localization[globalInterfaceLanguage].txtAlertWeeksAfter),$(".alert_details").find('[data-type="days_after"]').text(localization[globalInterfaceLanguage].txtAlertDaysAfter),$(".alert_details").find('[data-type="hours_after"]').text(localization[globalInterfaceLanguage].txtAlertHoursAfter),$(".alert_details").find('[data-type="minutes_after"]').text(localization[globalInterfaceLanguage].txtAlertMinutesAfter),$(".alert_details").find('[data-type="seconds_after"]').text(localization[globalInterfaceLanguage].txtAlertSecondsAfter)}function translateTodoAlerts(){$('[data-type="alert_TODO"]').text(localization[globalInterfaceLanguage].txtAlertTODO),$(".alertTODO").find('[data-type="alert_none_TODO"]').text(localization[globalInterfaceLanguage].txtAlertNone),$(".alertTODO").find('[data-type="alert_message_TODO"]').text(localization[globalInterfaceLanguage].txtAlertMessage),$('[data-type="PH_before_after_alert_TODO"]').attr("placeholder",localization[globalInterfaceLanguage].pholderAfterBeforeValTODO),$('[data-type="PH_alarm_date_TODO"]').attr("placeholder",localization[globalInterfaceLanguage].pholderAlarmDateTODO),$('[data-type="PH_alarm_time_TODO"]').attr("placeholder",localization[globalInterfaceLanguage].pholderAlarmTimeTODO),$(".alert_detailsTODO").find('[data-type="on_dateTODO"]').text(localization[globalInterfaceLanguage].txtAlertOnDateTODO),$(".alert_detailsTODO").find('[data-type="weeks_beforeTODO"]').text(localization[globalInterfaceLanguage].txtAlertWeeksBeforeTODO),$(".alert_detailsTODO").find('[data-type="days_beforeTODO"]').text(localization[globalInterfaceLanguage].txtAlertDaysBeforeTODO),$(".alert_detailsTODO").find('[data-type="hours_beforeTODO"]').text(localization[globalInterfaceLanguage].txtAlertHoursBeforeTODO),$(".alert_detailsTODO").find('[data-type="minutes_beforeTODO"]').text(localization[globalInterfaceLanguage].txtAlertMinutesBeforeTODO),$(".alert_detailsTODO").find('[data-type="seconds_beforeTODO"]').text(localization[globalInterfaceLanguage].txtAlertSecondsBeforeTODO),$(".alert_detailsTODO").find('[data-type="weeks_afterTODO"]').text(localization[globalInterfaceLanguage].txtAlertWeeksAfterTODO),$(".alert_detailsTODO").find('[data-type="days_afterTODO"]').text(localization[globalInterfaceLanguage].txtAlertDaysAfterTODO),$(".alert_detailsTODO").find('[data-type="hours_afterTODO"]').text(localization[globalInterfaceLanguage].txtAlertHoursAfterTODO),$(".alert_detailsTODO").find('[data-type="minutes_afterTODO"]').text(localization[globalInterfaceLanguage].txtAlertMinutesAfterTODO),$(".alert_detailsTODO").find('[data-type="seconds_afterTODO"]').text(localization[globalInterfaceLanguage].txtAlertSecondsAfterTODO)}function translate(){for($.datepicker.regional[globalInterfaceLanguage]={monthNames:localization[globalInterfaceLanguage].monthNames,monthNamesShort:localization[globalInterfaceLanguage].monthNamesShort,dayNames:localization[globalInterfaceLanguage].dayNames,dayNamesShort:localization[globalInterfaceLanguage].dayNamesShort,dayNamesMin:localization[globalInterfaceLanguage].dayNamesMin},$.datepicker.setDefaults($.datepicker.regional[globalInterfaceLanguage]),$('[data-type="system_username"]').attr("placeholder",localization[globalInterfaceLanguage].pholderUsername),$('[data-type="system_password"]').attr("placeholder",localization[globalInterfaceLanguage].pholderPassword),$('[data-type="system_login"]').attr({title:localization[globalInterfaceLanguage].buttonLogin,alt:localization[globalInterfaceLanguage].buttonLogin}),$('.resourceCalDAV_text[data-type="resourcesCalDAV_txt"]').text(localization[globalInterfaceLanguage].txtCalendars),$('[data-type="choose_calendar_TODO"]').text(localization[globalInterfaceLanguage].txtSelectCalendarTODO),$('[data-type="todo_txt"]').text(localization[globalInterfaceLanguage].txtTodo),$("#eventFormShower").attr("alt",localization[globalInterfaceLanguage].altAddEvent),$("#showUnloadedCalendars").attr({title:capitalize(localization[globalInterfaceLanguage].txtEnabledCalendars),alt:capitalize(localization[globalInterfaceLanguage].txtEnabledCalendars)}),$("#showUnloadedCalendarsTODO").attr({title:capitalize(localization[globalInterfaceLanguage].txtEnabledTodoLists),alt:capitalize(localization[globalInterfaceLanguage].txtEnabledTodoLists)}),$("#loadUnloadedCalendars, #loadUnloadedCalendarsTODO").val(localization[globalInterfaceLanguage].buttonSave),$("#loadUnloadedCalendarsCancel, #loadUnloadedCalendarsTODOCancel").val(localization[globalInterfaceLanguage].buttonCancel),$('.resourceCalDAVTODO_text[data-type="resourcesCalDAV_txt"]').text(localization[globalInterfaceLanguage].txtTodoLists),$('[data-type="name_TODO"]').attr("placeholder",localization[globalInterfaceLanguage].pholderNameTODO),
$('[data-type="type_TODO"]').text(localization[globalInterfaceLanguage].txtTypeTODO),$('[data-type="todo_type_none"]').text(localization[globalInterfaceLanguage].txtTypeTODONone),$('[data-type="todo_type_start"]').text(localization[globalInterfaceLanguage].txtTypeTODOStart),$('[data-type="todo_type_due"]').text(localization[globalInterfaceLanguage].txtTypeTODODue),$('[data-type="todo_type_both"]').text(localization[globalInterfaceLanguage].txtTypeTODOBoth),$('[data-type="date_from_TODO"]').text(localization[globalInterfaceLanguage].txtDateFromTODO),$('[data-type="date_to_TODO"]').text(localization[globalInterfaceLanguage].txtDateToTODO),$('[data-type="PH_completedOn"]').text(localization[globalInterfaceLanguage].txtCompletedOn),$('[data-type="PH_date_from_TODO"]').attr("placeholder",localization[globalInterfaceLanguage].pholderDateFromTODO),$('[data-type="PH_time_from_TODO"]').attr("placeholder",localization[globalInterfaceLanguage].pholderTimeFromTODO),$('[data-type="PH_date_to_TODO"]').attr("placeholder",localization[globalInterfaceLanguage].pholderDateToTODO),$('[data-type="PH_time_to_TODO"]').attr("placeholder",localization[globalInterfaceLanguage].pholderTimeToTODO),$('[data-type="PH_completedOnDate"]').attr("placeholder",localization[globalInterfaceLanguage].pholderCompletedOnDate),$('[data-type="PH_completedOnTime"]').attr("placeholder",localization[globalInterfaceLanguage].pholderCompletedOnTime),$('[data-type="status_TODO"]').text(localization[globalInterfaceLanguage].txtStatus),$('[data-type="STATUS_NEEDS-ACTION_TODO"]').text(localization[globalInterfaceLanguage].txtStatusNeedsActionTODO),$('[data-type="STATUS_COMPLETED_TODO"]').text(localization[globalInterfaceLanguage].txtStatusCompletedTODO),$('[data-type="STATUS_IN-PROCESS_TODO"]').text(localization[globalInterfaceLanguage].txtStatusInProcessTODO),$('[data-type="STATUS_CANCELLED_TODO"]').text(localization[globalInterfaceLanguage].txtStatusCancelledTODO),$('[data-type="percent_complete_TODO"]').text(localization[globalInterfaceLanguage].txtPercentCompletedTODO),$('[data-type="priority_TODO"]').text(localization[globalInterfaceLanguage].txtPriority),$('[data-type="priority_TODO_none"]').text(localization[globalInterfaceLanguage].txtPriorityNone),$('[data-type="priority_TODO_low"]').text(localization[globalInterfaceLanguage].txtPriorityLow),$('[data-type="priority_TODO_medium"]').text(localization[globalInterfaceLanguage].txtPriorityMedium),$('[data-type="priority_TODO_high"]').text(localization[globalInterfaceLanguage].txtPriorityHigh),$('[data-type="calendar_TODO"]').text(localization[globalInterfaceLanguage].txtTodoList),$('[data-type="note_TODO"]').text(localization[globalInterfaceLanguage].txtNoteTODO),$('[data-type="PH_note_TODO"]').attr("placeholder",localization[globalInterfaceLanguage].pholderNoteTODO),$('[data-type="txt_availTODO"]').text(localization[globalInterfaceLanguage].eventAvailability),$('[data-type="BUSY_AVAIL_TODO"]').text(localization[globalInterfaceLanguage].eventAvailabilityBusy),$('[data-type="FREE_AVAIL_TODO"]').text(localization[globalInterfaceLanguage].eventAvailabilityFree),$('[data-type="txt_typeTODO"]').text(localization[globalInterfaceLanguage].eventType),$('[data-type="PUBLIC_TYPE_TODO"]').text(localization[globalInterfaceLanguage].eventTypePublic),$('[data-type="PRIVATE_TYPE_TODO"]').text(localization[globalInterfaceLanguage].eventTypePrivate),$('[data-type="CONFIDENTIAL_TYPE_TODO"]').text(localization[globalInterfaceLanguage].eventTypeConfidential),$('[data-type="txt_url_TODO"]').text(localization[globalInterfaceLanguage].eventURL),$('[data-type="url_TODO"]').attr("placeholder",localization[globalInterfaceLanguage].eventURL),$('[data-type="todo_prev_nav"]').attr("title",localization[globalInterfaceLanguage].todoPrevNav),$('[data-type="todo_next_nav"]').attr("title",localization[globalInterfaceLanguage].todoNextNav),$('[data-type="todo_prev_uncompleted_nav"]').attr("title",localization[globalInterfaceLanguage].todoUncompletedPrevNav),$('[data-type="todo_next_uncompleted_nav"]').attr("title",localization[globalInterfaceLanguage].todoUncompletedNextNav),$("#saveTODO").val(localization[globalInterfaceLanguage].buttonSaveTODO),$("#editTODO").val(localization[globalInterfaceLanguage].buttonEditTODO),$("#duplicateTODO").val(localization[globalInterfaceLanguage].buttonDuplicate),$("#resetTODO").val(localization[globalInterfaceLanguage].buttonResetTODO),$("#closeTODO").val(localization[globalInterfaceLanguage].buttonCloseTODO),$("#deleteTODO").val(localization[globalInterfaceLanguage].buttonDeleteTODO),$('[data-type="name"]').attr("placeholder",localization[globalInterfaceLanguage].pholderName),$('[data-type="location"]').text(localization[globalInterfaceLanguage].txtLocation),$('[data-type="PH_location"]').attr("placeholder",localization[globalInterfaceLanguage].pholderLocation),$('[data-type="all_day"]').text(localization[globalInterfaceLanguage].txtAllDay),$('[data-type="from"]').text(localization[globalInterfaceLanguage].from),$('[data-type="to"]').text(localization[globalInterfaceLanguage].to),$('[data-type="PH_date_from"]').attr("placeholder",localization[globalInterfaceLanguage].pholderDateFrom),$('[data-type="PH_time_from"]').attr("placeholder",localization[globalInterfaceLanguage].pholderTimeFrom),$('[data-type="PH_date_to"]').attr("placeholder",localization[globalInterfaceLanguage].pholderDateTo),$('[data-type="PH_time_to"]').attr("placeholder",localization[globalInterfaceLanguage].pholderTimeTo),$('[data-type="repeat"]').text(localization[globalInterfaceLanguage].txtRepeat),$('[data-type="PH_until_date"]').attr("placeholder",localization[globalInterfaceLanguage].pholderUntilDate),$('[data-type="PH_repeat_count"]').attr("placeholder",localization[globalInterfaceLanguage].pholderRepeatCount),$('[data-type="repeat_end"]').text(localization[globalInterfaceLanguage].txtRepeatEnd),$('[data-type="show_as"]').text(localization[globalInterfaceLanguage].txtShowAs),$('[data-type="priority"]').text(localization[globalInterfaceLanguage].txtPriority),$('[data-type="priority_none"]').text(localization[globalInterfaceLanguage].txtPriorityNone),$('[data-type="priority_low"]').text(localization[globalInterfaceLanguage].txtPriorityLow),$('[data-type="priority_medium"]').text(localization[globalInterfaceLanguage].txtPriorityMedium),$('[data-type="priority_high"]').text(localization[globalInterfaceLanguage].txtPriorityHigh),$('[data-type="event_calendar"]').text(localization[globalInterfaceLanguage].txtEventCalendar),$('[data-type="choose_calendar"]').text(localization[globalInterfaceLanguage].txtSelectCalendar),$('[data-type="note"]').text(localization[globalInterfaceLanguage].txtNote),$('[data-type="PH_note"]').attr("placeholder",localization[globalInterfaceLanguage].pholderNote),$('[data-type="status"]').text(localization[globalInterfaceLanguage].txtStatus),$('[data-type="STATUS_NONE"]').text(localization[globalInterfaceLanguage].txtStatusNone),$('[data-type="STATUS_TENTATIVE"]').text(localization[globalInterfaceLanguage].txtStatusTentative),$('[data-type="STATUS_CONFIRMED"]').text(localization[globalInterfaceLanguage].txtStatusConfirmed),$('[data-type="STATUS_CANCELLED"]').text(localization[globalInterfaceLanguage].txtStatusCancelled),$('[data-type="txt_avail"]').text(localization[globalInterfaceLanguage].eventAvailability),$('[data-type="BUSY_AVAIL"]').text(localization[globalInterfaceLanguage].eventAvailabilityBusy),$('[data-type="FREE_AVAIL"]').text(localization[globalInterfaceLanguage].eventAvailabilityFree),$('[data-type="txt_type"]').text(localization[globalInterfaceLanguage].eventType),$('[data-type="PUBLIC_TYPE"]').text(localization[globalInterfaceLanguage].eventTypePublic),$('[data-type="PRIVATE_TYPE"]').text(localization[globalInterfaceLanguage].eventTypePrivate),$('[data-type="CONFIDENTIAL_TYPE"]').text(localization[globalInterfaceLanguage].eventTypeConfidential),$('[data-type="txt_url_EVENT"]').text(localization[globalInterfaceLanguage].eventURL),$('[data-type="url_EVENT"]').attr("placeholder",localization[globalInterfaceLanguage].eventURL),$('[data-type="repeat_no-repeat"]').text(localization[globalInterfaceLanguage].txtNoRepeat),$('[data-type="repeat_DAILY"]').text(localization[globalInterfaceLanguage].txtRepeatDay),$('[data-type="repeat_WEEKLY"]').text(localization[globalInterfaceLanguage].txtRepeatWeek),$('[data-type="repeat_WEEKEND"]').text(localization[globalInterfaceLanguage].txtRepeatWeekend),$('[data-type="repeat_MONTHLY"]').text(localization[globalInterfaceLanguage].txtRepeatMonth),$('[data-type="repeat_TWO_WEEKLY"]').text(localization[globalInterfaceLanguage].txtRepeatTwoWeek),$('[data-type="repeat_YEARLY"]').text(localization[globalInterfaceLanguage].txtRepeatYear),$('[data-type="repeat_CUSTOM_WEEKLY"]').text(localization[globalInterfaceLanguage].txtRepeatCustomWeek),$('[data-type="repeat_CUSTOM_MONTHLY"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonth),$('[data-type="repeat_CUSTOM_YEARLY"]').text(localization[globalInterfaceLanguage].txtRepeatCustomYear),$('[data-type="repeat_BUSINESS"]').text(localization[globalInterfaceLanguage].txtRepeatWork),$('[data-type="week_custom_txt"]').text(localization[globalInterfaceLanguage].txtRepeatCustomWeekLabel),$('[data-type="month_custom2_txt"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthLabel),$('[data-type="month_custom_every"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthEvery),$('[data-type="month_custom_first"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthFirst),$('[data-type="month_custom_second"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthSecond),$('[data-type="month_custom_third"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthThird),$('[data-type="month_custom_fourth"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthFourth),$('[data-type="month_custom_fifth"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthFifth),$('[data-type="month_custom_last"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthLast),$('[data-type="month_custom_custom"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthCustom),$('[data-type="month_custom_month"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthMonth),$('[data-type="year_custom1"]').text(localization[globalInterfaceLanguage].txtRepeatCustomYearLabel1),$('[data-type="year_custom3"]').text(localization[globalInterfaceLanguage].txtRepeatCustomYearLabel2),$('[data-type="year_custom_every"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthEvery),$('[data-type="year_custom_first"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthFirst),$('[data-type="year_custom_second"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthSecond),$('[data-type="year_custom_third"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthThird),$('[data-type="year_custom_fourth"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthFourth),$('[data-type="year_custom_fifth"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthFifth),$('[data-type="year_custom_last"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthLast),$('[data-type="year_custom_custom"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthCustom),$('[data-type="year_custom_month"]').text(localization[globalInterfaceLanguage].txtRepeatCustomMonthMonth),i=0;i<12;i++)$('#year_custom3 .customTable td[data-type="'+i+'"]').text(localization[globalInterfaceLanguage].monthNamesShort[i]),$('#year_custom3_TODO .customTable td[data-type="'+i+'"]').text(localization[globalInterfaceLanguage].monthNamesShort[i]);for(i=0;i<7;i++)$('#repeat_month_custom_select2 option[data-type="'+i+'"]').text(localization[globalInterfaceLanguage].dayNames[i]),$('#repeat_month_custom_select2_TODO option[data-type="'+i+'"]').text(localization[globalInterfaceLanguage].dayNames[i]),$('#repeat_year_custom_select2 option[data-type="'+i+'"]').text(localization[globalInterfaceLanguage].dayNames[i]),$('#repeat_year_custom_select2_TODO option[data-type="'+i+'"]').text(localization[globalInterfaceLanguage].dayNames[i]);for(i=0;i<7;i++)$('#week_custom .customTable td[data-type="'+i+'"]').text(localization[globalInterfaceLanguage].dayNamesMin[i]),$('#week_custom_TODO .customTable td[data-type="'+i+'"]').text(localization[globalInterfaceLanguage].dayNamesMin[i]);$('[data-type="repeat_details_on_date"]').text(localization[globalInterfaceLanguage].txtRepeatOnDate),$('[data-type="repeat_details_after"]').text(localization[globalInterfaceLanguage].txtRepeatAfter),$('[data-type="repeat_details_never"]').text(localization[globalInterfaceLanguage].txtRepeatNever),$('[data-type="event_prev_nav"]').attr("title",localization[globalInterfaceLanguage].eventPrevNav),$('[data-type="event_next_nav"]').attr("title",localization[globalInterfaceLanguage].eventNextNav),$("#saveButton").val(localization[globalInterfaceLanguage].buttonSave),$("#editButton").val(localization[globalInterfaceLanguage].buttonEdit),$("#duplicateButton").val(localization[globalInterfaceLanguage].buttonDuplicate),$("#resetButton").val(localization[globalInterfaceLanguage].buttonReset),$("#closeButton").val(localization[globalInterfaceLanguage].buttonClose),$("#deleteButton").val(localization[globalInterfaceLanguage].buttonDelete),$("#alertsH").text(localization[globalInterfaceLanguage].txtAlertsH),$("#alertButton").val(localization[globalInterfaceLanguage].buttonAlert),$('[data-type="PH_CalDAVsearch"]').attr("placeholder",localization[globalInterfaceLanguage].CalDAVsearch),$('[data-type="addAll"]').attr("title",localization[globalInterfaceLanguage].allEnable),$('[data-type="addAll"]').attr("alt",localization[globalInterfaceLanguage].allEnable),$('[data-type="removeAll"]').attr("title",localization[globalInterfaceLanguage].allDisable),$('[data-type="removeAll"]').attr("alt",localization[globalInterfaceLanguage].allDisable),$('[data-type="txt_timezone"]').text(localization[globalInterfaceLanguage].timezone),$('[data-type="txt_timezonePicker"]').text(localization[globalInterfaceLanguage].txtTimezonePicker),$('[data-type="txt_timezoneTODO"]').text(localization[globalInterfaceLanguage].timezone),$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader),$("#CalendarLoaderTODO").children(".loaderInfo").text(localization[globalInterfaceLanguage].calendarLoader),$('[data-type="repeat_event"]').text(localization[globalInterfaceLanguage].repeatBoxButton),$('[data-type="editOptions"]').attr("value",localization[globalInterfaceLanguage].repeatBoxButton),$('[data-type="editOptionsTODO"]').attr("value",localization[globalInterfaceLanguage].repeatBoxButton),$("#editAll").val(localization[globalInterfaceLanguage].allEvsButton),$("#editFuture").val(localization[globalInterfaceLanguage].allFutureButton),$("#editOnlyOne").val(localization[globalInterfaceLanguage].eventOnlyButton),$("#editAllTODO").val(localization[globalInterfaceLanguage].allEvsButtonTODO),$("#editFutureTODO").val(localization[globalInterfaceLanguage].allFutureButtonTODO),$("#editOnlyOneTODO").val(localization[globalInterfaceLanguage].eventOnlyButtonTODO),$('[data-type="closeRepeat"]').val(localization[globalInterfaceLanguage].buttonClose),$('[data-type="repeat_type"]').text(localization[globalInterfaceLanguage].repeatInterval),$("#CalDavZAPPopup").find('[data-type="location_txt"]').text(localization[globalInterfaceLanguage].txtLocation),$("#CalDavZAPPopup").find('[data-type="from_txt"]').text(localization[globalInterfaceLanguage].from),$("#CalDavZAPPopup").find('[data-type="to_txt"]').text(localization[globalInterfaceLanguage].to),$("#CalDavZAPPopup").find('[data-type="status_txt"]').text(localization[globalInterfaceLanguage].txtStatus),$("#CalDavZAPPopup").find('[data-type="avail_txt"]').text(localization[globalInterfaceLanguage].eventAvailability),$("#CalDavZAPPopup").find('[data-type="type_txt"]').text(localization[globalInterfaceLanguage].eventType),$("#CalDavZAPPopup").find('[data-type="priority_txt"]').text(localization[globalInterfaceLanguage].txtPriority),$("#CalDavZAPPopup").find('[data-type="calendar_txt"]').text(localization[globalInterfaceLanguage].txtEventCalendar),$("#CalDavZAPPopup").find('[data-type="url_txt"]').text(localization[globalInterfaceLanguage].eventURL),$("#CalDavZAPPopup").find('[data-type="note_txt"]').text(localization[globalInterfaceLanguage].txtNote),translateEventAlerts(),translateTodoAlerts()}function selectActiveCalendar(){var e="";if(!globalEventCollectionsLoading&&"event"!=globalSettingsSaving){$("#ResourceCalDAVList").find(".resourceCalDAV_item_selected").removeClass("resourceCalDAV_item_selected");for(var a=0;a<globalResourceCalDAVList.collections.length;a++)if(void 0!=globalResourceCalDAVList.collections[a].uid){var t=globalResourceCalDAVList.collections[a],l=t.uid.split("/");""!=globalSettings.calendarselected.value&&(l[l.length-3]+"/"+l[l.length-2]+"/"==globalSettings.calendarselected.value?0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAV_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"):t.uid==globalSettings.calendarselected.value?0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAV_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"):"object"==typeof globalSettings.calendarselected.value&&null!=t.uid.match(globalSettings.calendarselected.value)&&0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAV_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"))}if(0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length)for(var a=0;a<globalResourceCalDAVList.collections.length;a++)if(void 0!=globalResourceCalDAVList.collections[a].uid){var t=globalResourceCalDAVList.collections[a],l=t.uid.split("/");"undefined"!=typeof globalCalendarSelected&&null!=globalCalendarSelected&&""!=globalCalendarSelected&&(globalSettings.calendarselected.value=globalCalendarSelected,l[l.length-3]+"/"+l[l.length-2]+"/"==globalSettings.calendarselected.value?0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAV_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"):t.uid==globalSettings.calendarselected.value?0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAV_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"):"object"==typeof globalSettings.calendarselected.value&&null!=t.uid.match(globalSettings.calendarselected.value)&&0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAV_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"))}if(0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item[data-id]:visible").length>0){var o=$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item[data-id]:visible").eq(0).attr("data-id"),n=o.split("/");globalSettings.calendarselected.value=n[n.length-3]+"/"+n[n.length-2]+"/",$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item[data-id]:visible").eq(0).addClass("resourceCalDAV_item_selected")}}if(e="TODO",!globalTodoCollectionsLoading&&"todo"!=globalSettingsSaving){$("#ResourceCalDAVTODOList").find(".resourceCalDAV_item_selected").removeClass("resourceCalDAV_item_selected");for(var a=0;a<globalResourceCalDAVList.TodoCollections.length;a++)if(void 0!=globalResourceCalDAVList.TodoCollections[a].uid){var t=globalResourceCalDAVList.TodoCollections[a],l=t.uid.split("/");""!=globalSettings.todocalendarselected.value&&(l[l.length-3]+"/"+l[l.length-2]+"/"==globalSettings.todocalendarselected.value?0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAVTODO_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"):t.uid==globalSettings.todocalendarselected.value?0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAVTODO_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"):"object"==typeof globalSettings.todocalendarselected.value&&null!=t.uid.match(globalSettings.todocalendarselected.value)&&0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAVTODO_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"))}if(0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length)for(var a=0;a<globalResourceCalDAVList.TodoCollections.length;a++)if(void 0!=globalResourceCalDAVList.TodoCollections[a].uid){var t=globalResourceCalDAVList.TodoCollections[a],l=t.uid.split("/");"undefined"!=typeof globalTodoCalendarSelected&&null!=globalTodoCalendarSelected&&""!=globalTodoCalendarSelected&&(globalSettings.todocalendarselected.value=globalTodoCalendarSelected,l[l.length-3]+"/"+l[l.length-2]+"/"==globalSettings.todocalendarselected.value?0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAVTODO_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"):t.uid==globalSettings.todocalendarselected.value?0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAVTODO_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"):"object"==typeof globalSettings.todocalendarselected.value&&null!=t.uid.match(globalSettings.todocalendarselected.value)&&0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find('.resourceCalDAVTODO_item:visible[data-id^="'+t.uid+'"]').addClass("resourceCalDAV_item_selected"))}if(0==$("#ResourceCalDAV"+e+"List").find(".resourceCalDAV_item_selected:visible").length&&$("#ResourceCalDAV"+e+"List").find(".resourceCalDAVTODO_item[data-id]:visible").length>0){var o=$("#ResourceCalDAV"+e+"List").find(".resourceCalDAVTODO_item[data-id]:visible").eq(0).attr("data-id"),n=o.split("/");globalSettings.todocalendarselected.value=n[n.length-3]+"/"+n[n.length-2]+"/",$("#ResourceCalDAV"+e+"List").find(".resourceCalDAVTODO_item[data-id]:visible").eq(0).addClass("resourceCalDAV_item_selected")}}}function hideCalendarEvents(e){$("#SystemCalDavZAP").find('.event_item[data-res-id="'+e+'"]').each(function(){$(this).addClass("checkCalDAV_hide"),"tr"==this.tagName.toLowerCase()&&($(this).siblings().addBack().not(".checkCalDAV_hide").length>0?$(this).parent().prev().find("tr").removeClass("checkCalDAV_hide"):$(this).parent().prev().find("tr").addClass("checkCalDAV_hide"))})}function hideCalendarTodos(e){$("#SystemCalDavTODO").find('.event_item[data-res-id="'+e+'"]').addClass("checkCalDAV_hide")}function showCalendarEvents(e){$("#SystemCalDavZAP").find('.event_item[data-res-id="'+e+'"]').each(function(){$(this).removeClass("checkCalDAV_hide"),"tr"==this.tagName.toLowerCase()&&$(this).parent().prev().find("tr").removeClass("checkCalDAV_hide")})}function showCalendarTodos(e){$("#SystemCalDavTODO").find('.event_item[data-res-id="'+e+'"]').removeClass("checkCalDAV_hide")}function hideEventCalendars(){for(var e=1;e<globalResourceCalDAVList.collections.length;e++){var a=globalResourceCalDAVList.collections[e].uid;void 0!=a&&globalVisibleCalDAVCollections.indexOf(a)==-1&&hideCalendarEvents(a)}}function hideTodoCalendars(){for(var e=1;e<globalResourceCalDAVList.TodoCollections.length;e++){var a=globalResourceCalDAVList.TodoCollections[e].uid;void 0!=a&&globalVisibleCalDAVTODOCollections.indexOf(a)==-1&&hideCalendarTodos(a)}}function rerenderCalendar(e){e&&$("#calendar").fullCalendar("render"),globalSettings.displayhiddenevents.value&&hideEventCalendars()}function rerenderTodo(e){e&&$("#todoList").fullCalendar("render"),globalSettings.displayhiddenevents.value&&hideTodoCalendars()}function refetchCalendarEvents(){var e=$("#main").width()-$("#calendar").width();$("#calendar").fullCalendar("refetchEvents");var a=$("#main").width()-$("#calendar").width();rerenderCalendar(e!=a),globalCalDAVQs.cache()}function refetchTodoEvents(){var e=$("#mainTODO").width()-$("#todoList").width();$("#todoList").fullCalendar("refetchEvents");var a=$("#mainTODO").width()-$("#todoList").width();rerenderTodo(e!=a),globalCalDAVTODOQs.cache()}function initCalDavDatepicker(e){var a=e.find(".date");a.focus(function(){$(this).hasClass("hasDatepicker")||($(this).datepicker({disabled:$(this).prop("readonly")||$(this).prop("disabled"),showMonthAfterYear:!1,prevText:"",nextText:"",monthNamesShort:["01","02","03","04","05","06","07","08","09","10","11","12"],dateFormat:globalSettings.datepickerformat.value,defaultDate:null,minDate:"-120y",maxDate:"+120y",yearRange:"c-120:c+120",showAnim:"",firstDay:globalSettings.datepickerfirstdayofweek.value,weekendDays:globalSettings.weekenddays.value,beforeShow:function(e,a){a.dpDiv.addClass("ui-datepicker-simple");var t=!0;try{var l=$.datepicker.parseDate(globalSettings.datepickerformat.value,$(this).val())}catch(e){t=!1}if(1==t&&null!=l){var o=$(this).datepicker("option","dateFormat",globalSettings.datepickerformat.value).datepicker("option","minDate"),n=$(this).datepicker("option","dateFormat",globalSettings.datepickerformat.value).datepicker("option","maxDate"),r=$.datepicker.parseDate(globalSettings.datepickerformat.value,o),i=$.datepicker.parseDate(globalSettings.datepickerformat.value,n);l<r?$(this).val(o):l>i&&$(this).val(n)}var s=$(this).attr("data-type"),d=new Date;if(void 0!=globalTmpTimePickerHackTime[s]&&d.getTime()-globalTmpTimePickerHackTime[s]<200)return!1},onClose:function(e,a){var t=!0;try{var l=$.datepicker.parseDate(globalSettings.datepickerformat.value,e)}catch(e){t=!1}if(1==t&&null!=l){var o=$(this).datepicker("option","dateFormat",globalSettings.datepickerformat.value).datepicker("option","minDate"),n=$(this).datepicker("option","dateFormat",globalSettings.datepickerformat.value).datepicker("option","maxDate"),r=$.datepicker.parseDate(globalSettings.datepickerformat.value,o),i=$.datepicker.parseDate(globalSettings.datepickerformat.value,n);l<r?$(this).val(o):l>i?$(this).val(n):$(this).val($.datepicker.formatDate(globalSettings.datepickerformat.value,l))}var s=$(this).attr("data-type"),d=new Date;globalTmpTimePickerHackTime[s]=d.getTime(),$(this).focus()}}),$(this).mousedown(function(){"none"==$(this).datepicker("widget").css("display")?$(this).datepicker("show"):$(this).datepicker("hide")}),$(this).on("keydown",function(e){void 0!=this.selectionStart&&this.selectionStart!=-1&&((38!=e.which&&37!=e.which||0!=this.selectionStart)&&(40!=e.which&&39!=e.which||this.selectionStart!=$(this).val().length)||("none"==$(this).datepicker("widget").css("display")?$(this).datepicker("show"):$(this).datepicker("hide")))}),$(this).blur(function(e){var a=!0;try{var t=$.datepicker.parseDate(globalSettings.datepickerformat.value,$(this).val())}catch(e){a=!1}if(""==$(this).val()&&(a=!1),1==a&&$(this).val()!=$.datepicker.formatDate(globalSettings.datepickerformat.value,t)){var l=$(this).datepicker("option","dateFormat",globalSettings.datepickerformat.value).datepicker("option","minDate"),o=$(this).datepicker("option","dateFormat",globalSettings.datepickerformat.value).datepicker("option","maxDate"),n=$.datepicker.parseDate(globalSettings.datepickerformat.value,l),r=$.datepicker.parseDate(globalSettings.datepickerformat.value,o);t<n?$(this).val(l):t>r?$(this).val(o):$(this).val($.datepicker.formatDate(globalSettings.datepickerformat.value,t))}if("date_from"==$(this).attr("id")){var i=$("#time_from").val(),s=!0,d="";""!=globalPrevDate&&(d=new Date(globalPrevDate.getTime()));try{$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_from").val())}catch(e){s=!1}if(""!=$("#date_from").val()&&null!=i.match(globalTimePre)&&s){var c=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_from").val()),g=$.fullCalendar.formatDate(c,"yyyy-MM-dd"),u=new Date(Date.parse("01/02/1990, "+$("#time_from").val())),p=$.fullCalendar.formatDate(u,"HH:mm:ss"),f=$.fullCalendar.parseDate(g+"T"+p);globalPrevDate=new Date(f.getTime())}else globalPrevDate="";if("date_from"==$(this).attr("id")&&""!=d&&""!=globalPrevDate){globalPrevDate.setSeconds(0),globalPrevDate.setMilliseconds(0),d.setSeconds(0),d.setMilliseconds(0);var m=globalPrevDate.getTime()-d.getTime();try{$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_to").val())}catch(e){s=!1}if(""!=$("#date_to").val()&&null!=$("#time_to").val().match(globalTimePre)&&s){var v=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_to").val()),g=$.fullCalendar.formatDate(v,"yyyy-MM-dd"),b=new Date(Date.parse("01/02/1990, "+$("#time_to").val())),h=$.fullCalendar.formatDate(b,"HH:mm:ss"),C=$.fullCalendar.parseDate(g+"T"+h),D=new Date(C.getTime()+m),T=$.datepicker.formatDate(globalSettings.datepickerformat.value,D);$("#date_to").val(T),$("#time_to").val($.fullCalendar.formatDate(D,globalSettings.ampmformat.value?"hh:mm TT":"HH:mm"))}}}else if("both"==$("#todo_type").val()&&"date_fromTODO"==$(this).attr("id")){var i=$("#time_fromTODO").val(),s=!0,d="";""!=globalPrevDate&&(d=new Date(globalPrevDate.getTime()));try{$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_fromTODO").val())}catch(e){s=!1}if(""!=$("#date_fromTODO").val()&&null!=i.match(globalTimePre)&&s){var c=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_fromTODO").val()),g=$.fullCalendar.formatDate(c,"yyyy-MM-dd"),u=new Date(Date.parse("01/02/1990, "+$("#time_fromTODO").val())),p=$.fullCalendar.formatDate(u,"HH:mm:ss"),f=$.fullCalendar.parseDate(g+"T"+p);globalPrevDate=new Date(f.getTime())}else globalPrevDate="";if("date_fromTODO"==$(this).attr("id")&&""!=d&&""!=globalPrevDate){globalPrevDate.setSeconds(0),globalPrevDate.setMilliseconds(0),d.setSeconds(0),d.setMilliseconds(0);var m=globalPrevDate.getTime()-d.getTime();try{$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_toTODO").val())}catch(e){s=!1}if(""!=$("#date_toTODO").val()&&null!=$("#time_toTODO").val().match(globalTimePre)&&s){var v=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_toTODO").val()),g=$.fullCalendar.formatDate(v,"yyyy-MM-dd"),b=new Date(Date.parse("01/02/1990, "+$("#time_toTODO").val())),h=$.fullCalendar.formatDate(b,"HH:mm:ss"),C=$.fullCalendar.parseDate(g+"T"+h),D=new Date(C.getTime()+m),T=$.datepicker.formatDate(globalSettings.datepickerformat.value,D);$("#date_toTODO").val(T),$("#time_toTODO").val($.fullCalendar.formatDate(D,globalSettings.ampmformat.value?"hh:mm TT":"HH:mm"))}}}}),$(this).bind("keyup change",function(){if(!$(this).prop("readonly")&&!$(this).prop("disabled")){var e=!1;if(""!=$(this).val()){e=!0;try{$.datepicker.parseDate(globalSettings.datepickerformat.value,$(this).val())}catch(a){e=!1}}if("completedOnDate"==$(this).attr("id")&&(""==$(this).val()?""==$("#completedOnTime").val()?(e=!0,$("#completedOnTime").parent().find("img").css("display","none")):e=!1:e&&(""==$("#completedOnTime").val()?$("#completedOnTime").parent().find("img").css("display","inline"):$("#completedOnTime").parent().find("img").css("display","none"))),e?($(this).parent().find("img").css("display","none"),"date_from"==$(this).attr("id")&&$("#repeat_end_date").is(":visible")&&$("#repeat_end_date").keyup(),
"date_fromTODO"!=$(this).attr("id")&&"date_toTODO"!=$(this).attr("id")||!$("#repeat_end_date_TODO").is(":visible")||$("#repeat_end_date_TODO").keyup()):$(this).parent().find("img").css("display","inline"),"repeat_end_date"==$(this).attr("id")){if(e&&""!=$("#date_from").val()){$(this).parent().find("img").css("display","inline");var a=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_from").val());if(null!=a){var t=$.datepicker.parseDate(globalSettings.datepickerformat.value,$(this).val());null!=t&&t>=a&&$(this).parent().find("img").css("display","none")}}}else if(e&&"repeat_end_date_TODO"==$(this).attr("id"))if($("#date_fromTODO").is(":visible")&&""!=$("#date_fromTODO").val()){$(this).parent().find("img").css("display","inline");var a=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_fromTODO").val());if(null!=a){var t=$.datepicker.parseDate(globalSettings.datepickerformat.value,$(this).val());null!=t&&t>=a&&$(this).parent().find("img").css("display","none")}}else if($("#date_toTODO").is(":visible")&&""!=$("#date_toTODO").val()){$(this).parent().find("img").css("display","inline");var a=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_toTODO").val());if(null!=a){var t=$.datepicker.parseDate(globalSettings.datepickerformat.value,$(this).val());null!=t&&t>=a&&$(this).parent().find("img").css("display","none")}}}}),$(this).datepicker("show"))})}function initCalDavTimepicker(e){var a=e.find(".time");a.focus(function(){$(this).autocomplete({create:function(e,a){$(this).data("ui-autocomplete").menu.element.addClass("ui-autocomplete-caldav")},close:function(e,a){$(this).keyup()},source:function(e,a){var t=new RegExp("^"+$.ui.autocomplete.escapeRegex(e.term),"i");a($.grep(timelist,function(e){return e=e.label||e.value||e,t.test(e)||t.test(e.multiReplace(globalSearchTransformAlphabet))}))},minLength:0})}),a.blur(function(){var e=$.trim($(this).val());if(null!=e.match(globalTimePre)){if(e.indexOf(":")==-1)e=globalSettings.ampmformat.value?e.indexOf(" ")==-1?e.substring(0,2)+":"+e.substring(2,4)+" "+e.substring(4,6):e.substring(0,2)+":"+e.substring(2,4)+" "+e.substring(5,7):e.substring(0,2)+":"+e.substring(2,4);else if(globalSettings.ampmformat.value){var a=e.split(":")[0];a=parseInt(a,10);var t=e.split(":")[1].substring(0,e.split(":")[1].length-2);t=parseInt(t,10),e=(a<10?"0":"")+a+":"+(t<10?"0":"")+t+" "+e.split(":")[1].substring(e.split(":")[1].length-2,e.split(":")[1].length)}else{var a=e.split(":")[0];a=parseInt(a,10);var t=e.split(":")[1];t=parseInt(t,10),e=(a<10?"0":"")+a+":"+(t<10?"0":"")+t}7==e.length?e=e.substring(0,5)+" "+e.substring(5,7):6==e.length&&e.indexOf(":")!=-1&&(e=e.substring(0,2)+":"+e.substring(2,4)+" "+e.substring(4,6)),$(this).val(e.toUpperCase())}if("time_from"==$(this).attr("id")){var l=!0,o="";""!=globalPrevDate&&(o=new Date(globalPrevDate.getTime()));try{$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_from").val())}catch(e){l=!1}if(null!=e.match(globalTimePre)&&l){var n=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_from").val()),r=$.fullCalendar.formatDate(n,"yyyy-MM-dd"),i=new Date(Date.parse("01/02/1990, "+$("#time_from").val())),s=$.fullCalendar.formatDate(i,"HH:mm:ss"),d=$.fullCalendar.parseDate(r+"T"+s);globalPrevDate=new Date(d.getTime())}else globalPrevDate="";if("time_from"==$(this).attr("id")&&""!=o&&""!=globalPrevDate){globalPrevDate.setSeconds(0),globalPrevDate.setMilliseconds(0),o.setSeconds(0),o.setMilliseconds(0);var c=globalPrevDate.getTime()-o.getTime();try{$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_to").val())}catch(e){l=!1}if(""!=$("#date_to").val()&&null!=$("#time_to").val().match(globalTimePre)&&l){var g=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_to").val()),r=$.fullCalendar.formatDate(g,"yyyy-MM-dd"),u=new Date(Date.parse("01/02/1990, "+$("#time_to").val())),p=$.fullCalendar.formatDate(u,"HH:mm:ss"),f=$.fullCalendar.parseDate(r+"T"+p),m=new Date(f.getTime()+c),v=$.datepicker.formatDate(globalSettings.datepickerformat.value,m);$("#date_to").val(v),$("#time_to").val($.fullCalendar.formatDate(m,globalSettings.ampmformat.value?"hh:mm TT":"HH:mm"))}}}else if("both"==$("#todo_type").val()&&"time_fromTODO"==$(this).attr("id")){var l=!0,o="";""!=globalPrevDate&&(o=new Date(globalPrevDate.getTime()));try{$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_fromTODO").val())}catch(e){l=!1}if(null!=e.match(globalTimePre)&&l){var n=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_fromTODO").val()),r=$.fullCalendar.formatDate(n,"yyyy-MM-dd"),i=new Date(Date.parse("01/02/1990, "+$("#time_fromTODO").val())),s=$.fullCalendar.formatDate(i,"HH:mm:ss"),d=$.fullCalendar.parseDate(r+"T"+s);globalPrevDate=new Date(d.getTime())}else globalPrevDate="";if("time_fromTODO"==$(this).attr("id")&&""!=o&&""!=globalPrevDate){globalPrevDate.setSeconds(0),globalPrevDate.setMilliseconds(0),o.setSeconds(0),o.setMilliseconds(0);var c=globalPrevDate.getTime()-o.getTime();try{$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_toTODO").val())}catch(e){l=!1}if(""!=$("#date_toTODO").val()&&null!=$("#time_toTODO").val().match(globalTimePre)&&l){var g=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_toTODO").val()),r=$.fullCalendar.formatDate(g,"yyyy-MM-dd"),u=new Date(Date.parse("01/02/1990, "+$("#time_toTODO").val())),p=$.fullCalendar.formatDate(u,"HH:mm:ss"),f=$.fullCalendar.parseDate(r+"T"+p),m=new Date(f.getTime()+c),v=$.datepicker.formatDate(globalSettings.datepickerformat.value,m);$("#date_toTODO").val(v),$("#time_toTODO").val($.fullCalendar.formatDate(m,globalSettings.ampmformat.value?"hh:mm TT":"HH:mm"))}}}}),a.bind("keyup change",function(){var e=$.trim($(this).val());"completedOnTime"!=$(this).attr("id")?null==e.match(globalTimePre)?$(this).parent().find("img").css("display","inline"):$(this).parent().find("img").css("display","none"):""==$(this).val()?""==$("#completedOnDate").val()?($(this).parent().find("img").css("display","none"),$("#completedOnDate").parent().find("img").css("display","none")):$(this).parent().find("img").css("display","inline"):null==e.match(globalTimePre)?$(this).parent().find("img").css("display","inline"):($(this).parent().find("img").css("display","none"),""==$("#completedOnDate").val()?$("#completedOnDate").parent().find("img").css("display","inline"):$("#completedOnDate").parent().find("img").css("display","none"))}),a.dblclick(function(){if(""!=$(this).val())return!1;var e=new Date,a="";if(void 0!=$(this).attr("id")&&$(this).attr("id").indexOf("TODO")!=-1&&(a="TODO"),"time_to"==$(this).attr("id")||"time_toTODO"==$(this).attr("id")&&"none"!=$(".dateTrFromTODO").css("display")){$(this).val();if("none"==$("#time_from"+a).parent().find("img").css("display")&&"none"==$("#date_from"+a).parent().find("img").css("display")&&"none"==$("#date_to"+a).parent().find("img").css("display")){var t=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_from"+a).val()),l=t.getFullYear()+"/"+(t.getMonth()<10?"0":"")+(t.getMonth()+1)+"/"+(t.getDate()<10?"0":"")+t.getDate(),o=new Date(Date.parse(l+", "+$("#time_from"+a).val()));e=new Date(o.getTime());var n=$.datepicker.parseDate(globalSettings.datepickerformat.value,$("#date_to"+a).val()),r=n.getFullYear()+"/"+(n.getMonth()<10?"0":"")+(n.getMonth()+1)+"/"+(n.getDate()<10?"0":"")+n.getDate(),i=new Date(Date.parse(r+", "+$("#time_from"+a).val()));if(l==r){e.setHours(e.getHours()+1);var s=new Date(Date.parse(r+", "+$.fullCalendar.formatDate(e,globalSettings.ampmformat.value?"hh:mm TT":"HH:mm")));s<i&&(s.setHours(23),s.setMinutes(59),e=new Date(s.getTime()))}}}"time_from"!=$(this).attr("id")&&"time_fromTODO"!=$(this).attr("id")||""!=globalPrevDate&&(globalPrevDate.setHours(e.getHours()),globalPrevDate.setMinutes(e.getMinutes())),$(this).val($.fullCalendar.formatDate(e,globalSettings.ampmformat.value?"hh:mm TT":"HH:mm")),$(this).keyup()})}function duplicateEvent(e){"TODO"==e?(startEditModeTodo(),$("#showTODO").val(""),$("#uidTODO").val(""),$("#vcalendarHashTODO").val(""),$("#vcalendarUIDTODO").val(""),$("#etagTODO").val(""),$("#todoInEdit").val("true"),$("#deleteTODO").hide(),$("#resetTODO").hide(),$("#editTODO").hide(),$("#duplicateTODO").hide(),$("#editOptionsButtonTODO").hide()):(startEditModeEvent(),$("#uid").val(""),$("#show").val(""),$("#etag").val(""),$("#vcalendarHash").val(""),$("#vcalendarUID").val(""),$("#editButton").hide(),$("#duplicateButton").hide(),$("#editOptionsButton").hide(),$("#resetButton").hide(),$("#deleteButton").hide())}function showNewEvent(e){return 0!=$("#ResourceCalDAV"+e+"List .resourceCalDAV"+e+"_item:visible").not(".resourceCalDAV_item_ro").length&&($("#timezonePicker"+e).prop("disabled",!0),void("TODO"==e?($("#TodoDisabler").fadeIn(globalEditorFadeAnimation),showTodoForm(null,"new"),$("#nameTODO").focus()):($("#show").val(""),$("#CAEvent").hide(),$("#EventDisabler").fadeIn(globalEditorFadeAnimation,function(){showEventForm(new Date,!0,null,null,"new",""),$("#name").focus()}))))}function showEventPopup(e,a){var t,l,o,n,r,i,s=globalResourceCalDAVList.getCollectionByUID(a.res_id);switch(a.allDay?(t=$.fullCalendar.formatDate(a.realStart,dateFormatJqToFc(globalSettings.datepickerformat.value)),l=$.fullCalendar.formatDate(a.realEnd,dateFormatJqToFc(globalSettings.datepickerformat.value))):(t=$.fullCalendar.formatDate(a.realStart,dateFormatJqToFc(globalSettings.datepickerformat.value)+"'&emsp;'"+(globalSettings.ampmformat.value?"hh:mm TT":"HH:mm")),l=$.fullCalendar.formatDate(a.realEnd,dateFormatJqToFc(globalSettings.datepickerformat.value)+"'&emsp;'"+(globalSettings.ampmformat.value?"hh:mm TT":"HH:mm"))),a.status){case"NONE":o=localization[globalInterfaceLanguage].txtStatusNone;break;case"TENTATIVE":o=localization[globalInterfaceLanguage].txtStatusTentative;break;case"CONFIRMED":o=localization[globalInterfaceLanguage].txtStatusConfirmed;break;case"CANCELLED":o=localization[globalInterfaceLanguage].txtStatusCancelled;break;default:o=localization[globalInterfaceLanguage].txtStatusNone}switch(a.avail){case"OPAQUE":n=localization[globalInterfaceLanguage].eventAvailabilityBusy;break;case"TRANSPARENT":n=localization[globalInterfaceLanguage].eventAvailabilityFree;break;default:n=localization[globalInterfaceLanguage].eventAvailabilityBusy}switch(a.classType){case"PUBLIC":r=localization[globalInterfaceLanguage].eventTypePublic;break;case"CONFIDENTIAL":r=localization[globalInterfaceLanguage].eventTypeConfidential;break;case"PRIVATE":r=localization[globalInterfaceLanguage].eventTypePrivate;break;default:r=localization[globalInterfaceLanguage].eventTypePublic}var d=parseInt(a.priority,10);i=5==d?localization[globalInterfaceLanguage].txtPriorityMedium:d>5&&d<10?localization[globalInterfaceLanguage].txtPriorityLow:d<5&&d>0?localization[globalInterfaceLanguage].txtPriorityHigh:localization[globalInterfaceLanguage].txtPriorityNone;var c=512;""==a.title?$("#CalDavZAPPopup").find('[data-type="name"]').parent().css("display","none"):$("#CalDavZAPPopup").find('[data-type="name"]').text(a.title.length>c?a.title.substr(0,c-4)+" ...":a.title).parent().css("display",""),""==a.location?$("#CalDavZAPPopup").find('[data-type="location"]').parent().css("display","none"):$("#CalDavZAPPopup").find('[data-type="location"]').text(a.location).parent().css("display",""),""==a.hrefUrl?$("#CalDavZAPPopup").find('[data-type="url"]').parent().css("display","none"):$("#CalDavZAPPopup").find('[data-type="url"]').text(a.hrefUrl).parent().css("display",""),""==a.note?$("#CalDavZAPPopup").find('[data-type="note"]').parent().css("display","none"):$("#CalDavZAPPopup").find('[data-type="note"]').text(a.note.length>c?a.note.substr(0,c-4)+" ...":a.note).parent().css("display",""),$("#CalDavZAPPopup").find('[data-type="from"]').html(t),$("#CalDavZAPPopup").find('[data-type="to"]').html(l),$("#CalDavZAPPopup").find('[data-type="status"]').text(o),$("#CalDavZAPPopup").find('[data-type="avail"]').text(n),$("#CalDavZAPPopup").find('[data-type="type"]').text(r),$("#CalDavZAPPopup").find('[data-type="priority"]').text(i),$("#CalDavZAPPopup").find('[data-type="calendar"]').text(s.displayvalue),$("#CalDavZAPPopup").css({opacity:0,display:"block",top:0,left:0}),$("#CalDavZAPPopupColor").css("height",0),$("#CalDavZAPPopup").css("top",Math.max(e.pageY-$("#CalDavZAPPopup").outerHeight()-10,30)),$("#CalDavZAPPopup").css("left",Math.max(Math.min(e.pageX,$(window).width()-$("#CalDavZAPPopup").outerWidth()-50)+20,30)),$("#CalDavZAPPopupColor").css({"background-color":s.ecolor,height:$("#CalDavZAPPopup").height()}),$("#CalDavZAPPopup").animate({opacity:1},100)}function moveEventPopup(e){$("#CalDavZAPPopup").css("top",Math.max(e.pageY-$("#CalDavZAPPopup").outerHeight()-10,30)),$("#CalDavZAPPopup").css("left",Math.max(Math.min(e.pageX,$(window).width()-$("#CalDavZAPPopup").outerWidth()-50)+20,30))}function hideEventPopup(){$("#CalDavZAPPopup").css("display","none")}Date.prototype.stdTimezoneOffset=function(){var e=new Date(this.getFullYear(),0,1),a=new Date(this.getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),a.getTimezoneOffset())},Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};