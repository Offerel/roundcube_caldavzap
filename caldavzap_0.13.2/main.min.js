var globalEventList=new EventList,globalAppleSupport=new AppleSupportNextDateArray,globalResourceCalDAVList=new ResourceCalDAVList,maxAlarmValue=2147e6,globalMultiWeekSize=3,globalMaxNextInstanesTodoCheckingNumber=60,globalEventIntervalID=null,globalResourceRefreshNumber=0,globalResourceRefreshNumberTodo=0,globalCalDAVInitLoad=!0,globalCalDAVResourceSync=!1,globalCalDAVCollectionSync=!1,globalCalendarNumber=0,globalOnlyCalendarNumber=0,globalTodoCalendarNumber=0,globalOnlyCalendarNumberCount=0,globalOnlyTodoCalendarNumberCount=0,globalCalendarNumberCount=0,globalEventTimeoutID=0,cleanResourceCalDAVListTemplate=null,cleanResourceCalDAVTODOListTemplate=null,cleanVcalendarTemplate=null,cleanVtodoTemplate=null,origResourceCalDAVListTemplate=null,origResourceCalDAVTODOListTemplate=null,origVcalendarTemplate=null,origVtodoTemplate=null,origVtodoLoaderTemplate=null,globalSessionTimeZone=null,globalCalDAVQs=null,globalCalDAVTODOQs=null,globalVisibleCalDAVCollections=new Array,globalVisibleCalDAVTODOCollections=new Array,isResourceComplete=!1,prevFunctionArray=new Array,prevFunctionArrayIterator=0,globalWorkerArray=new Array,globalIntervalArray=new Array,globalCurrentLoadingResource="",timeZonesEnabled=new Array,cLcouny=42,processedTimezones=Array(),timelist=new Array,minelems=[0,15,30,45],frequencies=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"],globalToday=new Date,isCalDAVLoaded=!1,isCalDAVAvaible=!0,globalLoadedLimit=new Date,globalToLoadedLimit=new Date,globalLimitLoading="",globalLimitTodoLoading="",globalBeginPast=new Date,globalBeginFuture=new Date,globalLoadedLimitTodo=new Date,globalToLoadedLimitTodo=new Date,globalDefaultCalendarCollectionActiveAll=!1,globalDefaultTodoCalendarCollectionActiveAll=!1,globalDefaultCalendarCollectionLoadAll=!1,globalDefaultTodoCalendarCollectionLoadAll=!1,globalTodoLoaderHide="",globalEventCollectionsLoading=!1,globalTodoCollectionsLoading=!1,globalCalEvent=null,globalCalTodo=null,globalJsEvent=null,globalRevertFunction=null,globalPrevDragEventAllDay=null,globalPrevDate="",globalAllowFcRerender=!0,globalCalWidth=0,globalTodoCheckTimeout=null,globalTodoCheckTimeoutDelay=1e3,globalTodolistStatusArray={},globalSettings={version:{value:void 0!==globalSettingsVersion&&null!=globalSettingsVersion?globalSettingsVersion:1,locked:!1},resourcealphabetsorting:{value:"undefined"==typeof globalResourceAlphabetSorting||null==globalResourceAlphabetSorting||globalResourceAlphabetSorting,locked:!1},usejqueryauth:{value:"undefined"!=typeof globalUseJqueryAuth&&null!=globalUseJqueryAuth&&globalUseJqueryAuth,locked:!1},settingstype:{value:"undefined"!=typeof globalSettingsType&&null!=globalSettingsType&&""!=globalSettingsType?globalSettingsType:"principal-URL",locked:!1},defaultactiveapp:{value:"undefined"!=typeof globalDefaultActiveApp&&null!=globalDefaultActiveApp&&""!=globalDefaultActiveApp?globalDefaultActiveApp:null,locked:!1},islastdefaultactiveapp:{value:!1,locked:!1},datepickerfirstdayofweek:{value:"undefined"!=typeof globalDatepickerFirstDayOfWeek&&null!=globalDatepickerFirstDayOfWeek?globalDatepickerFirstDayOfWeek:1,locked:!1},syncresourcesinterval:{value:"undefined"!=typeof globalSyncResourcesInterval&&null!=globalSyncResourcesInterval?globalSyncResourcesInterval:3e5,locked:!1},datepickerformat:{value:"undefined"!=typeof globalDatepickerFormat&&null!=globalDatepickerFormat&&""!=globalDatepickerFormat?globalDatepickerFormat:localization[globalInterfaceLanguage]._default_datepicker_format_,locked:!1},backgroundsync:{value:"undefined"==typeof globalBackgroundSync||null==globalBackgroundSync||globalBackgroundSync,locked:!1},enablekbnavigation:{value:"undefined"==typeof globalEnableKbNavigation||null==globalEnableKbNavigation||globalEnableKbNavigation,locked:!1},rewritetimezonecomponent:{value:"undefined"==typeof globalRewriteTimezoneComponent||null==globalRewriteTimezoneComponent||globalRewriteTimezoneComponent,locked:!1},removeunknowntimezone:{value:"undefined"!=typeof globalRemoveUnknownTimezone&&null!=globalRemoveUnknownTimezone&&globalRemoveUnknownTimezone,locked:!1},mozillasupport:{value:"undefined"!=typeof globalMozillaSupport&&null!=globalMozillaSupport&&globalMozillaSupport,locked:!1},appleremindersmode:{value:"undefined"!=typeof globalAppleRemindersMode&&null!=globalAppleRemindersMode&&globalAppleRemindersMode,locked:!1},titleformatmonth:{value:localization[globalInterfaceLanguage]._default_title_format_month_,locked:!1},titleformatweek:{value:localization[globalInterfaceLanguage]._default_title_format_week_,locked:!1},titleformatday:{value:localization[globalInterfaceLanguage]._default_title_format_day_,locked:!1},titleformattable:{value:localization[globalInterfaceLanguage]._default_title_format_table_,locked:!1},columnformatagenda:{value:localization[globalInterfaceLanguage]._default_column_format_agenda_,locked:!1},activecalendarcollections:{value:"undefined"!=typeof globalActiveCalendarCollections&&null!=globalActiveCalendarCollections?globalActiveCalendarCollections:new Array,locked:!1},activetodocollections:{value:"undefined"!=typeof globalActiveTodoCollections&&null!=globalActiveTodoCollections?globalActiveTodoCollections:new Array,locked:!1},loadedcalendarcollections:{value:"undefined"!=typeof globalLoadedCalendarCollections&&null!=globalLoadedCalendarCollections?globalLoadedCalendarCollections:new Array,locked:!1},loadedtodocollections:{value:"undefined"!=typeof globalLoadedTodoCollections&&null!=globalLoadedTodoCollections?globalLoadedTodoCollections:new Array,locked:!1},todolistfilterselected:{value:"undefined"!=typeof globalTodoListFilterSelected&&null!=globalTodoListFilterSelected&&""!=globalTodoListFilterSelected?globalTodoListFilterSelected:["filterAction","filterProgress"],locked:!1},activeview:{value:"undefined"!=typeof globalActiveView&&null!=globalActiveView&&""!=globalActiveView?globalActiveView:"multiWeek",locked:!1},islastactiveview:{value:!0,locked:!1},calendarselected:{value:"undefined"!=typeof globalCalendarSelected&&null!=globalCalendarSelected&&""!=globalCalendarSelected?globalCalendarSelected:"",locked:!1},todocalendarselected:{value:"undefined"!=typeof globalTodoCalendarSelected&&null!=globalTodoCalendarSelected&&""!=globalTodoCalendarSelected?globalTodoCalendarSelected:"",locked:!1},timezone:{value:"undefined"!=typeof globalTimeZone&&null!=globalTimeZone&&""!=globalTimeZone?globalTimeZone:"local",locked:!1},islasttimezone:{value:!0,locked:!1},openformmode:{value:"undefined"!=typeof globalOpenFormMode&&null!=globalOpenFormMode&&""!=globalOpenFormMode?globalOpenFormMode:"double",locked:!1},calendarstartofbusiness:{value:"undefined"!=typeof globalCalendarStartOfBusiness&&null!=globalCalendarStartOfBusiness?globalCalendarStartOfBusiness:8,locked:!1},calendarendofbusiness:{value:"undefined"!=typeof globalCalendarEndOfBusiness&&null!=globalCalendarEndOfBusiness?globalCalendarEndOfBusiness:17,locked:!1},defaulteventduration:{value:"undefined"!=typeof globalDefaultEventDuration&&null!=globalDefaultEventDuration&&globalDefaultEventDuration>=0?globalDefaultEventDuration:null,locked:!1},ampmformat:{value:"undefined"!=typeof globalAMPMFormat&&null!=globalAMPMFormat?globalAMPMFormat:localization[globalInterfaceLanguage]._default_AMPM_format_,locked:!1},timeformatagenda:{value:"undefined"!=typeof globalTimeFormatAgenda&&null!=globalTimeFormatAgenda&&""!=globalTimeFormatAgenda?globalTimeFormatAgenda:null,locked:!1},timeformatbasic:{value:"undefined"!=typeof globalTimeFormatBasic&&null!=globalTimeFormatBasic&&""!=globalTimeFormatBasic?globalTimeFormatBasic:null,locked:!1},displayhiddenevents:{value:"undefined"!=typeof globalDisplayHiddenEvents&&null!=globalDisplayHiddenEvents&&globalDisplayHiddenEvents,locked:!1},timezonesupport:{value:"undefined"==typeof globalTimeZoneSupport||null==globalTimeZoneSupport||globalTimeZoneSupport,locked:!1},timezonesenabled:{value:"undefined"!=typeof globalTimeZonesEnabled&&null!=globalTimeZonesEnabled&&""!=globalTimeZonesEnabled?globalTimeZonesEnabled:[],locked:!1},showhiddenalarms:{value:"undefined"!=typeof globalShowHiddenAlarms&&null!=globalShowHiddenAlarms&&globalShowHiddenAlarms,locked:!1},ignorecompletedorcancelledalarms:{value:"undefined"==typeof globalIgnoreCompletedOrCancelledAlarms||null==globalIgnoreCompletedOrCancelledAlarms||globalIgnoreCompletedOrCancelledAlarms,locked:!1},weekenddays:{value:"undefined"!=typeof globalWeekendDays&&null!=globalWeekendDays&&""!=globalWeekendDays?globalWeekendDays:[0,6],locked:!1},eventstartpastlimit:{value:"undefined"!=typeof globalEventStartPastLimit&&null!=globalEventStartPastLimit?globalEventStartPastLimit:3,locked:!1},todopastlimit:{value:"undefined"!=typeof globalTodoPastLimit&&null!=globalTodoPastLimit?globalTodoPastLimit:3,locked:!1},eventstartfuturelimit:{value:"undefined"!=typeof globalEventStartFutureLimit&&null!=globalEventStartFutureLimit?globalEventStartFutureLimit:3,locked:!1},compatibility:{value:"undefined"!=typeof globalCompatibility&&null!=globalCompatibility&&""!=globalCompatibility?globalCompatibility:{anniversaryOutputFormat:["apple"]},locked:!1},contactstorefn:{value:"undefined"!=typeof globalContactStoreFN&&null!=globalContactStoreFN&&""!=globalContactStoreFN?globalContactStoreFN:["prefix"," last"," middle"," first"," suffix"],locked:!1},urihandlertel:{value:"undefined"!=typeof globalUriHandlerTel&&null!=globalUriHandlerTel&&""!=globalUriHandlerTel?globalUriHandlerTel:"tel:",locked:!1},urihandleremail:{value:"undefined"!=typeof globalUriHandlerEmail&&null!=globalUriHandlerEmail&&""!=globalUriHandlerEmail?globalUriHandlerEmail:"mailto:",locked:!1},urihandlerurl:{value:"undefined"!=typeof globalUriHandlerUrl&&null!=globalUriHandlerUrl&&""!=globalUriHandlerUrl?globalUriHandlerUrl:"http://",locked:!1},urihandlerprofile:{value:"undefined"!=typeof globalUriHandlerProfile&&null!=globalUriHandlerProfile&&""!=globalUriHandlerProfile?globalUriHandlerProfile:{twitter:"http://twitter.com/%u",facebook:"http://www.facebook.com/%u",flickr:"http://www.flickr.com/photos/%u",linkedin:"http://www.linkedin.com/in/%u",myspace:"http://www.myspace.com/%u",sinaweibo:"http://weibo.com/n/%u"},locked:!1},addresscountryequivalence:{value:"undefined"!=typeof globalAddressCountryEquivalence&&null!=globalAddressCountryEquivalence&&""!=globalAddressCountryEquivalence?globalAddressCountryEquivalence:[{country:"de",regex:"^\\W*Deutschland\\W*$"},{country:"sk",regex:"^\\W*Slovensko\\W*$"}],locked:!1},addressbookselected:{value:"undefined"!=typeof globalAddressbookSelected&&null!=globalAddressbookSelected&&""!=globalAddressbookSelected?globalAddressbookSelected:"",locked:!1},collectiondisplay:{value:"undefined"!=typeof globalCollectionDisplay&&null!=globalCollectionDisplay&&""!=globalCollectionDisplay?globalCollectionDisplay:"undefined"!=typeof globalGroupContactsByCompanies&&globalGroupContactsByCompanies?[{label:"{Name}",value:{company:["{Company}"," [{Department}]"],personal:["{LastName}"," {MiddleName}"," {FirstName}"]}},{label:"{JobTitle}",value:["{JobTitle}"]},{label:"{Email}",value:["{Email[:0]}"]},{label:"{Phone} 1",value:["{Phone[:0]}"]},{label:"{Phone} 2",value:["{Phone[:1]}"]},{label:"{NoteText}",value:["{NoteText}"]}]:[{label:"{Name}",value:["{LastName}"," {MiddleName}"," {FirstName}"]},{label:"{Company} [{Department}]",value:["{Company}"," [{Department}]"]},{label:"{JobTitle}",value:["{JobTitle}"]},{label:"{Email}",value:["{Email[:0]}"]},{label:"{Phone} 1",value:["{Phone[:0]}"]},{label:"{Phone} 2",value:["{Phone[:1]}"]},{label:"{NoteText}",value:["{NoteText}"]}],locked:!1},collectionsort:{value:"undefined"!=typeof globalCollectionSort&&null!=globalCollectionSort&&""!=globalCollectionSort?globalCollectionSort:"",locked:!1},defaultaddresscountry:{value:"undefined"!=typeof globalDefaultAddressCountry&&null!=globalDefaultAddressCountry&&""!=globalDefaultAddressCountry?globalDefaultAddressCountry:"us",locked:!1},addresscountryfavorites:{value:"undefined"!=typeof globalAddressCountryFavorites&&null!=globalAddressCountryFavorites&&""!=globalAddressCountryFavorites?globalAddressCountryFavorites:[],locked:!1},activeaddressbookcollections:{value:"undefined"!=typeof globalActiveAddressbookCollections&&null!=globalActiveAddressbookCollections?globalActiveAddressbookCollections:new Array,locked:!1},loadedaddressbookcollections:{value:"undefined"!=typeof globalLoadedAddressbookCollections&&null!=globalLoadedAddressbookCollections?globalLoadedAddressbookCollections:new Array,locked:!1}};function resetSettings(){globalSettings={version:{value:void 0!==globalSettingsVersion&&null!=globalSettingsVersion?globalSettingsVersion:1,locked:!1},resourcealphabetsorting:{value:"undefined"==typeof globalResourceAlphabetSorting||null==globalResourceAlphabetSorting||globalResourceAlphabetSorting,locked:!1},usejqueryauth:{value:"undefined"!=typeof globalUseJqueryAuth&&null!=globalUseJqueryAuth&&globalUseJqueryAuth,locked:!1},settingstype:{value:"undefined"!=typeof globalSettingsType&&null!=globalSettingsType&&""!=globalSettingsType?globalSettingsType:"principal-URL",locked:!1},defaultactiveapp:{value:"undefined"!=typeof globalDefaultActiveApp&&null!=globalDefaultActiveApp&&""!=globalDefaultActiveApp?globalDefaultActiveApp:null,locked:!1},islastdefaultactiveapp:{value:!1,locked:!1},datepickerfirstdayofweek:{value:"undefined"!=typeof globalDatepickerFirstDayOfWeek&&null!=globalDatepickerFirstDayOfWeek?globalDatepickerFirstDayOfWeek:1,locked:!1},syncresourcesinterval:{value:"undefined"!=typeof globalSyncResourcesInterval&&null!=globalSyncResourcesInterval?globalSyncResourcesInterval:3e5,locked:!1},datepickerformat:{value:"undefined"!=typeof globalDatepickerFormat&&null!=globalDatepickerFormat&&""!=globalDatepickerFormat?globalDatepickerFormat:localization[globalInterfaceLanguage]._default_datepicker_format_,locked:!1},backgroundsync:{value:"undefined"==typeof globalBackgroundSync||null==globalBackgroundSync||globalBackgroundSync,locked:!1},enablekbnavigation:{value:"undefined"==typeof globalEnableKbNavigation||null==globalEnableKbNavigation||globalEnableKbNavigation,locked:!1},rewritetimezonecomponent:{value:"undefined"==typeof globalRewriteTimezoneComponent||null==globalRewriteTimezoneComponent||globalRewriteTimezoneComponent,locked:!1},removeunknowntimezone:{value:"undefined"!=typeof globalRemoveUnknownTimezone&&null!=globalRemoveUnknownTimezone&&globalRemoveUnknownTimezone,locked:!1},mozillasupport:{value:"undefined"!=typeof globalMozillaSupport&&null!=globalMozillaSupport&&globalMozillaSupport,locked:!1},appleremindersmode:{value:"undefined"!=typeof globalAppleRemindersMode&&null!=globalAppleRemindersMode&&globalAppleRemindersMode,locked:!1},titleformatmonth:{value:localization[globalInterfaceLanguage]._default_title_format_month_,locked:!1},titleformatweek:{value:localization[globalInterfaceLanguage]._default_title_format_week_,locked:!1},titleformatday:{value:localization[globalInterfaceLanguage]._default_title_format_day_,locked:!1},titleformattable:{value:localization[globalInterfaceLanguage]._default_title_format_table_,locked:!1},columnformatagenda:{value:localization[globalInterfaceLanguage]._default_column_format_agenda_,locked:!1},activecalendarcollections:{value:"undefined"!=typeof globalActiveCalendarCollections&&null!=globalActiveCalendarCollections?globalActiveCalendarCollections:new Array,locked:!1},activetodocollections:{value:"undefined"!=typeof globalActiveTodoCollections&&null!=globalActiveTodoCollections?globalActiveTodoCollections:new Array,locked:!1},loadedcalendarcollections:{value:"undefined"!=typeof globalLoadedCalendarCollections&&null!=globalLoadedCalendarCollections?globalLoadedCalendarCollections:new Array,locked:!1},loadedtodocollections:{value:"undefined"!=typeof globalLoadedTodoCollections&&null!=globalLoadedTodoCollections?globalLoadedTodoCollections:new Array,locked:!1},todolistfilterselected:{value:"undefined"!=typeof globalTodoListFilterSelected&&null!=globalTodoListFilterSelected&&""!=globalTodoListFilterSelected?globalTodoListFilterSelected:["filterAction","filterProgress"],locked:!1},activeview:{value:"undefined"!=typeof globalActiveView&&null!=globalActiveView&&""!=globalActiveView?globalActiveView:"multiWeek",locked:!1},islastactiveview:{value:!0,lockedlocked:!1},calendarselected:{value:"undefined"!=typeof globalCalendarSelected&&null!=globalCalendarSelected&&""!=globalCalendarSelected?globalCalendarSelected:"",locked:!1},todocalendarselected:{value:"undefined"!=typeof globalTodoCalendarSelected&&null!=globalTodoCalendarSelected&&""!=globalTodoCalendarSelected?globalTodoCalendarSelected:"",locked:!1},timezone:{value:"undefined"!=typeof globalTimeZone&&null!=globalTimeZone&&""!=globalTimeZone?globalTimeZone:"local",locked:!1},islasttimezone:{value:!0,locked:!1},openformmode:{value:"undefined"!=typeof globalOpenFormMode&&null!=globalOpenFormMode&&""!=globalOpenFormMode?globalOpenFormMode:"double",locked:!1},calendarstartofbusiness:{value:"undefined"!=typeof globalCalendarStartOfBusiness&&null!=globalCalendarStartOfBusiness?globalCalendarStartOfBusiness:8,locked:!1},calendarendofbusiness:{value:"undefined"!=typeof globalCalendarEndOfBusiness&&null!=globalCalendarEndOfBusiness?globalCalendarEndOfBusiness:17,locked:!1},defaulteventduration:{value:"undefined"!=typeof globalDefaultEventDuration&&null!=globalDefaultEventDuration&&globalDefaultEventDuration>=0?globalDefaultEventDuration:null,locked:!1},ampmformat:{value:"undefined"!=typeof globalAMPMFormat&&null!=globalAMPMFormat?globalAMPMFormat:localization[globalInterfaceLanguage]._default_AMPM_format_,locked:!1},timeformatagenda:{value:"undefined"!=typeof globalTimeFormatAgenda&&null!=globalTimeFormatAgenda&&""!=globalTimeFormatAgenda?globalTimeFormatAgenda:null,locked:!1},timeformatbasic:{value:"undefined"!=typeof globalTimeFormatBasic&&null!=globalTimeFormatBasic&&""!=globalTimeFormatBasic?globalTimeFormatBasic:null,locked:!1},displayhiddenevents:{value:"undefined"!=typeof globalDisplayHiddenEvents&&null!=globalDisplayHiddenEvents&&globalDisplayHiddenEvents,locked:!1},timezonesupport:{value:"undefined"==typeof globalTimeZoneSupport||null==globalTimeZoneSupport||globalTimeZoneSupport,locked:!1},timezonesenabled:{value:"undefined"!=typeof globalTimeZonesEnabled&&null!=globalTimeZonesEnabled&&""!=globalTimeZonesEnabled?globalTimeZonesEnabled:[],locked:!1},showhiddenalarms:{value:"undefined"!=typeof globalShowHiddenAlarms&&null!=globalShowHiddenAlarms&&globalShowHiddenAlarms,locked:!1},ignorecompletedorcancelledalarms:{value:"undefined"==typeof globalIgnoreCompletedOrCancelledAlarms||null==globalIgnoreCompletedOrCancelledAlarms||globalIgnoreCompletedOrCancelledAlarms,locked:!1},weekenddays:{value:"undefined"!=typeof globalWeekendDays&&null!=globalWeekendDays&&""!=globalWeekendDays?globalWeekendDays:[0,6],locked:!1},eventstartpastlimit:{value:"undefined"!=typeof globalEventStartPastLimit&&null!=globalEventStartPastLimit?globalEventStartPastLimit:3,locked:!1},todopastlimit:{value:"undefined"!=typeof globalTodoPastLimit&&null!=globalTodoPastLimit?globalTodoPastLimit:3,locked:!1},eventstartfuturelimit:{value:"undefined"!=typeof globalEventStartFutureLimit&&null!=globalEventStartFutureLimit?globalEventStartFutureLimit:3,locked:!1},compatibility:{value:"undefined"!=typeof globalCompatibility&&null!=globalCompatibility&&""!=globalCompatibility?globalCompatibility:{anniversaryOutputFormat:["apple"]},locked:!1},contactstorefn:{value:"undefined"!=typeof globalContactStoreFN&&null!=globalContactStoreFN&&""!=globalContactStoreFN?globalContactStoreFN:["prefix"," last"," middle"," first"," suffix"],locked:!1},urihandlertel:{value:"undefined"!=typeof globalUriHandlerTel&&null!=globalUriHandlerTel&&""!=globalUriHandlerTel?globalUriHandlerTel:"tel:",locked:!1},urihandleremail:{value:"undefined"!=typeof globalUriHandlerEmail&&null!=globalUriHandlerEmail&&""!=globalUriHandlerEmail?globalUriHandlerEmail:"mailto:",locked:!1},urihandlerurl:{value:"undefined"!=typeof globalUriHandlerUrl&&null!=globalUriHandlerUrl&&""!=globalUriHandlerUrl?globalUriHandlerUrl:"http://",locked:!1},urihandlerprofile:{value:"undefined"!=typeof globalUriHandlerProfile&&null!=globalUriHandlerProfile&&""!=globalUriHandlerProfile?globalUriHandlerProfile:{twitter:"http://twitter.com/%u",facebook:"http://www.facebook.com/%u",flickr:"http://www.flickr.com/photos/%u",linkedin:"http://www.linkedin.com/in/%u",myspace:"http://www.myspace.com/%u",sinaweibo:"http://weibo.com/n/%u"},locked:!1},addresscountryequivalence:{value:"undefined"!=typeof globalAddressCountryEquivalence&&null!=globalAddressCountryEquivalence&&""!=globalAddressCountryEquivalence?globalAddressCountryEquivalence:[{country:"de",regex:"^\\W*Deutschland\\W*$"},{country:"sk",regex:"^\\W*Slovensko\\W*$"}],locked:!1},addressbookselected:{value:"undefined"!=typeof globalAddressbookSelected&&null!=globalAddressbookSelected&&""!=globalAddressbookSelected?globalAddressbookSelected:"",locked:!1},collectiondisplay:{value:"undefined"!=typeof globalCollectionDisplay&&null!=globalCollectionDisplay&&""!=globalCollectionDisplay?globalCollectionDisplay:"undefined"!=typeof globalGroupContactsByCompanies&&globalGroupContactsByCompanies?[{label:"{Name}",value:{company:["{Company}"," [{Department}]"],personal:["{LastName}"," {MiddleName}"," {FirstName}"]}},{label:"{JobTitle}",value:["{JobTitle}"]},{label:"{Email}",value:["{Email[:0]}"]},{label:"{Phone} 1",value:["{Phone[:0]}"]},{label:"{Phone} 2",value:["{Phone[:1]}"]},{label:"{NoteText}",value:["{NoteText}"]}]:[{label:"{Name}",value:["{LastName}"," {MiddleName}"," {FirstName}"]},{label:"{Company} [{Department}]",value:["{Company}"," [{Department}]"]},{label:"{JobTitle}",value:["{JobTitle}"]},{label:"{Email}",value:["{Email[:0]}"]},{label:"{Phone} 1",value:["{Phone[:0]}"]},{label:"{Phone} 2",value:["{Phone[:1]}"]},{label:"{NoteText}",value:["{NoteText}"]}],locked:!1},collectionsort:{value:"undefined"!=typeof globalCollectionSort&&null!=globalCollectionSort&&""!=globalCollectionSort?globalCollectionSort:"",locked:!1},defaultaddresscountry:{value:"undefined"!=typeof globalDefaultAddressCountry&&null!=globalDefaultAddressCountry&&""!=globalDefaultAddressCountry?globalDefaultAddressCountry:"us",locked:!1},addresscountryfavorites:{value:"undefined"!=typeof globalAddressCountryFavorites&&null!=globalAddressCountryFavorites&&""!=globalAddressCountryFavorites?globalAddressCountryFavorites:[],locked:!1},activeaddressbookcollections:{value:"undefined"!=typeof globalActiveAddressbookCollections&&null!=globalActiveAddressbookCollections?globalActiveAddressbookCollections:new Array,locked:!1},loadedaddressbookcollections:{value:"undefined"!=typeof globalLoadedAddressbookCollections&&null!=globalLoadedAddressbookCollections?globalLoadedAddressbookCollections:new Array,locked:!1}}}function transformToServer(inSettings){var serverSettings={};for(var prop in inSettings)serverSettings[prop]=inSettings[prop].value;return serverSettings}var globalWindowFocus=!0,globalLoginUsername="",globalLoginPassword="",isUserLogged=!1,isDelegationLoaded=!1,globalActiveApp="",globalAvailableAppsArray=new Array,globalEnableAppSwitch=!0,globalAppName="CalDavZAP",globalVersion="0.13.2rc1",globalBuildNo=1448196592,globalXMLCache=null,globalVersionCheckURL=("file:"==location.protocol?"http:":location.protocol)+"//www.inf-it.com/versioncheck/"+globalAppName+"/?v="+globalVersion,globalXClientHeader=globalAppName+" "+globalVersion+" (Inf-IT CalDAV Web Client)",globalResourceNumberCount=0,globalResourceNumber=0,globalResourceIntervalID=null,globalFirstLoadNextApp=!1,globalObjectLoading=!1,settingsLoaded=!1,globalKBNavigationPaddingRate=.2,globalParallelAjaxCallCardDAVEnabled=!0,globalParallelAjaxCallCalDAVEnabled=!0,globalCacheUpdateInterval=null,isIntegrated=!1,SVG_select='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:a="http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/" x="0px" y="0px" width="19px" height="19px" viewBox="0 0 19 19" overflow="visible" enable-background="new 0 0 19 19" xml:space="preserve"><defs></defs><rect x="2" fill="#585858" width="17" height="19"/><polygon fill="#FFFFFF" points="14,7 10.5,13 7,7 "/><rect fill="#FFFFFF" width="2" height="19"/></svg>',SVG_select_b='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:a="http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/" x="0px" y="0px" width="19px" height="19px" viewBox="0 0 19 19" overflow="visible" enable-background="new 0 0 19 19" xml:space="preserve"><defs></defs><rect x="2" fill="#585858" width="17" height="19"/><polygon fill="#FFFFFF" points="14,7 10.5,13 7,7 "/><rect fill="#F0F0F0" width="2" height="19"/></svg>',SVG_select_login='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:a="http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/" x="0px" y="0px" width="19px" height="28px" viewBox="0 0 19 28" overflow="visible" enable-background="new 0 0 19 28" xml:space="preserve"><defs></defs><rect fill="#FFFFFF" width="19" height="28"/></svg>',SVG_select_dis='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:a="http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/" x="0px" y="0px" width="22px" height="19px" viewBox="0 0 22 19" overflow="visible" enable-background="new 0 0 22 19" xml:space="preserve"><defs></defs><rect fill="#FFFFFF" width="22" height="19"/></svg>',globalDefinedSettings=new Array,globalLoadedPrincipals=new Array,globalEnableAllResourceSync=!0;if("undefined"==typeof isSettingsAvaible)var globalPreviousSupportedSettings=["activecalendarcollections","activetodocollections","activeaddressbookcollections","todolistfilterselected","activeview","defaultactiveapp","calendarselected","todocalendarselected","addressbookselected","timezone","loadedtodocollections","loadedcalendarcollections","loadedaddressbookcollections","version"];var globalSettingsSaving="",globalFirstHideLoader=!0,globalLoadedCollectionsNumber=0,globalLoadedCollectionsCount=0,ignoreServerSettings=!1,globalPreventLogoutSync=!1,globalEmailAddress="",globalSettingsVersion=3,globalSyncSettingsSave=!1,globalTmpTimePickerHackTime=new Object;function isAvaible(app){return-1!=globalAvailableAppsArray.indexOf(app)}function loadAllResources(){null==globalResourceIntervalID&&netFindResource(globalAccountSettings[0],0,!0,0)}function getAccount(accountUID){for(var tmp=accountUID.match(RegExp("^(https?://)([^@/]+(?:@[^@/]+)?)@([^/]+)(.*/)","i")),resource_href=tmp[1]+tmp[3]+tmp[4],resource_user=tmp[2],i=0;i<globalAccountSettings.length;i++)globalAccountSettings[i].href==resource_href&&globalAccountSettings[i].userAuth.userName==resource_user&&(resourceSettings=globalAccountSettings[i]);return resourceSettings}function checkForUnloadedResources(){for(var rex=new RegExp("^(https?://)([^@/]+(?:@[^@/]+)?)@([^/]+)(.*/)","i"),i=globalLoadedPrincipals.length-1;i>=0;i--){var resourceCounter=0;if(isAvaible("CardDavMATE"))for(var j=0;j<globalResourceCardDAVList.collections.length;j++)if(null!=globalResourceCardDAVList.collections[j].uid&&globalResourceCardDAVList.collections[j].makeLoaded){var tmp,resourceCalDAV_href=(tmp=globalResourceCardDAVList.collections[j].accountUID.match(rex))[1]+tmp[3]+tmp[4];globalLoadedPrincipals[i]==resourceCalDAV_href&&resourceCounter++}if(isAvaible("CalDavZAP")){for(var j=0;j<globalResourceCalDAVList.collections.length;j++)if(null!=globalResourceCalDAVList.collections[j].uid&&globalResourceCalDAVList.collections[j].makeLoaded){var tmp,resourceCalDAV_href=(tmp=globalResourceCalDAVList.collections[j].accountUID.match(rex))[1]+tmp[3]+tmp[4];globalLoadedPrincipals[i]==resourceCalDAV_href&&resourceCounter++}for(var j=0;j<globalResourceCalDAVList.TodoCollections.length;j++)if(null!=globalResourceCalDAVList.TodoCollections[j].uid&&globalResourceCalDAVList.TodoCollections[j].makeLoaded){var tmp,resourceCalDAV_href=(tmp=globalResourceCalDAVList.TodoCollections[j].accountUID.match(rex))[1]+tmp[3]+tmp[4];globalLoadedPrincipals[i]==resourceCalDAV_href&&resourceCounter++}}0==resourceCounter&&globalLoadedPrincipals.splice(i,1)}}function reloadResources(dontSaveSettings,loadArray){if(isAvaible("CardDavMATE")&&(globalCardDAVInitLoad||globalCardDAVResourceSync)||isAvaible("CalDavZAP")&&(globalCalDAVInitLoad||globalCalDAVResourceSync)||isAvaible("Projects")&&!isProjectsLoaded||isAvaible("Settings")&&(!isSettingsLoaded||""!=globalSettingsSaving&&!dontSaveSettings)||isAvaible("CalDavZAP")&&(""!=globalLimitLoading||""!=globalLimitTodoLoading))return!1;if(0==globalWindowFocus)return!1;if(globalCardDAVResourceSync=!0,globalCalDAVResourceSync=!0,isAvaible("CalDavZAP")){globalCalDAVResourceSync=!0,globalToday.setHours(0),globalToday.setMinutes(0),globalToday.setSeconds(0),globalToday.setMilliseconds(0);var currentToday=new Date;currentToday.setHours(0),currentToday.setMinutes(0),currentToday.setSeconds(0),currentToday.setMilliseconds(0),currentToday.getTime()!=globalToday.getTime()&&(isAvaible("CalDavZAP")&&$(".date").datepicker("refresh"),isAvaible("CardDavMATE")&&$("#vCardEditor").find('input[data-type^="date_"]').datepicker("refresh"),isAvaible("Projects")&&$(".project_date").datepicker("refresh"),$("#calendar").fullCalendar("updateToday"),$("#calendar").fullCalendar("gotoDate",currentToday),$("#todoList").fullCalendar("gotoDate",currentToday),currentToday.getTime()>globalToday.getTime()?(getNextMonths($("#calendar").fullCalendar("getView").end),getNextMonthsTodo()):(getPrevMonths($("#calendar").fullCalendar("getView").start),getPrevMonthsTodo()),globalToday=currentToday)}checkForUnloadedResources(),globalEnableAllResourceSync||void 0!==loadArray&&null!=loadArray?netFindResource(globalAccountSettings[0],0,!1,0,loadArray):netFindResource(globalAccountSettings[0],0,!1,0,globalLoadedPrincipals)}function ifLoadCollections(){if(isAvaible("CardDavMATE")&&(globalCardDAVInitLoad||globalCardDAVResourceSync)||isAvaible("CalDavZAP")&&(globalCalDAVInitLoad||globalCalDAVResourceSync))return!1;var changeCounter=0;if(isAvaible("CardDavMATE"))for(var i=0;i<globalResourceCardDAVList.collections.length;i++)null!=globalResourceCardDAVList.collections[i].uid&&globalResourceCardDAVList.collections[i].someChanged&&changeCounter++;if(isAvaible("CalDavZAP")){for(var i=0;i<globalResourceCalDAVList.collections.length;i++)null!=globalResourceCalDAVList.collections[i].uid&&globalResourceCalDAVList.collections[i].someChanged&&changeCounter++;for(var i=0;i<globalResourceCalDAVList.TodoCollections.length;i++)null!=globalResourceCalDAVList.TodoCollections[i].uid&&globalResourceCalDAVList.TodoCollections[i].someChanged&&changeCounter++}(changeCounter>0||""!=globalSettingsSaving)&&loadNextApplication(!1)}function bindColorPickerClick(newElement){newElement.click((function(event){var collectionType=null,resourceSelectedClass=null,resourceItems=null;if(newElement.parent().hasClass("resourceCalDAV_item")){if(globalEventCollectionsLoading)return!1;collectionType="event",resourceSelectedClass="resourceCalDAV_item_selected",resourceItems=newElement.parent().siblings(".resourceCalDAV_item_selected")}else if(newElement.parent().hasClass("resourceCalDAVTODO_item")){if(globalTodoCollectionsLoading)return!1;collectionType="todo",resourceSelectedClass="resourceCalDAV_item_selected",resourceItems=newElement.parent().siblings(".resourceCalDAV_item_selected")}else if(newElement.hasClass("resourceCardDAVColor")){if(globalAddressbookCollectionsLoading)return!1;collectionType="addressbook",resourceSelectedClass="resourceCardDAV_selected",resourceItems=newElement.parent().parent().siblings().find(".resourceCardDAV_selected")}var showInput=event.shiftKey,colorpicker=$(this).siblings(".colorPicker");$(this).hasClass("hasColorpicker")?showInput!=colorpicker.spectrum("option","showInput")&&colorpicker.spectrum("option","showInput",showInput):($(this).addClass("hasColorpicker"),colorpicker.spectrum({chooseText:localization[globalInterfaceLanguage].buttonSave,cancelText:localization[globalInterfaceLanguage].buttonCancel,color:newElement.css("background-color"),showInput:showInput,preferredFormat:"hex6",move:function(color){newElement.css("background",color)},hide:function(color){newElement.css("background-color")!=colorpicker.spectrum("get").toRgbString()&&newElement.css("background",colorpicker.spectrum("get").toRgbString())},change:function(color){if(newElement.css("background",color),"event"==collectionType){var coll=globalResourceCalDAVList.getEventCollectionByUID($(this).parent().attr("data-id"));netSaveProperty(coll,"undefined"!=typeof globalCalendarColorPropertyXmlns&&null!=globalCalendarColorPropertyXmlns&&""!=globalCalendarColorPropertyXmlns?globalCalendarColorPropertyXmlns:"http://apple.com/ns/ical/","calendar-color",color.toHexString())}else if("todo"==collectionType){var coll=globalResourceCalDAVList.getTodoCollectionByUID($(this).parent().attr("data-id"));netSaveProperty(coll,"undefined"!=typeof globalCalendarColorPropertyXmlns&&null!=globalCalendarColorPropertyXmlns&&""!=globalCalendarColorPropertyXmlns?globalCalendarColorPropertyXmlns:"http://apple.com/ns/ical/","calendar-color",color.toHexString())}else if("addressbook"==collectionType){var coll=globalResourceCardDAVList.getCollectionByUID($(this).parent().attr("data-id"));netSaveProperty(coll,"undefined"!=typeof globalAddrColorPropertyXmlns&&null!=globalAddrColorPropertyXmlns&&""!=globalAddrColorPropertyXmlns?globalAddrColorPropertyXmlns:"http://inf-it.com/ns/ab/","addressbook-color",color.toHexString())}}}));var container=colorpicker.spectrum("container");if(container.is(":visible"))colorpicker.spectrum("hide");else{var offset=$(this).offset();colorpicker.spectrum("show"),event.pageY<$(window).height()/2?(offset.top+=$(this).outerHeight(),container.removeClass("sp-inverse")):(offset.top-=container.outerHeight(),container.addClass("sp-inverse")),container.offset(offset)}return resourceItems.removeClass(resourceSelectedClass),newElement.parent().addClass(resourceSelectedClass),!1}))}function loadNextApplication(forceLoad){globalFirstLoadNextApp||(isAvaible("CardDavMATE")&&setAddressbookNumber(),isAvaible("CalDavZAP")&&setCalendarNumber(!0),globalFirstLoadNextApp=!0),isAvaible("CardDavMATE")&&!globalCardDAVCollectionSync&&globalResourceCardDAVList.collections.length>0?(globalCardDAVCollectionSync=!0,CardDAVnetLoadCollection(globalResourceCardDAVList.collections[0],forceLoad,!1,null,0,globalResourceCardDAVList.collections,!0)):isAvaible("CalDavZAP")&&!globalCalDAVCollectionSync&&globalResourceCalDAVList.collections.length>0?(globalCalDAVCollectionSync=!0,CalDAVnetLoadCollection(globalResourceCalDAVList.collections[0],forceLoad,!0,0,globalResourceCalDAVList.collections)):!isAvaible("Projects")||globalProjectSync||isProjectsLoaded||null==getLoggedUser()?!isAvaible("Reports")||globalReportsSync||isReportsLoaded||null==getLoggedUser()?!isAvaible("Settings")||globalSettingsSync||isSettingsLoaded||null==getLoggedUser()?((isAvaible("CalDavZAP")&&!isCalDAVLoaded||isAvaible("CardDavMATE")&&!isCardDAVLoaded)&&$("#MainLoader").fadeOut(1200,(function(){$("#MainLoader").css("left","50px")})),isAvaible("CardDavMATE")&&(globalCardDAVCollectionSync=!1,isCardDAVLoaded||(isCardDAVLoaded=!0)),isAvaible("CalDavZAP")&&(globalCalDAVCollectionSync=!1,isCalDAVLoaded||(isCalDAVLoaded=!0)),isAvaible("Projects")&&(globalProjectSync=!1,isProjectsLoaded=!0),isAvaible("Reports")&&(globalReportsSync=!1,isReportsLoaded=!0),isAvaible("Settings")&&(globalSettingsSync=!1,isSettingsLoaded=!0)):(globalSettingsSync=!0,isSettingsLoaded||loadNextApplication(!1),$("#ResourceSettingsList").children(".resourceSettings_item").length&&$("#ResourceSettingsList").children().eq(0).trigger("click")):($("#MainLoaderInner").html("Loading Reports"),globalReportsSync=!0,"undefined"!=typeof globalCRMSettings?netLoadReportList(globalCRMSettings):(console.log("Error: globalCRMSettings is not defined"),loadNextApplication(!1))):($("#MainLoaderInner").html("Loading projects"),globalProjectSync=!0,"undefined"!=typeof globalCRMSettings?netLoadXSLT(globalCRMSettings.XSLTHref):(console.log("Error: globalCRMSettings is not defined"),loadNextApplication(!1)))}function checkForApplication(inputApp){if(!globalEnableAppSwitch||globalObjectLoading)return!1;globalEnableAppSwitch=!1,globalActiveApp=inputApp;var inputID="System"+inputApp;$(".System").not("#"+inputID).each((function(){$(this).animate({opacity:0},666,(function(){$(this).css("visibility","hidden")}))})),$("#"+inputID).css("visibility","visible").animate({opacity:1},666,(function(){globalEnableAppSwitch=!0}))}function getLoggedUser(){for(var i=0;i<globalAccountSettings.length;i++)if(-1!=globalAccountSettings[i].href.indexOf(globalLoginUsername))return globalAccountSettings[i];return globalAccountSettings[0]}function login(){$("#LoginLoader").fadeTo(1200,1,(function(){globalLoginUsername=$("#LoginPage").find('[data-type="system_username"]').val(),globalLoginPassword=$("#LoginPage").find('[data-type="system_password"]').val(),loadConfig()}))}function logout(forceLogout){if((void 0===forceLogout||null==forceLogout)&&(isAvaible("CardDavMATE")&&(!isCardDAVLoaded||globalCardDAVResourceSync)||isAvaible("CalDavZAP")&&(!isCalDAVLoaded||globalCalDAVResourceSync)||isAvaible("Projects")&&!isProjectsLoaded||isAvaible("Settings")&&(!isSettingsLoaded||""!=globalSettingsSaving&&!dontSaveSettings)||isAvaible("CalDavZAP")&&(""!=globalLimitLoading||""!=globalLimitTodoLoading)))return globalPreventLogoutSync=!0,!1;clearInterval(globalResourceIntervalID),globalFirstLoadNextApp&&(globalFirstLoadNextApp=!1),settingsLoaded=!1,ignoreServerSettings=!1,checkBeforeClose(!1),globalResourceIntervalID=null,globalLoginUsername="",globalLoginPassword="",globalXMLCache=null,globalResourceNumber=0,globalResourceNumberCount=0,globalLoadedPrincipals=new Array,globalEmailAddress="",globalPreventLogoutSync=!1,globalSyncSettingsSave=!1,$(document.documentElement).unbind();var tmpMatch=document.title.match("^(.*) \\[.*\\]$");null!=tmpMatch&&(document.title=tmpMatch[1]),$("#LoginPage").fadeTo(2e3,1,(function(){void 0!==isCalDAVLoaded&&isCalDAVLoaded&&(logoutCalDAV(),isCalDAVLoaded=!1),"undefined"!=typeof isCardDAVLoaded&&isCardDAVLoaded&&(logoutCardDAV(),isCardDAVLoaded=!1),"undefined"!=typeof isProjectsLoaded&&isProjectsLoaded&&(logoutProjects(),isProjectsLoaded=!1),"undefined"!=typeof isReportsLoaded&&isReportsLoaded&&(logoutReports(),isReportsLoaded=!1),"undefined"!=typeof isSettingsLoaded&&isSettingsLoaded&&(logoutSettings(),isSettingsLoaded=!1);for(var i=globalAccountSettings.length-1;i>=0;i--)"network"==globalAccountSettings[i].type&&globalAccountSettings.splice(i,1);"undefined"==typeof globalDemoMode&&($('[data-type="system_username"]').val("").change(),$('[data-type="system_password"]').val("").change()),$(".integration_d").hide(),isUserLogged=!1,null==globalSettings.defaultactiveapp.value?isAvaible("CalDavZAP")?globalActiveApp="CalDavZAP":isAvaible("CardDavMATE")&&(globalActiveApp="CardDavMATE"):globalActiveApp=globalSettings.defaultactiveapp.value,resetSettings(),isAvaible("CardDavMATE")&&mainCardDAV(),isAvaible("CalDavZAP")&&mainCalDAV(),isAvaible("Settings")&&mainSettings(),isAvaible("Projects")&&mainProjects(),isAvaible("Reports")&&mainReports(),init()}))}function init(){($.browser.msie&&parseInt($.browser.version,10)<9||$.browser.opera)&&$("#login_message").css("display","").text(localization[globalInterfaceLanguage].unsupportedBrowser),"undefined"!=typeof globalDemoMode&&(null!=typeof globalDemoMode.userName&&$('[data-type="system_username"]').val(globalDemoMode.userName).change(),null!=typeof globalDemoMode.userPassword&&$('[data-type="system_password"]').val(globalDemoMode.userPassword).change()),loadConfig()}function run(){if(isUserLogged=!0,window.onfocus=function(){globalWindowFocus=!0},window.onblur=function(){0==globalSettings.backgroundsync.value&&(globalWindowFocus=!1)},$("#LoginPage").fadeOut(2e3),"undefined"==typeof globalAccountSettings)return console.log("Error: 'no account configured': see config.js!"),!1;"undefined"!=typeof globalNewVersionNotifyUsers&&null==globalNewVersionNotifyUsers||netVersionCheck(),document.title+=" ["+globalAccountSettings[0].userAuth.userName+"]";for(var detectedHref=location.protocol+"//"+location.hostname+(location.port?":"+location.port:""),i=0;i<globalAccountSettings.length;i++)null!=globalAccountSettings[i].crossDomain&&"boolean"==typeof globalAccountSettings[i].crossDomain||(0==globalAccountSettings[i].href.indexOf(detectedHref)?globalAccountSettings[i].crossDomain=!1:globalAccountSettings[i].crossDomain=!0,console.log("Info: [userAccount: '"+globalAccountSettings[i].href.replace("//","//"+globalAccountSettings[i].userAuth.userName+"@")+"']: crossDomain set to: '"+(1==globalAccountSettings[i].crossDomain?"true":"false")+"'"));void 0!==globalAvailableAppsArray&&null!=globalAvailableAppsArray&&globalAvailableAppsArray.length>1&&($(".integration_d").css("display","block"),-1!=globalAvailableAppsArray.indexOf("CalDavZAP")&&$("#intCaldav").attr("title",localization[globalInterfaceLanguage].txtCalendars).css("display","block").find(".int_error").attr("alt",localization[globalInterfaceLanguage].txtError),-1!=globalAvailableAppsArray.indexOf("CalDavTODO")&&$("#intCaldavTodo").attr("title",localization[globalInterfaceLanguage].txtTodos).css("display","block").find(".int_error").attr("alt",localization[globalInterfaceLanguage].txtError),-1!=globalAvailableAppsArray.indexOf("CardDavMATE")&&$("#intCarddav").attr("title",localization[globalInterfaceLanguage].txtContacts).css("display","block").find(".int_error").attr("alt",localization[globalInterfaceLanguage].txtError),-1!=globalAvailableAppsArray.indexOf("Projects")&&$("#intProjects").attr("title",localization[globalInterfaceLanguage].txtProjects).css("display","block").find(".int_error").attr("alt",localization[globalInterfaceLanguage].txtError),-1!=globalAvailableAppsArray.indexOf("Reports")&&$("#intReports").attr("title",localization[globalInterfaceLanguage].txtReports).css("display","block").find(".int_error").attr("alt",localization[globalInterfaceLanguage].txtError),-1!=globalAvailableAppsArray.indexOf("Settings")&&$("#intSettings").attr("title",localization[globalInterfaceLanguage].txtSettings).css("display","block").find(".int_error").attr("alt",localization[globalInterfaceLanguage].txtError),"boolean"!=typeof globalEnableRefresh||!globalEnableRefresh||-1==globalAvailableAppsArray.indexOf("CalDavZAP")&&-1==globalAvailableAppsArray.indexOf("CalDavTODO")&&-1==globalAvailableAppsArray.indexOf("CardDavMATE")||($("#intRefresh").attr("title",localization[globalInterfaceLanguage].txtRefresh).find(".int_error").attr("alt",localization[globalInterfaceLanguage].txtError),$("#intRefresh").prev().addBack().css("display","block"))),$("#cacheDialogText").text(localization[globalInterfaceLanguage].txtCacheText),$("#cacheDialogButton").attr("value",localization[globalInterfaceLanguage].txtCacheButton)}function loadConfig(){if(isUserLogged)return!1;var configLoaded=!0,detectedHref=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");if("undefined"!=typeof globalNetworkCheckSettings&&null!=globalNetworkCheckSettings)return""==globalLoginUsername||""==globalLoginPassword?($("#LoginPage").fadeTo(500,1,(function(){"undefined"==typeof globalDemoMode&&$('[data-type="system_username"]').focus()})),$("#LoginLoader").fadeOut(1200),!1):(null!=globalNetworkCheckSettings.crossDomain&&"boolean"==typeof globalNetworkCheckSettings.crossDomain||(0==globalNetworkCheckSettings.href.indexOf(detectedHref)?globalNetworkCheckSettings.crossDomain=!1:globalNetworkCheckSettings.crossDomain=!0,console.log("Info: [globalNetworkCheckSettings: '"+globalNetworkCheckSettings.href+"']: crossDomain set to: '"+(1==globalNetworkCheckSettings.crossDomain?"true":"false")+"'")),void 0!==globalAvailableAppsArray&&null!=globalAvailableAppsArray&&globalAvailableAppsArray.length>1?($("#intLogout").prev().addBack().css("display","block"),$("#intLogout").attr("title",localization[globalInterfaceLanguage].altLogout)):$("#Logout").css("display","block"),netCheckAndCreateConfiguration(globalNetworkCheckSettings),!0);if("undefined"!=typeof globalNetworkAccountSettings&&null!=globalNetworkAccountSettings)return""==globalLoginUsername||""==globalLoginPassword?($("#LoginPage").fadeTo(500,1,(function(){"undefined"==typeof globalDemoMode&&$('[data-type="system_username"]').focus()})),$("#LoginLoader").fadeOut(1200),!1):(null!=globalNetworkAccountSettings.crossDomain&&"boolean"==typeof globalNetworkAccountSettings.crossDomain||(0==globalNetworkAccountSettings.href.indexOf(detectedHref)?globalNetworkAccountSettings.crossDomain=!1:globalNetworkAccountSettings.crossDomain=!0,console.log("Info: [globalNetworkAccountSettings: '"+globalNetworkAccountSettings.href+"']: crossDomain set to: '"+(1==globalNetworkAccountSettings.crossDomain?"true":"false")+"'")),void 0!==globalAvailableAppsArray&&null!=globalAvailableAppsArray&&globalAvailableAppsArray.length>1?($("#intLogout").prev().addBack().css("display","block"),$("#intLogout").attr("title",localization[globalInterfaceLanguage].altLogout)):$("#Logout").css("display","block"),netLoadConfiguration(globalNetworkAccountSettings),!0);if(("undefined"==typeof globalNetworkAccountSettings||null==globalNetworkAccountSettings)&&("undefined"==typeof globalNetworkCheckSettings||null==globalNetworkCheckSettings)&&"undefined"!=typeof globalAccountSettings&&null!=globalAccountSettings&&globalAccountSettings.length>0){var delegCount=0,delegIndex=0;if(!isDelegationLoaded){for(var i=0;i<globalAccountSettings.length;i++)("boolean"==typeof globalAccountSettings[i].delegation&&globalAccountSettings[i].delegation||globalAccountSettings[i].delegation instanceof Array&&globalAccountSettings[i].delegation.length>0)&&(delegIndex=i);for(var i=0;i<globalAccountSettings.length;i++)("boolean"==typeof globalAccountSettings[i].delegation&&globalAccountSettings[i].delegation||globalAccountSettings[i].delegation instanceof Array&&globalAccountSettings[i].delegation.length>0)&&(delegCount++,DAVresourceDelegation(globalAccountSettings[i],i,delegIndex));delegCount>0&&(isDelegationLoaded=!0)}0!=delegCount||isDelegationLoaded||(isAvaible("CardDavMATE")&&runCardDAV(),isAvaible("CalDavZAP")&&runCalDAV(),isAvaible("Projects")&&runProjects(),isAvaible("Settings")&&runSettings(),globalResourceNumber=globalAccountSettings.length,loadAllResources())}}function globalMain(){for(var prop in globalSettings)globalDefinedSettings.push(prop);if("undefined"==typeof globalEnabledApps||null==globalEnabledApps?(void 0!==isCalDAVAvaible&&null!=isCalDAVAvaible&&isCalDAVAvaible&&(globalAvailableAppsArray[globalAvailableAppsArray.length]="CalDavZAP",globalAvailableAppsArray[globalAvailableAppsArray.length]="CalDavTODO"),"undefined"!=typeof isCardDAVAvaible&&null!=isCardDAVAvaible&&isCardDAVAvaible&&(globalAvailableAppsArray[globalAvailableAppsArray.length]="CardDavMATE"),"undefined"!=typeof isSettingsAvaible&&null!=isSettingsAvaible&&isSettingsAvaible&&(globalAvailableAppsArray[globalAvailableAppsArray.length]="Settings"),"undefined"!=typeof isProjectsAvaible&&null!=isProjectsAvaible&&isProjectsAvaible&&(globalAvailableAppsArray[globalAvailableAppsArray.length]="Projects"),"undefined"!=typeof isReportsAvaible&&null!=isReportsAvaible&&isReportsAvaible&&(globalAvailableAppsArray[globalAvailableAppsArray.length]="Reports")):(void 0===isCalDAVAvaible||null==isCalDAVAvaible||!isCalDAVAvaible||-1==globalEnabledApps.indexOf("CalDavZAP")&&-1==globalEnabledApps.indexOf("CalDavTODO")||(globalAvailableAppsArray[globalAvailableAppsArray.length]="CalDavZAP",globalAvailableAppsArray[globalAvailableAppsArray.length]="CalDavTODO"),"undefined"!=typeof isCardDAVAvaible&&null!=isCardDAVAvaible&&isCardDAVAvaible&&-1!=globalEnabledApps.indexOf("CardDavMATE")&&(globalAvailableAppsArray[globalAvailableAppsArray.length]="CardDavMATE"),"undefined"!=typeof isSettingsAvaible&&null!=isSettingsAvaible&&isSettingsAvaible&&-1!=globalEnabledApps.indexOf("Settings")&&(globalAvailableAppsArray[globalAvailableAppsArray.length]="Settings"),"undefined"!=typeof isProjectsAvaible&&null!=isProjectsAvaible&&isProjectsAvaible&&-1!=globalEnabledApps.indexOf("Projects")&&(globalAvailableAppsArray[globalAvailableAppsArray.length]="Projects"),"undefined"!=typeof isReportsAvaible&&null!=isReportsAvaible&&isReportsAvaible&&(globalAvailableAppsArray[globalAvailableAppsArray.length]="Reports")),globalAvailableAppsArray.length>1&&(isIntegrated=!0),null==globalSettings.defaultactiveapp.value?isAvaible("CardDavMATE")?globalActiveApp="CardDavMATE":isAvaible("CalDavZAP")&&(globalActiveApp="CalDavZAP"):globalActiveApp=globalSettings.defaultactiveapp.value,isAvaible("CardDavMATE")){if("undefined"!=typeof globalDisabledContactAttributes&&globalDisabledContactAttributes instanceof Array)for(var i=0;i<globalDisabledContactAttributes.length;i++)$("#vCardTemplate").find('[data-attr-name="'+jqueryEscapeSelector(globalDisabledContactAttributes[i])+'"]').remove();"function"==typeof globalContactsExtInitMain&&globalContactsExtInitMain($("#vCardTemplate"))}if($.browser.webkit&&window.chrome)0==navigator.platform.toLowerCase().indexOf("win")?($("#LoginPage, #vCardTemplate, #event_details_template, #todo_details_template, #EditorBoxSettings").find("input").css("text-indent","2px"),$("#LoginPage, #vCardTemplate, #event_details_template, #todo_details_template, #EditorBoxSettings").find("select").css({"padding-left":"0px","padding-right":"13px"})):$("#LoginPage, #vCardTemplate, #event_details_template, #todo_details_template, #EditorBoxSettings").find("input").css("text-indent","1px");else if($.browser.safari)$("#LoginPage, #vCardTemplate, #event_details_template, #todo_details_template, #EditorBoxSettings").find("textarea").addClass("safari_hack"),$("#LoginPage, #vCardTemplate, #event_details_template, #todo_details_template, #EditorBoxSettings").find("input").addClass("safari_hack");else if($.browser.msie){10==parseInt($.browser.version,10)&&($("select").css({"padding-top":"1px","padding-left":"0px","padding-right":"0px"}),$("textarea").css("padding-top","3px"),$("input[type=button]").css("padding-top","2px"));var newSVG=$(SVG_select_login).attr("data-type","select_icon").css({"pointer-events":"none","z-index":"1",display:"inline","margin-left":"-19px","vertical-align":"top","background-color":"#ffffff"});$("#Login").find('select[data-type="language"]').after($($("<div>").append($(newSVG).clone()).html()))}else if($.browser.mozilla){var newSVG=$(SVG_select_login).attr("data-type","select_icon").css({"pointer-events":"none","z-index":"1",display:"inline","margin-left":"-19px","vertical-align":"top","background-color":"#ffffff"});$("#Login").find('select[data-type="language"]').after($($("<div>").append($(newSVG).clone()).html()))}var lang_num=0,language_option=$("#Login").find('[data-type="language"]').find("option");if($("#Login").find('[data-type="language"]').html(""),"undefined"!=typeof globalInterfaceCustomLanguages&&null!=globalInterfaceCustomLanguages.length&&globalInterfaceCustomLanguages.length>0)for(var i=0;i<globalInterfaceCustomLanguages.length;i++)if(null!=localization[globalInterfaceCustomLanguages[i]]){var tmp;(tmp=language_option).attr("data-type",globalInterfaceCustomLanguages[i]),tmp.text(localization[globalInterfaceCustomLanguages[i]]._name_),$("#Login").find('[data-type="language"]').append(tmp.clone()),lang_num++}if(0==lang_num)for(var loc in localization){var tmp;(tmp=language_option).attr("data-type",loc),tmp.text(localization[loc]._name_),$("#Login").find('[data-type="language"]').append(tmp.clone())}$('[data-type="language"]').find("[data-type="+globalInterfaceLanguage+"]").prop("selected",!0),isAvaible("CalDavZAP")&&!isAvaible("CardDavMATE")?($('[data-size="login_logo"]').find("img").attr("src","images/cdz_logo.svg"),$("#LoginPage").find(".footer").text("CalDavZAP - the open source CalDAV web client")):isAvaible("CardDavMATE")&&!isAvaible("CalDavZAP")?($('[data-size="login_logo"]').find("img").attr("src","carddavmate/images/cdm_logo.svg"),$("#LoginPage").find(".footer").text("CardDavMATE - the open source CardDAV web client")):($("#Login").css("margin-top","41px"),$('[data-size="login_logo"]').find("img").attr("src","images/infcloud_logo.svg"),$("#LoginPage").find(".footer").text("InfCloud - the open source CalDAV/CardDAV web client")),$("#LoginPage").find(".footer").attr("title",globalVersion),isAvaible("CardDavMATE")&&globalMainCardDAV(),isAvaible("CalDavZAP")&&globalMainCalDAV(),isAvaible("Projects")&&globalMainProjects(),isAvaible("Reports")&&globalMainReports(),isAvaible("Settings")&&globalMainSettings(),isAvaible("CardDavMATE")&&mainCardDAV(),isAvaible("CalDavZAP")&&mainCalDAV(),isAvaible("Projects")&&mainProjects(),isAvaible("Reports")&&mainReports(),isAvaible("Settings")&&mainSettings(),init()}function saveSettings(isFormSave){globalSettings.islastdefaultactiveapp.value&&(globalSettings.defaultactiveapp.value=globalActiveApp),globalSettings.version.value=globalSettingsVersion;var rex=new RegExp("^(https?://)([^@/]+(?:@[^@/]+)?)@(.*)");if(isAvaible("CalDavZAP")){globalSettings.activecalendarcollections.value.splice(0,globalSettings.activecalendarcollections.value.length),globalSettings.activetodocollections.value.splice(0,globalSettings.activetodocollections.value.length),globalSettings.todolistfilterselected.value.splice(0,globalSettings.todolistfilterselected.value.length);for(var i=0;i<globalVisibleCalDAVCollections.length;i++){var uidParts=globalVisibleCalDAVCollections[i].match(rex);globalSettings.activecalendarcollections.value.splice(globalSettings.activecalendarcollections.value.length,0,uidParts[1]+uidParts[3])}for(var i=0;i<globalVisibleCalDAVTODOCollections.length;i++){var uidParts=globalVisibleCalDAVTODOCollections[i].match(rex);globalSettings.activetodocollections.value.splice(globalSettings.activetodocollections.value.length,0,uidParts[1]+uidParts[3])}if(globalSettings.islastactiveview.value){var view=$("#calendar").fullCalendar("getView");globalSettings.activeview.value=view.name}globalSettings.islasttimezone.value&&(globalSettings.timezone.value=globalSessionTimeZone);var uidSelected=$("#ResourceCalDAVList").find(".resourceCalDAV_item_selected").attr("data-id");if(null!=uidSelected&&""!=uidSelected){var par=uidSelected.split("/");globalSettings.calendarselected.value=par[par.length-3]+"/"+par[par.length-2]+"/"}if(null!=(uidSelected=$("#ResourceCalDAVTODOList").find(".resourceCalDAV_item_selected").attr("data-id"))&&""!=uidSelected){var par=uidSelected.split("/");globalSettings.todocalendarselected.value=par[par.length-3]+"/"+par[par.length-2]+"/"}for(var filterArray=$(".fc-filter-option-selected"),i=0;i<filterArray.length;i++)globalSettings.todolistfilterselected.value.splice(globalSettings.todolistfilterselected.value.length,0,$($(".fc-filter-option-selected")[i]).attr("data-type"))}if(isAvaible("CardDavMATE")){globalSettings.activeaddressbookcollections.value.splice(0,globalSettings.activeaddressbookcollections.value.length);for(var visAddrs=dataGetChecked("#ResourceCardDAVList"),i=0;i<visAddrs.length;i++)if("undefined"!=visAddrs[i]){var uidPart=visAddrs[i].match(RegExp("^(https?://)(.*)","i"))[1],uidPart2=visAddrs[i].match(RegExp("^(https?://)(.*)","i"))[2].split("@")[2];globalSettings.activeaddressbookcollections.value.splice(globalSettings.activeaddressbookcollections.value.length,0,uidPart+uidPart2)}if($("#ResourceCardDAVList").find(".group.resourceCardDAV_selected").length>0)var uidASelected=$("#ResourceCardDAVList").find(".group.resourceCardDAV_selected").attr("data-id");else if($("#ResourceCardDAVList").find(".resourceCardDAV_selected").length>0)var uidASelected=$("#ResourceCardDAVList").find(".resourceCardDAV_selected").attr("data-id");else var uidASelected="";null!=uidASelected&&""!=uidASelected&&(globalSettings.addressbookselected.value=uidASelected)}return isAvaible("Settings")&&isFormSave?applyFormSettings():globalSettings}function loadXMLSetings(settingsXML){$(settingsXML).children().each((function(ind,elm){var type=$(elm).attr("type"),locked=void 0!==$(elm).attr("locked")&&null!=$(elm).attr("locked")&&"true"==$(elm).attr("locked");if(void 0===globalSettings[$(elm).prop("tagName").toLowerCase()])return!0;if(locked&&(globalSettings[$(elm).prop("tagName").toLowerCase()].locked=!0),$(elm).children().length>0)globalSettings[$(elm).prop("tagName").toLowerCase()].value=new Array,$(elm).children().each((function(pind,pelm){if("urihandlerprofile"==$(elm).prop("tagName").toLowerCase())globalSettings[$(elm).prop("tagName").toLowerCase()].value={},globalSettings[$(elm).prop("tagName").toLowerCase()].value[$(pelm).text().toLowerCase()]=$(pelm).attr("url");else if("addresscountryequivalence"==$(elm).prop("tagName").toLowerCase()){var eqObject={};eqObject.country=$(pelm).attr("name"),eqObject.regex=$(pelm).attr("regex"),globalSettings[$(elm).prop("tagName").toLowerCase()].value.push(eqObject)}else if("compatibility"==$(elm).prop("tagName").toLowerCase())globalSettings[$(elm).prop("tagName").toLowerCase()].value={},globalSettings[$(elm).prop("tagName").toLowerCase()].value[$(pelm).attr("name")]=new Array,$(pelm).children().each((function(rind,relm){globalSettings[$(elm).prop("tagName").toLowerCase()].value[$(pelm).attr("name")].push($(relm).text())}));else if(""!=$(pelm).text())switch(type){case"integer":globalSettings[$(elm).prop("tagName").toLowerCase()].value.push(parseInt($(pelm).text(),10));break;case"string":"null"!=$(pelm).text()?globalSettings[$(elm).prop("tagName").toLowerCase()].value.push($(pelm).text()):globalSettings[$(elm).prop("tagName").toLowerCase()].value.push(null);break;case"boolean":"true"==$(pelm).text()?globalSettings[$(elm).prop("tagName").toLowerCase()].value.push(!0):globalSettings[$(elm).prop("tagName").toLowerCase()].value.push(!1)}}));else if(""!=$(elm).text())switch(type){case"integer":globalSettings[$(elm).prop("tagName").toLowerCase()].value=parseInt($(elm).text(),10);break;case"string":"null"!=$(elm).text()?globalSettings[$(elm).prop("tagName").toLowerCase()].value=$(elm).text():globalSettings[$(elm).prop("tagName").toLowerCase()].value=null;break;case"boolean":"true"==$(elm).text()?globalSettings[$(elm).prop("tagName").toLowerCase()].value=!0:"false"==$(elm).text()&&(globalSettings[$(elm).prop("tagName").toLowerCase()].value=!1)}}))}function applyServerSettings(inputSettings){for(var prop in void 0!==inputSettings.activecalendarcollections&&null!=inputSettings.activecalendarcollections||(inputSettings.activecalendarcollections=new Array),void 0!==inputSettings.activetodocollections&&null!=inputSettings.activetodocollections||(inputSettings.activetodocollections=new Array),void 0!==inputSettings.loadedcalendarcollections&&null!=inputSettings.loadedcalendarcollections||(inputSettings.loadedcalendarcollections=new Array,isAvaible("CalDavZAP")&&$("#showUnloadedCalendars").css("display","none")),void 0!==inputSettings.loadedtodocollections&&null!=inputSettings.loadedtodocollections||(inputSettings.loadedtodocollections=new Array,isAvaible("CalDavZAP")&&$("#showUnloadedCalendarsTODO").css("display","none")),void 0!==inputSettings.activeaddressbookcollections&&null!=inputSettings.activeaddressbookcollections||(inputSettings.activeaddressbookcollections=new Array),void 0!==inputSettings.loadedaddressbookcollections&&null!=inputSettings.loadedaddressbookcollections||(inputSettings.loadedaddressbookcollections=new Array,isAvaible("CardDavMATE")&&$("#showUnloadedAddressbooks").css("display","none")),transformSettings(inputSettings),inputSettings)-1==globalDefinedSettings.indexOf(prop)||void 0!==globalPreviousSupportedSettings&&-1==globalPreviousSupportedSettings.indexOf(prop)?-1==globalDefinedSettings.indexOf(prop)&&console.log("Warning: Unsupported property: '"+prop+"' (you can safely ignore this message)"):void 0===globalSettings[prop]||globalSettings[prop].locked||(globalSettings[prop].value=inputSettings[prop])}function transformSettings(settings){for(settings.version||(settings.version=1);settings.version<globalSettingsVersion;)switch(console.log("Warning: Detected outdated server settings (version "+settings.version+++") - transforming to version "+settings.version),settings.version){case 2:"undefined"!=typeof globalActiveCalendarCollections&&null!=globalActiveCalendarCollections?settings.activecalendarcollections=globalActiveCalendarCollections.slice():settings.activecalendarcollections.splice(0,settings.activecalendarcollections.length),"undefined"!=typeof globalActiveTodoCollections&&null!=globalActiveTodoCollections?settings.activetodocollections=globalActiveTodoCollections.slice():settings.activetodocollections.splice(0,settings.activetodocollections.length),"undefined"!=typeof globalLoadedCalendarCollections&&null!=globalLoadedCalendarCollections?settings.loadedcalendarcollections=globalLoadedCalendarCollections.slice():settings.loadedcalendarcollections.splice(0,settings.loadedcalendarcollections.length),"undefined"!=typeof globalLoadedTodoCollections&&null!=globalLoadedTodoCollections?settings.loadedtodocollections=globalLoadedTodoCollections.slice():settings.loadedtodocollections.splice(0,settings.loadedtodocollections.length),"undefined"!=typeof globalActiveAddressbookCollections&&null!=globalActiveAddressbookCollections?settings.activeaddressbookcollections=globalActiveAddressbookCollections.slice():settings.activeaddressbookcollections.splice(0,settings.activeaddressbookcollections.length),"undefined"!=typeof globalLoadedAddressbookCollections&&null!=globalLoadedAddressbookCollections?settings.loadedaddressbookcollections=globalLoadedAddressbookCollections.slice():settings.loadedaddressbookcollections.splice(0,settings.loadedaddressbookcollections.length),"undefined"!=typeof globalContactStoreFN&&null!=globalContactStoreFN?settings.contactstorefn=globalContactStoreFN.slice():settings.contactstorefn=["prefix"," last"," middle"," first"," suffix"];break;case 3:settings.collectiondisplay="undefined"!=typeof globalCollectionDisplay&&null!=globalCollectionDisplay&&""!=globalCollectionDisplay?globalCollectionDisplay:"undefined"!=typeof globalGroupContactsByCompanies&&globalGroupContactsByCompanies?[{label:"{Name}",value:{company:["{Company}"," [{Department}]"],personal:["{LastName}"," {MiddleName}"," {FirstName}"]}},{label:"{JobTitle}",value:["{JobTitle}"]},{label:"{Email}",value:["{Email[:0]}"]},{label:"{Phone} 1",value:["{Phone[:0]}"]},{label:"{Phone} 2",value:["{Phone[:1]}"]},{label:"{NoteText}",value:["{NoteText}"]}]:[{label:"{Name}",value:["{LastName}"," {MiddleName}"," {FirstName}"]},{label:"{Company} [{Department}]",value:["{Company}"," [{Department}]"]},{label:"{JobTitle}",value:["{JobTitle}"]},{label:"{Email}",value:["{Email[:0]}"]},{label:"{Phone} 1",value:["{Phone[:0]}"]},{label:"{Phone} 2",value:["{Phone[:1]}"]},{label:"{NoteText}",value:["{NoteText}"]}],settings.collectionsort="undefined"!=typeof globalCollectionSort&&null!=globalCollectionSort&&""!=globalCollectionSort?globalCollectionSort:""}}function loadSettings(strobj,fromServer,syncMode){if(settingsLoaded&&!syncMode)return!1;try{objNew=jQuery.parseJSON(strobj),"object"==typeof objNew&&(syncMode||"undefined"==typeof globalSettingsXML||null==globalSettingsXML||""==globalSettingsXML||loadXMLSetings($(globalSettingsXML)),fromServer&&applyServerSettings(objNew))}catch(err){return console.log("load settings - JSON parsing error: "+err),delete globalSettings.version.value,loadSettings(JSON.stringify(globalSettings),!1,!1),!1}if(syncMode)return!1;if(isAvaible("CalDavZAP")){for(var i=0;i<globalSettings.timezonesenabled.value.length;i++)-1==timeZonesEnabled.indexOf(globalSettings.timezonesenabled.value[i])&&timeZonesEnabled.push(globalSettings.timezonesenabled.value[i]);if(globalSettings.timezonesupport.value?null!=(globalSessionTimeZone=globalSettings.timezone.value)&&-1==timeZonesEnabled.indexOf(globalSessionTimeZone)&&timeZonesEnabled.push(globalSessionTimeZone):(globalSessionTimeZone="local",timeZonesEnabled.push("local")),initTimepicker(globalSettings.ampmformat.value),null==globalSettings.timeformatagenda.value&&(globalSettings.ampmformat.value?globalSettings.timeformatagenda.value="h:mm TT{ - h:mm TT}":globalSettings.timeformatagenda.value="H:mm{ - H:mm}"),null==globalSettings.timeformatbasic.value&&(globalSettings.ampmformat.value?globalSettings.timeformatbasic.value="h:mmT{-h:mmT}":globalSettings.timeformatbasic.value="H:mm{-H:mm}"),globalSettings.appleremindersmode.value&&-1==globalSettings.todolistfilterselected.value.indexOf("filterAction")&&-1==globalSettings.todolistfilterselected.value.indexOf("filterCompleted")&&(-1!=globalSettings.todolistfilterselected.value.indexOf("filterProgress")&&(globalSettings.todolistfilterselected.value[globalSettings.todolistfilterselected.value.indexOf("filterProgress")]="filterAction"),-1!=globalSettings.todolistfilterselected.value.indexOf("filterCanceled")&&(globalSettings.todolistfilterselected.value[globalSettings.todolistfilterselected.value.indexOf("filterCanceled")]="filterAction")),null==globalSettings.eventstartfuturelimit.value){var now=new Date;(globalToLoadedLimit=new Date(now.getFullYear(),now.getMonth()+12,1,0,0,0)).setMilliseconds(0),(globalBeginFuture=new Date(globalToLoadedLimit.getTime())).setDate(globalBeginFuture.getDate()+14),(globalToLoadedLimitTodo=new Date(now.getFullYear(),now.getMonth()+12,1,0,0,0)).setMilliseconds(0)}!1!==globalSettings.enablekbnavigation.value&&initKbTodoNavigation(),initFullCalendar(),initTodoList(),$("#SystemCalDavZAP .fc-header-title").css("width",$("#main_h_placeholder").width()-$("#SystemCalDavZAP .fc-header-left").outerWidth()-$("#SystemCalDavZAP .fc-header-right").outerWidth()),$("#ResourceCalDAVList, #ResourceCalDAVTODOList").css("bottom",globalSettings.timezonesupport.value?20:0),$("#alertBox").css("left",$(window).width()/2-$("#alertBox").width()/2)}if(isAvaible("CardDavMATE")){globalRefAbListTableHeader=$("#ABListTable").find(".ablist_table_header");for(var colgroups=$("#ABListTable").find("colgroup"),i=0;i<getDataColumnCount();i++)globalRefAbListTableHeader.append("<th>"),colgroups.append("<col>");globalRefAbListTableHeader.children().slice(globalFixedContactDataColumnsCount).each((function(ind){$(this).text(getDataColumnLabelAtIndex(ind))})),globalRefABListTableCols=$("#ABListTable").find("colgroup").first().children(),globalRefABListInnerTableCols=$("#ABListTableInner").find("colgroup").children(),$("#ABListTable").find(".ablist_table_container").children().attr("colspan",getDataColumnCount()+globalFixedContactDataColumnsCount),globalRefABListTable.children(".ablist_header").children().attr("colspan",getDataColumnCount()+globalFixedContactDataColumnsCount),globalOrigABListHeader||(globalOrigABListHeader=globalRefABListTable.children(".ablist_header").remove()),globalOrigABListItem||(globalOrigABListItem=globalRefABListTable.children(".ablist_item").remove()),!1!==globalSettings.enablekbnavigation.value&&initKbAddrNavigation(),applyAddrSettings(globalTranslVcardTemplate),applyAddrSettings($("#vCardEditor"))}isAvaible("Projects")&&!1!==globalSettings.enablekbnavigation.value&&initKbProjectNavigation(),settingsLoaded=!0,globalActiveApp=isAvaible(globalSettings.defaultactiveapp.value)?globalSettings.defaultactiveapp.value:globalAvailableAppsArray[0]}function checkForLoadedCollections(inputSettings){var val="",triggerSync=!0;if(globalLoadedCollectionsNumber=0,globalLoadedCollectionsCount=0,"event"==globalSettingsSaving){if(hideUnloadedCollections("event"),(val=inputSettings.loadedcalendarcollections.value).length>0?globalLoadedCollectionsNumber+=$(val).not(globalSettings.loadedcalendarcollections.value).length:globalLoadedCollectionsNumber++,$(globalSettings.loadedcalendarcollections.value).not(val).length>0){0==globalLoadedCollectionsNumber&&(triggerSync=!1,globalFirstHideLoader=!1);var unloadArray=$(globalSettings.loadedcalendarcollections.value).not(val);unloadCalDAVCollection(unloadArray.toArray(),!0)}triggerSync&&addLoadCalDAVCollection(val,!0),globalSettings.loadedcalendarcollections.value=val}else if("todo"==globalSettingsSaving){if(hideUnloadedCollections("todo"),(val=inputSettings.loadedtodocollections.value).length>0?globalLoadedCollectionsNumber+=$(val).not(globalSettings.loadedtodocollections.value).length:globalLoadedCollectionsNumber++,$(globalSettings.loadedtodocollections.value).not(val).length>0){0==globalLoadedCollectionsNumber&&(triggerSync=!1,globalFirstHideLoader=!1);var unloadArray=$(globalSettings.loadedtodocollections.value).not(val);unloadCalDAVCollection(unloadArray.toArray(),!1)}triggerSync&&addLoadCalDAVCollection(val,!1),globalSettings.loadedtodocollections.value=val}else if("addressbook"==globalSettingsSaving){if(hideUnloadedCardDAVCollections(),(val=inputSettings.loadedaddressbookcollections.value).length>0?globalLoadedCollectionsNumber+=$(val).not(globalSettings.loadedaddressbookcollections.value).length:globalLoadedCollectionsNumber++,$(globalSettings.loadedaddressbookcollections.value).not(val).length>0){0==globalLoadedCollectionsNumber&&(triggerSync=!1,globalFirstHideLoader=!1);var unloadArray=$(globalSettings.loadedaddressbookcollections.value).not(val);unloadCardDAVCollection(unloadArray.toArray())}triggerSync&&addLoadCardDAVCollection(val),globalSettings.loadedaddressbookcollections.value=val}triggerSync&&ifLoadCollections()}function checkBeforeClose(isFormSave){if(isAvaible("CalDavZAP")&&globalCalDAVInitLoad||isAvaible("CardDavMATE")&&globalCardDAVInitLoad)return!1;var old_settings=JSON.stringify(globalSettings),settings=saveSettings(isFormSave),new_settings;if(old_settings==JSON.stringify(settings))return!1;for(var i=0;i<globalAccountSettings.length;i++)if(-1!=globalAccountSettings[i].href.indexOf(globalLoginUsername)&&globalAccountSettings[i].settingsAccount){netSaveSettings(globalAccountSettings[i],settings,isFormSave,!1);break}}function isEachResourceLoaded(){for(var loaded=!0,i=0;i<globalAccountSettings.length;i++)void 0!==globalAccountSettings[i].errorLoaded&&null!=globalAccountSettings[i].errorLoaded&&!0===globalAccountSettings[i].errorLoaded&&(loaded=!1);return loaded}function logoutCalDAV(){globalTodolistStatusArray={},globalTodoCheckTimeout=null,globalVisibleCalDAVCollections.splice(0,globalVisibleCalDAVCollections.length),globalVisibleCalDAVTODOCollections.splice(0,globalVisibleCalDAVTODOCollections.length),processedTimezones.splice(0,processedTimezones.length),globalCalendarNumber=0,globalOnlyCalendarNumber=0,globalTodoCalendarNumber=0,globalCalendarNumberCount=0,globalLoadedLimit=new Date,globalToLoadedLimit=new Date,globalLimitLoading="",globalLimitTodoLoading="",globalBeginPast=new Date,globalBeginFuture=new Date,globalLoadedLimitTodo=new Date,globalToLoadedLimitTodo=new Date,globalDefaultCalendarCollectionActiveAll=!1,globalDefaultTodoCalendarCollectionActiveAll=!1,globalDefaultCalendarCollectionLoadAll=!1,globalDefaultTodoCalendarCollectionLoadAll=!1,globalCalDAVCollectionSync=!1,globalAllowFcRerender=!0,globalEventList.reset(),globalResourceCalDAVList.reset(),timeZonesEnabled.splice(0,timeZonesEnabled.length),null!=globalEventIntervalID&&clearInterval(globalEventIntervalID),$("#EventDisabler, #TodoDisabler, #AlertDisabler").fadeOut(2e3),$("#SystemCalDavZAP,  #SystemCalDavTODO").animate({opacity:0},200).promise().done((function(){$("#SystemCalDavZAP, #SystemCalDavTODO").css("visibility","hidden"),$("#main, #mainTODO").animate({top:25},0),$("#searchForm, #searchFormTODO").hide(),$("#searchInput, #searchInputTODO").val("").trigger("keyup").trigger("blur"),$("#calendar").fullCalendar("destroy"),$("#todoList").fullCalendar("destroy"),$("#timezonePicker, #timezonePickerTODO").prop("disabled",!1).empty(),$("#eventColor, #todoColor").css("background-color",""),$("#ResourceCalDAVList").width()<1&&$("#ResourceCalDAVToggle").trigger("click"),$("#ResourceCalDAVTODOList").width()<1&&$("#ResourceCalDAVTODOToggle").trigger("click")}))}function mainCalDAV(){localizeCalDAV()}function localizeCalDAV(){globalCalDAVInitLoad=!0,$("#ResourceCalDAVList").html(origResourceCalDAVListTemplate),$("#ResourceCalDAVTODOList").html(origResourceCalDAVTODOListTemplate),$("#CAEvent").html(origVcalendarTemplate),$("#CATodo").html(origVtodoTemplate),$("#todoLoader").html(origVtodoLoaderTemplate),translate(),$("input[placeholder],textarea[placeholder]").placeholder(),cleanResourceCalDAVListTemplate=$("#ResourceCalDAVListTemplate").clone().wrap("<div>").parent().html(),cleanResourceCalDAVTODOListTemplate=$("#ResourceCalDAVTODOListTemplate").clone().wrap("<div>").parent().html(),cleanVcalendarTemplate=$("#CAEvent .saveLoader").clone().wrap("<div>").parent().html()+$("#repeatConfirmBox").clone().wrap("<div>").parent().html()+$("#event_details_template").clone().wrap("<div>").parent().html(),cleanVtodoTemplate=$("#repeatConfirmBoxTODO").clone().wrap("<div>").parent().html()+$("#todo_details_template").clone().wrap("<div>").parent().html(),$("#searchInput, #searchInputTODO").val(""),globalSettings.titleformatmonth.value=localization[globalInterfaceLanguage]._default_title_format_month_,globalSettings.titleformatweek.value=localization[globalInterfaceLanguage]._default_title_format_week_,globalSettings.titleformatday.value=localization[globalInterfaceLanguage]._default_title_format_day_,globalSettings.titleformattable.value=localization[globalInterfaceLanguage]._default_title_format_table_,globalSettings.columnformatagenda.value=localization[globalInterfaceLanguage]._default_column_format_agenda_}function runCalDAV(){isUserLogged||run(),globalResourceRefreshNumber=0,globalResourceRefreshNumberTodo=0,$("#MainLoader").css("left","0px"),$("#MainLoader").fadeIn(200),"undefined"!=typeof globalSubscribedCalendars&&null!=globalSubscribedCalendars&&(globalAccountSettings[globalAccountSettings.length]=$.extend({},globalAccountSettings[0]),globalAccountSettings[globalAccountSettings.length-1].hrefLabel=globalSubscribedCalendars.hrefLabel,globalAccountSettings[globalAccountSettings.length-1].calendars=globalSubscribedCalendars.calendars,globalAccountSettings[globalAccountSettings.length-1].ignoreAlarms="")}function globalMainCalDAV(){if($(window).resize((function(evt){evt.target==window&&(void 0===globalCalDAVInitLoad||globalCalDAVInitLoad||globalResourceRefreshNumber||$("#main").width()==globalCalWidth||$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].resizeLoader).parent().css("display","block"),$("#SystemCalDavZAP .fc-header-title").css("width",$("#main_h_placeholder").width()-$("#SystemCalDavZAP .fc-header-left").outerWidth()-$("#SystemCalDavZAP .fc-header-right").outerWidth()),$("#ResourceCalDAVList, #ResourceCalDAVTODOList").css("bottom",globalSettings.timezonesupport.value?20:0),$("#alertBox").css("left",$(window).width()/2-$("#alertBox").width()/2),$("#calendar").fullCalendar("option","contentHeight",$("#main").height()-14),$("#todoList").fullCalendar("allowSelectEvent",!1),$("#todoList").fullCalendar("option","contentHeight",$("#mainTODO").height()-14),$("#todoList").fullCalendar("allowSelectEvent",!0),$("#todoList").fullCalendar("selectEvent",null,!0),$("#CATodo").is(":visible")&&checkTodoFormScrollBar(),globalSettings.displayhiddenevents.value&&(hideEventCalendars(),hideTodoCalendars()),globalCalWidth=$("#main").width())})),$("#ResourceCalDAVToggle").click((function(){var transSpeedResource=70,isResourceVisible=$("#ResourceCalDAVList").width()>1,col0=isResourceVisible?0:218,col1=isResourceVisible?0:224,col2=isResourceVisible?0:224,col3=isResourceVisible?0:225;isIntegrated&&(col2+=isResourceVisible?49:50,col3+=50),void 0===globalCalDAVInitLoad||globalCalDAVInitLoad||globalResourceRefreshNumber||$("#CalendarLoader").children(".loaderInfo").text(localization[globalInterfaceLanguage].resizeLoader).parent().css("display","block"),globalSettings.timezonesupport.value&&$("#timezoneWrapper").animate({width:col0},70),$("#resourceCalDAV_h, #ResourceCalDAVList").animate({width:col1},70),$("#CalendarLoader").animate({left:col3},70),$("#main_h, #searchForm, #main").animate({left:col2},70).promise().done((function(){$("#SystemCalDavZAP .fc-header-title").width($("#main_h_placeholder").width()-$("#SystemCalDavZAP .fc-header-left").width()-$("#SystemCalDavZAP .fc-header-right").width()-20),$(window).resize()}))})),$("#ResourceCalDAVTODOToggle").click((function(){var transSpeedResource=70,isResourceVisible=$("#ResourceCalDAVTODOList").width()>1,col0=isResourceVisible?0:218,col1=isResourceVisible?0:224,col2=isResourceVisible?0:224,col3=isResourceVisible?0:225;isIntegrated&&(col2+=isResourceVisible?49:50,col3+=50),globalSettings.timezonesupport.value&&$("#timezoneWrapperTODO").animate({width:col0},70),$("#resourceCalDAVTODO_h, #ResourceCalDAVTODOList").animate({width:col1},70),$("#CalendarLoaderTODO").animate({left:col3},70),$("#main_h_TODO, #searchFormTODO").animate({left:col2},70),$("#mainTODO").animate({left:col2},70,(function(){$("#todoList").fullCalendar("allowSelectEvent",!1),$(window).resize(),$("#todoList").fullCalendar("allowSelectEvent",!0),$("#todoList").fullCalendar("selectEvent",null,!0)}))})),$("#eventFormShowerTODO").click((function(){showNewEvent("TODO")})),$("#eventFormShower").click((function(){showNewEvent("")})),$("#searchInput").bind("keyup change",(function(){""!=$(this).val()?$("#reserButton").css("visibility","visible"):$("#reserButton").css("visibility","hidden")})),$("#searchInputTODO").bind("keyup change",(function(){""!=$(this).val()?$("#resetButtonTODO").css("visibility","visible"):$("#resetButtonTODO").css("visibility","hidden")})),$("#timezonePicker, #timezonePickerTODO").change((function(){var previousTimezone=globalSessionTimeZone;globalSessionTimeZone=$(this).val(),$("#timezonePicker").val($(this).val()),$("#timezonePickerTODO").val($(this).val()),applyTimezone(previousTimezone)})),$.browser.msie||$.browser.mozilla){var newSVG=$(SVG_select_b).attr("data-type","select_icon").css({"pointer-events":"none","z-index":"1",display:"inline","margin-left":"-19px","vertical-align":"top","background-color":"#ffffff"});$("#timezoneWrapper, #timezoneWrapperTODO").find("select").after($($("<div>").append($(newSVG).clone()).html()))}$.browser.webkit&&$.browser.safari&&$('.infoSpan[data-type="txt_interval"]').css("padding-left","3px"),globalCalWidth=$("#main").width(),origResourceCalDAVListTemplate=$("#ResourceCalDAVListTemplate").clone().wrap("<div>").parent().html(),origResourceCalDAVTODOListTemplate=$("#ResourceCalDAVTODOListTemplate").clone().wrap("<div>").parent().html(),origVcalendarTemplate=$("#CAEvent .saveLoader").clone().wrap("<div>").parent().html()+$("#repeatConfirmBox").clone().wrap("<div>").parent().html()+$("#event_details_template").clone().wrap("<div>").parent().html(),origVtodoTemplate=$("#repeatConfirmBoxTODO").clone().wrap("<div>").parent().html()+$("#todo_details_template").clone().wrap("<div>").parent().html(),origVtodoLoaderTemplate=$("#todoLoader .saveLoader").clone().wrap("<div>").parent().html(),populateTimezoneKeys()}function setCalendarNumber(initSearch){initSearch&&initSearchEngine(),globalCalendarNumber=0,globalOnlyCalendarNumber=0,globalTodoCalendarNumber=0;for(var i=0;i<globalResourceCalDAVList.collections.length;i++)null!=globalResourceCalDAVList.collections[i].uid&&globalResourceCalDAVList.collections[i].makeLoaded&&(globalCalendarNumber++,globalOnlyCalendarNumber++);for(var i=0;i<globalResourceCalDAVList.TodoCollections.length;i++)null!=globalResourceCalDAVList.TodoCollections[i].uid&&globalResourceCalDAVList.TodoCollections[i].makeLoaded&&(globalCalendarNumber++,globalTodoCalendarNumber++)}window.onload=globalMain,window.onkeydown=function(event){switch(event.which){case 13:isUserLogged||$("#Login").find('[data-type="system_login"]').trigger("click");break;case 27:"CalDavZAP"==globalActiveApp&&$("#CAEvent").is(":visible")&&$("#EventDisabler").is(":hidden")&&$("#closeButton").trigger("click"),"Projects"==globalActiveApp&&$("#ProjectEventForm").is(":visible")&&$("#ProjectsDisabler").is(":hidden")&&$("#cancelActivity").trigger("click"),$(".sp-container").is(":visible")&&$("html").trigger("click")}};